<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for quadprogbb>standardform</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">quadprogbb>standardform (1 call, 1.110 sec)</span><br/><i>Generated 06-Oct-2011 17:14:09 using cpu time.</i><br/>M-subfunction in file /nfs/dollar/local/vol00/user0/jieqchen/new/quadprogbb/quadprogbb/mpc/code/quadprogbb.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file3.html">quadprogbb</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line686">686</a></td><td class="td-linebottomrt"><pre>[L,U,tmp1,tmp2,tmp3,tmp4,tlp] ...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.926 s</td><td class="td-linebottomrt" class="td-linebottomrt">83.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=83 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line653">653</a></td><td class="td-linebottomrt"><pre>[H,f,A,b,Aeq,beq,LB,UB,cons,ss...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.143 s</td><td class="td-linebottomrt" class="td-linebottomrt">12.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=13 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line644">644</a></td><td class="td-linebottomrt"><pre>tmp_m1 = rank(Aeq);</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.031 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line602">602</a></td><td class="td-linebottomrt"><pre>sstruct = struct('flag',0,'obj...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.9%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line881">881</a></td><td class="td-linebottomrt"><pre>return</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">1.110 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file28.html">quadprogbb>boundall</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.896 s</td><td class="td-linebottomrt">80.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=81 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file16.html">quadprogbb>refm1</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.102 s</td><td class="td-linebottomrt">9.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=9 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file7.html">rank</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.031 s</td><td class="td-linebottomrt">2.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.081 s</td><td class="td-linebottomrt">7.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">1.110 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line612">612</a></td><td class="td-linebottomrt"><span class="mono">Using ISEMPTY is usually faster than comparing LENGTH to 0.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line712">712</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'H1' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">287</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">122</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">165</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">123</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">42</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">74.55 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0"> 595</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [H,f,A,b,E,cons,L,U,sstruct,timeLP] = standardform(H,f,A,b,Aeq,beq,LB,UB,cons)</span><br/>               <span style="color: #A0A0A0"> 596</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 597</span> <span style="color: #228B22; background: #FFFFFF;">% If abs(difference of two values) &lt; tol, the two values are considered</span><br/>               <span style="color: #A0A0A0"> 598</span> <span style="color: #228B22; background: #FFFFFF;">% to be equal</span><br/>               <span style="color: #A0A0A0"> 599</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 600</span> <span style="color: #000000; background: #FFFFFF;">tol = 1e-8; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 601</span> <span style="color: #000000; background: #FFFFFF;">E = []; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 602</span> <a name="Line602"></a><span style="color: #000000; background: #FFFFFF;">sstruct = struct('flag',0,'obj',-inf,'fx1',[],'fxval1',[],'ub2',[],'idxU2',[],... </span><br/>               <span style="color: #A0A0A0"> 603</span> <span style="color: #000000; background: #FFFFFF;">                'lb3',[],'idxL3',[],'ub4',[],'idxU4',[],'idxU5',[],'ub5',[],...</span><br/>               <span style="color: #A0A0A0"> 604</span> <span style="color: #000000; background: #FFFFFF;">                'idxL5',[],'lb5',[],'lb6',[],'ub6',[]);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 605</span> <span style="color: #000000; background: #FFFFFF;">timeLP = 0; </span><br/>               <span style="color: #A0A0A0"> 606</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------</span><br/>               <span style="color: #A0A0A0"> 607</span> <span style="color: #228B22; background: #FFFFFF;">%% Remove fixed variables</span><br/>               <span style="color: #A0A0A0"> 608</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------- </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 609</span> <span style="color: #000000; background: #FFFFFF;">n = size(H,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 610</span> <span style="color: #000000; background: #FFFFFF;">FX  = find(abs(LB - UB)&lt; tol); </span><br/>               <span style="color: #A0A0A0"> 611</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line612"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 612</span> <span style="color: #000000; background: #FFFFFF;">if length(FX) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 613</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 614</span> <span style="color: #228B22; background: #FFFFFF;">  %% track change: 1</span><br/>               <span style="color: #A0A0A0"> 615</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.fx1 = FX;</span><br/>               <span style="color: #A0A0A0"> 616</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.fxval1 = LB(FX);</span><br/>               <span style="color: #A0A0A0"> 617</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 618</span> <span style="color: #228B22; background: #FFFFFF;">    %% FXc == complement of FX or the components of x that are not fixed</span><br/>               <span style="color: #A0A0A0"> 619</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 620</span> <span style="color: #A0A0A0; background: #FFFFFF;">    FXc = setdiff(1:n,FX);</span><br/>               <span style="color: #A0A0A0"> 621</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 622</span> <span style="color: #228B22; background: #FFFFFF;">    %% Calculate the constants in objective after removing the fixed vars</span><br/>               <span style="color: #A0A0A0"> 623</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 624</span> <span style="color: #A0A0A0; background: #FFFFFF;">    cons = cons + 0.5*LB(FX)'*H(FX,FX)*LB(FX) + f(FX)'*LB(FX);</span><br/>               <span style="color: #A0A0A0"> 625</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 626</span> <span style="color: #228B22; background: #FFFFFF;">    %% Update data after removing fixed components</span><br/>               <span style="color: #A0A0A0"> 627</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 628</span> <span style="color: #A0A0A0; background: #FFFFFF;">    f   = f(FXc) + H(FXc,FX)*LB(FX);</span><br/>               <span style="color: #A0A0A0"> 629</span> <span style="color: #A0A0A0; background: #FFFFFF;">    H   = H(FXc,FXc);</span><br/>               <span style="color: #A0A0A0"> 630</span> <span style="color: #A0A0A0; background: #FFFFFF;">    b   = b   - A  (:,FX)*LB(FX); A   = A  (:,FXc);</span><br/>               <span style="color: #A0A0A0"> 631</span> <span style="color: #A0A0A0; background: #FFFFFF;">    beq = beq - Aeq(:,FX)*LB(FX); Aeq = Aeq(:,FXc);</span><br/>               <span style="color: #A0A0A0"> 632</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 633</span> <span style="color: #228B22; background: #FFFFFF;">    %% Update the bounds for the non-fixed components of x</span><br/>               <span style="color: #A0A0A0"> 634</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 635</span> <span style="color: #A0A0A0; background: #FFFFFF;">    LB = LB(FXc);</span><br/>               <span style="color: #A0A0A0"> 636</span> <span style="color: #A0A0A0; background: #FFFFFF;">    UB = UB(FXc);</span><br/>               <span style="color: #A0A0A0"> 637</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 638</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 639</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 640</span> <span style="color: #228B22; background: #FFFFFF;">% remove linearly dependent equalities</span><br/>               <span style="color: #A0A0A0"> 641</span> <span style="color: #228B22; background: #FFFFFF;">% inequality does not matter</span><br/>               <span style="color: #A0A0A0"> 642</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 643</span> <span style="color: #000000; background: #FFFFFF;">[tmp_m,tmp_n] = size(Aeq); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 644</span> <a name="Line644"></a><span style="color: #000000; background: #FFFFFF;">tmp_m1 = <a href="file7.html">rank</a>(Aeq); </span><br/>               <span style="color: #A0A0A0"> 645</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 646</span> <span style="color: #000000; background: #FFFFFF;">if tmp_m1 &lt; min(tmp_m,tmp_n) </span><br/>               <span style="color: #A0A0A0"> 647</span> <span style="color: #A0A0A0; background: #FFFFFF;">  tmp = [Aeq beq]';</span><br/>               <span style="color: #A0A0A0"> 648</span> <span style="color: #A0A0A0; background: #FFFFFF;">  [r, rowidx] = rref(tmp);</span><br/>               <span style="color: #A0A0A0"> 649</span> <span style="color: #A0A0A0; background: #FFFFFF;">  Aeq = Aeq(rowidx,:);</span><br/>               <span style="color: #A0A0A0"> 650</span> <span style="color: #A0A0A0; background: #FFFFFF;">  beq = beq(rowidx);</span><br/>               <span style="color: #A0A0A0"> 651</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 652</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.14 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 653</span> <a name="Line653"></a><span style="color: #000000; background: #FFF0F0;">[H,f,A,b,Aeq,beq,LB,UB,cons,sstruct,tlp] = <a href="file16.html">refm1</a>(H,f,A,b,Aeq,beq,LB,UB,cons,sstruct); </span><br/>               <span style="color: #A0A0A0"> 654</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 655</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0"> 656</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 657</span> <span style="color: #228B22; background: #FFFFFF;">%% Now problem becomes:</span><br/>               <span style="color: #A0A0A0"> 658</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 659</span> <span style="color: #228B22; background: #FFFFFF;">%%   min  .5*x*H*x + f*x + cons</span><br/>               <span style="color: #A0A0A0"> 660</span> <span style="color: #228B22; background: #FFFFFF;">%%   s.t.   A x &lt;=  b              ( lamabda &gt;=0 )</span><br/>               <span style="color: #A0A0A0"> 661</span> <span style="color: #228B22; background: #FFFFFF;">%%          Aeq x = beq            ( y free )</span><br/>               <span style="color: #A0A0A0"> 662</span> <span style="color: #228B22; background: #FFFFFF;">%%          0 &lt;= xL                ( zL &gt;=0 )</span><br/>               <span style="color: #A0A0A0"> 663</span> <span style="color: #228B22; background: #FFFFFF;">%%          0 &lt;= xB &lt;= 1           ( zB&gt;=0, rB &gt;=0)</span><br/>               <span style="color: #A0A0A0"> 664</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 665</span> <span style="color: #228B22; background: #FFFFFF;">%% Now we are to formulate KKT system, and</span><br/>               <span style="color: #A0A0A0"> 666</span> <span style="color: #228B22; background: #FFFFFF;">%% calculate bounds on all vars.</span><br/>               <span style="color: #A0A0A0"> 667</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------------------------------------</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 668</span> <span style="color: #000000; background: #FFFFFF;">n = size(H,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 669</span> <span style="color: #000000; background: #FFFFFF;">m = size(A,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 670</span> <span style="color: #000000; background: #FFFFFF;">meq = size(Aeq,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 671</span> <span style="color: #000000; background: #FFFFFF;">i1 = isfinite(LB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 672</span> <span style="color: #000000; background: #FFFFFF;">i2 = isfinite(UB); </span><br/>               <span style="color: #A0A0A0"> 673</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 674</span> <span style="color: #228B22; background: #FFFFFF;">%% now the meaning of idxL and idxU has changed.</span><br/>               <span style="color: #A0A0A0"> 675</span> <span style="color: #228B22; background: #FFFFFF;">%% idxL = LB finite + UB infinite</span><br/>               <span style="color: #A0A0A0"> 676</span> <span style="color: #228B22; background: #FFFFFF;">%% idxU = both LB &amp; UB finite</span><br/>               <span style="color: #A0A0A0"> 677</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 678</span> <span style="color: #000000; background: #FFFFFF;">idxL = find(i1 &amp; ~i2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 679</span> <span style="color: #000000; background: #FFFFFF;">idxB = find(i1 &amp; i2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 680</span> <span style="color: #000000; background: #FFFFFF;">lenL = length(idxL); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 681</span> <span style="color: #000000; background: #FFFFFF;">lenB = length(idxB); </span><br/>               <span style="color: #A0A0A0"> 682</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 683</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------------------</span><br/>               <span style="color: #A0A0A0"> 684</span> <span style="color: #228B22; background: #FFFFFF;">%% Calculate bounds for all vars</span><br/>               <span style="color: #A0A0A0"> 685</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------------------</span><br/><span style="color: #FF0000">  0.93 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 686</span> <a name="Line686"></a><span style="color: #000000; background: #FF8080;">[L,U,tmp1,tmp2,tmp3,tmp4,tlp] = <a href="file28.html">boundall</a>(H,f,A,b,Aeq,beq,LB,UB,idxL,idxB); </span><br/>               <span style="color: #A0A0A0"> 687</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 688</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0"> 689</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 690</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 691</span> <span style="color: #228B22; background: #FFFFFF;">%% Prep equality constraints: A * xx = b </span><br/>               <span style="color: #A0A0A0"> 692</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 693</span> <span style="color: #228B22; background: #FFFFFF;">%%  (1)    H * x + A'*lambda + Aeq' * y - zL - zB + rB = -f</span><br/>               <span style="color: #A0A0A0"> 694</span> <span style="color: #228B22; background: #FFFFFF;">%%  (2)    A * x + s = b</span><br/>               <span style="color: #A0A0A0"> 695</span> <span style="color: #228B22; background: #FFFFFF;">%%  (3)    Aeq * x = beq</span><br/>               <span style="color: #A0A0A0"> 696</span> <span style="color: #228B22; background: #FFFFFF;">%%  (4)    xB + wB = 1</span><br/>               <span style="color: #A0A0A0"> 697</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 698</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 699</span> <span style="color: #000000; background: #FFFFFF;">if norm(L-U)&lt;tol </span><br/>               <span style="color: #A0A0A0"> 700</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.flag = 1;</span><br/>               <span style="color: #A0A0A0"> 701</span> <span style="color: #A0A0A0; background: #FFFFFF;">  xLB = L(1:n);</span><br/>               <span style="color: #A0A0A0"> 702</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.xx = xLB;</span><br/>               <span style="color: #A0A0A0"> 703</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.obj = .5*xLB'*H*xLB + f'*xLB+cons;</span><br/>               <span style="color: #A0A0A0"> 704</span> <span style="color: #A0A0A0; background: #FFFFFF;">  return</span><br/>               <span style="color: #A0A0A0"> 705</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 706</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 707</span> <span style="color: #000000; background: #FFFFFF;">idxx = find(abs(U-L) &lt;= tol); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 708</span> <span style="color: #000000; background: #FFFFFF;">L(idxx) = U(idxx); </span><br/>               <span style="color: #A0A0A0"> 709</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 710</span> <span style="color: #000000; background: #FFFFFF;">nn = n+2*m+meq+lenL+3*lenB; </span><br/>               <span style="color: #A0A0A0"> 711</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line712"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 712</span> <span style="color: #000000; background: #FFFFFF;">H1 = H;  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 713</span> <span style="color: #000000; background: #FFFFFF;">A1 = A;  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 714</span> <span style="color: #000000; background: #FFFFFF;">A2 = A; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 715</span> <span style="color: #000000; background: #FFFFFF;">Aeq1 = Aeq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 716</span> <span style="color: #000000; background: #FFFFFF;">Aeq2 = Aeq; </span><br/>               <span style="color: #A0A0A0"> 717</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 718</span> <span style="color: #000000; background: #FFFFFF;">xLB = L(1:n); xUB = U(1:n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 719</span> <span style="color: #000000; background: #FFFFFF;">Dx = diag(xUB-xLB); </span><br/>               <span style="color: #A0A0A0"> 720</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 721</span> <span style="color: #000000; background: #FFFFFF;">sLB = L(n+1:n+m); sUB = U(n+1:n+m); </span><br/>               <span style="color: #A0A0A0"> 722</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 723</span> <span style="color: #000000; background: #FFFFFF;">n0 = n+m; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 724</span> <span style="color: #000000; background: #FFFFFF;">wLB = L(n0+1:n0+lenB); wUB = U(n0+1:n0+lenB); </span><br/>               <span style="color: #A0A0A0"> 725</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 726</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 727</span> <span style="color: #000000; background: #FFFFFF;">lambdaLB = L(n0+1:n0+m); lambdaUB = U(n0+1:n0+m); </span><br/>               <span style="color: #A0A0A0"> 728</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 729</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+m; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 730</span> <span style="color: #000000; background: #FFFFFF;">yLB = L(n0+1:n0+meq); yUB = U(n0+1:n0+meq); </span><br/>               <span style="color: #A0A0A0"> 731</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 732</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+meq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 733</span> <span style="color: #000000; background: #FFFFFF;">zLLB = L(n0+1:n0+lenL); zLUB = U(n0+1:n0+lenL); </span><br/>               <span style="color: #A0A0A0"> 734</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 735</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+lenL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 736</span> <span style="color: #000000; background: #FFFFFF;">zBLB = L(n0+1:n0+lenB); zBUB = U(n0+1:n0+lenB); </span><br/>               <span style="color: #A0A0A0"> 737</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 738</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0 + lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 739</span> <span style="color: #000000; background: #FFFFFF;">rBLB = L(n0+1:end); rBUB = U(n0+1:end); </span><br/>               <span style="color: #A0A0A0"> 740</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 741</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 742</span> <span style="color: #228B22; background: #FFFFFF;">%% Right-hand size b</span><br/>               <span style="color: #A0A0A0"> 743</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 744</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 745</span> <span style="color: #000000; background: #FFFFFF;">r1 = -f - H*xLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 746</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp1) </span><br/>               <span style="color: #A0A0A0"> 747</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r1 = r1 - tmp1*zLLB;</span><br/>               <span style="color: #A0A0A0"> 748</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 749</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 750</span> <span style="color: #000000; background: #FFFFFF;">  r1 = r1 - tmp2*zBLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 751</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 752</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp3) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 753</span> <span style="color: #000000; background: #FFFFFF;">  r1 = r1 - tmp3*rBLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 754</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 755</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A1) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 756</span> <span style="color: #000000; background: #FFFFFF;">  r1 = r1 - A1'*lambdaLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 757</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 758</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq1) </span><br/>               <span style="color: #A0A0A0"> 759</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r1 = r1-Aeq1'*yLB;</span><br/>               <span style="color: #A0A0A0"> 760</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 761</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 762</span> <span style="color: #000000; background: #FFFFFF;">  r2 = b - A*xLB - sLB; </span><br/>               <span style="color: #A0A0A0"> 763</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 764</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r2 = [];</span><br/>               <span style="color: #A0A0A0"> 765</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 766</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq2) </span><br/>               <span style="color: #A0A0A0"> 767</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r3 = beq - Aeq2*xLB;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 768</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 769</span> <span style="color: #000000; background: #FFFFFF;">  r3 = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 770</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 771</span> <span style="color: #000000; background: #FFFFFF;">r4 = ones(lenB,1)- xLB(idxB)- wLB; </span><br/>               <span style="color: #A0A0A0"> 772</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 773</span> <span style="color: #000000; background: #FFFFFF;">b = [r1;r2;r3;r4]; </span><br/>               <span style="color: #A0A0A0"> 774</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 775</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 776</span> <span style="color: #228B22; background: #FFFFFF;">%% Left-hand side A</span><br/>               <span style="color: #A0A0A0"> 777</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 778</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 779</span> <span style="color: #000000; background: #FFFFFF;">tmp1 = tmp1*diag(zLUB - zLLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 780</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = tmp2*diag(zBUB - zBLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 781</span> <span style="color: #000000; background: #FFFFFF;">tmp3 = tmp3*diag(rBUB - rBLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 782</span> <span style="color: #000000; background: #FFFFFF;">row1 = [H*Dx zeros(n,m+lenB)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 783</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A1) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 784</span> <span style="color: #000000; background: #FFFFFF;">  row1 = [row1 A1'*diag(lambdaUB-lambdaLB)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 785</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 786</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq1) </span><br/>               <span style="color: #A0A0A0"> 787</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row1 = [row1 Aeq1'*diag(yUB-yLB)];</span><br/>               <span style="color: #A0A0A0"> 788</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 789</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 790</span> <span style="color: #000000; background: #FFFFFF;">  row2 = A2*Dx; </span><br/>               <span style="color: #A0A0A0"> 791</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 792</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row2 = [];</span><br/>               <span style="color: #A0A0A0"> 793</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 794</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq2) </span><br/>               <span style="color: #A0A0A0"> 795</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row3 = Aeq2*Dx;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 796</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 797</span> <span style="color: #000000; background: #FFFFFF;">  row3 = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 798</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 799</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp4) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 800</span> <span style="color: #000000; background: #FFFFFF;">  row4 = tmp4*Dx; </span><br/>               <span style="color: #A0A0A0"> 801</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 802</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row4 = [];</span><br/>               <span style="color: #A0A0A0"> 803</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 804</span> <span style="color: #228B22; background: #FFFFFF;">%A = [ H*Dx zeros(n,m+lenB) A1'*diag(lambdaUB-lambdaLB) Aeq1'*diag(yUB-yLB) tmp1 tmp2 tmp3;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 805</span> <span style="color: #000000; background: #FFFFFF;">A = [ row1 tmp1 tmp2 tmp3; </span><br/>               <span style="color: #A0A0A0"> 806</span> <span style="color: #000000; background: #FFFFFF;">      row2 diag(sUB-sLB) zeros(m,nn-n-m);</span><br/>               <span style="color: #A0A0A0"> 807</span> <span style="color: #000000; background: #FFFFFF;">      row3 zeros(meq,nn-n);</span><br/>               <span style="color: #A0A0A0"> 808</span> <span style="color: #000000; background: #FFFFFF;">      row4 zeros(lenB,m) diag(wUB-wLB) zeros(lenB, nn-n-m-lenB)];</span><br/>               <span style="color: #A0A0A0"> 809</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 810</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0"> 811</span> <span style="color: #228B22; background: #FFFFFF;">%% Shift and scale x affects objs</span><br/>               <span style="color: #A0A0A0"> 812</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0"> 813</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 814</span> <span style="color: #000000; background: #FFFFFF;">cons = cons + 0.5*xLB'*H*xLB + f'*xLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 815</span> <span style="color: #000000; background: #FFFFFF;">f = f + H*xLB; </span><br/>               <span style="color: #A0A0A0"> 816</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 817</span> <span style="color: #000000; background: #FFFFFF;">H = diag(xUB - xLB)*H*diag(xUB - xLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 818</span> <span style="color: #000000; background: #FFFFFF;">f = (xUB-xLB).* f; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 819</span> <span style="color: #000000; background: #FFFFFF;">n0 = nn-n; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 820</span> <span style="color: #000000; background: #FFFFFF;">f = [f ; zeros(n0,1)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 821</span> <span style="color: #000000; background: #FFFFFF;">H = [H zeros(n,n0);  </span><br/>               <span style="color: #A0A0A0"> 822</span> <span style="color: #000000; background: #FFFFFF;">     zeros(n0,n) zeros(n0)];</span><br/>               <span style="color: #A0A0A0"> 823</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 824</span> <span style="color: #228B22; background: #FFFFFF;">     </span><br/>               <span style="color: #A0A0A0"> 825</span> <span style="color: #228B22; background: #FFFFFF;">%% track change: 6</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 826</span> <span style="color: #000000; background: #FFFFFF;">sstruct.lb6 = xLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 827</span> <span style="color: #000000; background: #FFFFFF;">sstruct.ub6 = xUB; </span><br/>               <span style="color: #A0A0A0"> 828</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 829</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 830</span> <span style="color: #000000; background: #FFFFFF;">L = zeros(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 831</span> <span style="color: #000000; background: #FFFFFF;">U = ones(nn,1); </span><br/>               <span style="color: #A0A0A0"> 832</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 833</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0"> 834</span> <span style="color: #228B22; background: #FFFFFF;">%% Prep complementarity</span><br/>               <span style="color: #A0A0A0"> 835</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0"> 836</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 837</span> <span style="color: #000000; background: #FFFFFF;">E = zeros(nn); </span><br/>               <span style="color: #A0A0A0"> 838</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 839</span> <span style="color: #228B22; background: #FFFFFF;">%% s .* lambda = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 840</span> <span style="color: #000000; background: #FFFFFF;">n0 = n+m+lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 841</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:m </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 842</span> <span style="color: #000000; background: #FFFFFF;">    E(n+i, n0+i ) = 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 843</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 844</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 845</span> <span style="color: #228B22; background: #FFFFFF;">%% xL .* zL = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 846</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+m+meq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 847</span> <span style="color: #000000; background: #FFFFFF;">for k=1:lenL </span><br/>               <span style="color: #A0A0A0"> 848</span> <span style="color: #A0A0A0; background: #FFFFFF;">  i = idxL(k);</span><br/>               <span style="color: #A0A0A0"> 849</span> <span style="color: #A0A0A0; background: #FFFFFF;">  E(i,n0+k) = 1;</span><br/>               <span style="color: #A0A0A0"> 850</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 851</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 852</span> <span style="color: #228B22; background: #FFFFFF;">%% xB .* zB = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 853</span> <span style="color: #000000; background: #FFFFFF;">n0 = nn - 2*lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 854</span> <span style="color: #000000; background: #FFFFFF;">for k=1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 855</span> <span style="color: #000000; background: #FFFFFF;">  i = idxB(k); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 856</span> <span style="color: #000000; background: #FFFFFF;">  E(i,n0+k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 857</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 858</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 859</span> <span style="color: #228B22; background: #FFFFFF;">%% wB .* rB = 0</span><br/>               <span style="color: #A0A0A0"> 860</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 861</span> <span style="color: #000000; background: #FFFFFF;">n00 = n+m; n0 = nn-lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 862</span> <span style="color: #000000; background: #FFFFFF;">for k = 1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 863</span> <span style="color: #000000; background: #FFFFFF;">  E(n00+k,n0+k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 864</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 865</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 866</span> <span style="color: #228B22; background: #FFFFFF;">%% zB .* rB = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 867</span> <span style="color: #000000; background: #FFFFFF;">n00 = nn - 2*lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 868</span> <span style="color: #000000; background: #FFFFFF;">for k = 1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 869</span> <span style="color: #000000; background: #FFFFFF;">  E(n00+k,n0+k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 870</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 871</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 872</span> <span style="color: #000000; background: #FFFFFF;">E = E + E'; </span><br/>               <span style="color: #A0A0A0"> 873</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 874</span> <span style="color: #000000; background: #FFFFFF;">sstruct.cmp1 = [ n+(1:m)'; idxL ; idxB; n+m+(1:lenB)']; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 875</span> <span style="color: #000000; background: #FFFFFF;">sstruct.cmp2 = [ n+m+lenB+(1:m)'; nn-2*lenB-lenL+(1:lenL)'; nn-2*lenB+(1:lenB)'; nn-lenB+(1:lenB)']; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 876</span> <span style="color: #000000; background: #FFFFFF;">sstruct.lenB = lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 877</span> <span style="color: #000000; background: #FFFFFF;">sstruct.m = m; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 878</span> <span style="color: #000000; background: #FFFFFF;">sstruct.n = n; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 879</span> <span style="color: #000000; background: #FFFFFF;">sstruct.lenL = lenL; </span><br/>               <span style="color: #A0A0A0"> 880</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 881</span> <a name="Line881"></a><span style="color: #000000; background: #FFFFFF;">return </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>