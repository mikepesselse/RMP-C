<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for quadprogbb</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">quadprogbb (1 call, 9.244 sec)</span><br/><i>Generated 06-Oct-2011 17:14:08 using cpu time.</i><br/>M-function in file /nfs/dollar/local/vol00/user0/jieqchen/new/quadprogbb/quadprogbb/mpc/code/quadprogbb.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/> No parent <div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line276">276</a></td><td class="td-linebottomrt"><pre>[newLB,Y,Z,S,SIG,ret] = opt_dn...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">4.724 s</td><td class="td-linebottomrt" class="td-linebottomrt">51.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=51 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line66">66</a></td><td class="td-linebottomrt"><pre>[H,f,A,b,E,cons,L,U,sstruct,ti...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.110 s</td><td class="td-linebottomrt" class="td-linebottomrt">12.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line131">131</a></td><td class="td-linebottomrt"><pre>[xx,gUB] = quadprog(H,f,[],[],...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.059 s</td><td class="td-linebottomrt" class="td-linebottomrt">11.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=11 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line274">274</a></td><td class="td-linebottomrt"><pre>if isfeasible(local_A,local_b,...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0.743 s</td><td class="td-linebottomrt" class="td-linebottomrt">8.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line349">349</a></td><td class="td-linebottomrt"><pre>[tmpx,tmpval] = quadprog(H,f,[...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0.509 s</td><td class="td-linebottomrt" class="td-linebottomrt">5.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">1.099 s</td><td class="td-linebottomrt">11.9%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">9.244 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file4.html">opt_dnn</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">4.713 s</td><td class="td-linebottomrt">51.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=51 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file29.html">quadprog</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">39</td><td class="td-linebottomrt">1.924 s</td><td class="td-linebottomrt">20.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=21 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file6.html">quadprogbb>standardform</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.110 s</td><td class="td-linebottomrt">12.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file47.html">quadprogbb>isfeasible</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0.743 s</td><td class="td-linebottomrt">8.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file42.html">quadprogbb>project</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">38</td><td class="td-linebottomrt">0.417 s</td><td class="td-linebottomrt">4.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file12.html">union</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">56</td><td class="td-linebottomrt">0.092 s</td><td class="td-linebottomrt">1.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file10.html">setdiff</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">0.020 s</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file8.html">ismember</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">9</td><td class="td-linebottomrt">0.020 s</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file1.html">maxNumCompThreads</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file52.html">quadprogbb>getsol</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file43.html">quadprogbb>fixedAb</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file5.html">quadprogbb>checkinput</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.193 s</td><td class="td-linebottomrt">2.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">9.244 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line80">80</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'nodes_solved' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line96">96</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'n' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line133">133</a></td><td class="td-linebottomrt"><span class="mono">This statement (and possibly following ones) cannot be reached.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line142">142</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'LB_beat' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line171">171</a></td><td class="td-linebottomrt"><span class="mono">Using ISEMPTY is usually faster than comparing LENGTH to 0.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line271">271</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line272">272</a></td><td class="td-linebottomrt"><span class="mono">Terminate statement with semicolon to suppress output (in functions).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line351">351</a></td><td class="td-linebottomrt"><span class="mono">This statement (and possibly following ones) cannot be reached.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line370">370</a></td><td class="td-linebottomrt"><span class="mono">This statement (and possibly following ones) cannot be reached.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line424">424</a></td><td class="td-linebottomrt"><span class="mono">Use && instead of & as the AND operator in (scalar) conditional statements.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line426">426</a></td><td class="td-linebottomrt"><span class="mono">IF might not be aligned with its matching END (line 489).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line433">433</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line434">434</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line435">435</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line454">454</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line455">455</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line456">456</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line463">463</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line464">464</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line465">465</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line476">476</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line477">477</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line478">478</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line485">485</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line486">486</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line487">487</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">539</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">272</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">267</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">189</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">78</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">70.79 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [fval,x,time,stat] = quadprogbb(H,f,A,b,Aeq,beq,LB,UB,max_time,cons)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%addpath(genpath('cplex122/matlab/'));</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">   4</span> <span style="color: #000000; background: #FFFFFF;">use_quadprog = 1; </span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%% statistics: </span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%% tPre: time spent on preprocessing</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%% tLP:  time spent on calculating bounds in preprocessing</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%% tBB:  time spent on B&amp;B</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%% nodes: total nodes_solved</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  12</span> <span style="color: #000000; background: #FFFFFF;">stat = struct('tPre',0,'tLP',0,'tBB',0,'nodes',0); </span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  14</span> <span style="color: #000000; background: #FFFFFF;">tic; </span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">% warning('Could I be introducing unexpected error with all the transformations? Right now, all B&amp;B calculations are based on transformed problem.');</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">% warning('Can complmentarity help strengthen LPs to get dual variable bounds? Dont think so because quadratic terms including dual vars are not present yet.');</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">% warning('Final x and fval returned are for transformed problem!');</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">% warning('Probably should handle leaf nodes more confidently.');</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%% Set user options</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  25</span> <span style="color: #000000; background: #FFFFFF;">my_tol  = 1.0e-6;     % Fathoming and branching tolerance </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  26</span> <span style="color: #000000; background: #FFFFFF;">tol = 1e-8;           % if |ub-lb| &lt; tol, we consider lb==ub </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  27</span> <span style="color: #000000; background: #FFFFFF;">max_iter = 1000;      % Max iters allowed for solving each relaxation </span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%%-------------------------------------------</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%% Set max_time if user has *not* specified it</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  33</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 9 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  34</span> <span style="color: #000000; background: #FFFFFF;">    max_time = Inf; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  35</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%% Set constant term if user has *not* specified it</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  41</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 10 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  42</span> <span style="color: #000000; background: #FFFFFF;">    cons = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  43</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%% Ensure Matlab uses only one CPU</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  49</span> <span style="color: #000000; background: #FFFFFF;"><a href="file1.html">maxNumCompThreads</a>(1); </span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%% Check inputs for simple errors</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  55</span> <span style="color: #000000; background: #FFFFFF;"><a href="file5.html">checkinput</a>(H,f,A,b,Aeq,beq,LB,UB); </span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%% Problem is now turned into standard form</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%%   min   0.5*x'*H*x + f'*x</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%%   s.t.  A*x = b, x &gt;= 0</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%%         [x*x']_E == 0</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%% Bounds x &lt;= 1 are valid</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  1.11 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  66</span> <a name="Line66"></a><span style="color: #000000; background: #FFE2E2;">[H,f,A,b,E,cons,L,U,sstruct,timeLP] = <a href="file6.html">standardform</a>(H,f,A,b,Aeq,beq,LB,UB,cons); </span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  68</span> <span style="color: #000000; background: #FFFFFF;">save standard H f A b E cons L U </span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  70</span> <span style="color: #000000; background: #FFFFFF;">fprintf('\n'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  71</span> <span style="color: #000000; background: #FFFFFF;">fprintf('Pre-Processing is complete, time = %d\n\n',toc); </span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  73</span> <span style="color: #000000; background: #FFFFFF;">stat.tPre = toc; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  74</span> <span style="color: #000000; background: #FFFFFF;">stat.tLP = timeLP; </span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">if sstruct.flag </span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fval = sstruct.obj;</span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #A0A0A0; background: #FFFFFF;">  x = getsol([],sstruct);</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #A0A0A0; background: #FFFFFF;">  time = toc;</span><br/><a name="Line80"></a>               <span style="color: #A0A0A0">  80</span> <span style="color: #A0A0A0; background: #FFFFFF;">  nodes_solved = 0;</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('\n');</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 1: optimal value = %.8e\n', fval);</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 2: (created,solved,pruned,infeas,left) = (%d,%d,%d,%d,%d)\n', ...</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #A0A0A0; background: #FFFFFF;">      0,0,0,0,0);</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 3: solved = fully + fathomed + poorly : %d = %d + %d + %d\n', ...</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #A0A0A0; background: #FFFFFF;">      0,0,0,0);</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 4: time = %d\n', time);</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #A0A0A0; background: #FFFFFF;">  return</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;"> </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">cmp1 = sstruct.cmp1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  92</span> <span style="color: #000000; background: #FFFFFF;">cmp2 = sstruct.cmp2; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  93</span> <span style="color: #000000; background: #FFFFFF;">lenB = sstruct.lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  94</span> <span style="color: #000000; background: #FFFFFF;">lenL = sstruct.lenL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">m = sstruct.m; </span><br/><a name="Line96"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">n = sstruct.n; </span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  98</span> <span style="color: #000000; background: #FFFFFF;">m0 = length(cmp1); </span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">Fx = find(abs(L(cmp1)-U(cmp1))&lt;tol &amp; abs(L(cmp1)-0)&lt;tol); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 101</span> <span style="color: #000000; background: #FFFFFF;">Fz = find(abs(L(cmp2)-U(cmp2))&lt;tol &amp; abs(L(cmp2)-0)&lt;tol); </span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">%% Setup constants for passage into opt_dnn subroutine</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">%% Constant n saved above</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">bign = size(A,2); </span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #228B22; background: #FFFFFF;">%% Assign fixed values to lower and upper bounds</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 111</span> <span style="color: #000000; background: #FFFFFF;">L_save = L; % Subproblems will only differ in L and U </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 112</span> <span style="color: #000000; background: #FFFFFF;">U_save = U; </span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 114</span> <span style="color: #000000; background: #FFFFFF;">B = []; </span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------</span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;">%% Initialize B&amp;B structures</span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------</span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF;">LBLB = -Inf; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 121</span> <span style="color: #000000; background: #FFFFFF;">FxFx{1} = Fx; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 122</span> <span style="color: #000000; background: #FFFFFF;">FzFz{1} = Fz; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 123</span> <span style="color: #000000; background: #FFFFFF;">SS = zeros((1+bign)^2,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 124</span> <span style="color: #000000; background: #FFFFFF;">SIGSIG = -1; % Signal that we want default sig in aug Lag algorithm </span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;">%% Calculate first global upper bound and associated fathoming target</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF;">if use_quadprog </span><br/><span style="color: #FF0000">  1.06 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 131</span> <a name="Line131"></a><span style="color: #000000; background: #FFE2E2;">  [xx,gUB] = <a href="file29.html">quadprog</a>(H,f,[],[],A,b,L_save,U_save); </span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/><a name="Line133"></a>               <span style="color: #A0A0A0"> 133</span> <span style="color: #A0A0A0; background: #FFFFFF;">  xx = [];</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #A0A0A0; background: #FFFFFF;">  gUB = Inf;</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">if gUB == Inf </span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF;">  LB_target = Inf;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 139</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">  LB_target = gUB - my_tol*max(1,abs(gUB)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/><a name="Line142"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">LB_beat = -Inf; </span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">%% Begin BRANCH-AND-BOUND</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 150</span> <span style="color: #000000; background: #FFFFFF;">nodes_created         = 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved          = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 152</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved_fully    = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 153</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved_fathomed = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 154</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved_poorly   = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 155</span> <span style="color: #000000; background: #FFFFFF;">nodes_infeasible      = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFFFFF;">nodes_pruned          = 0; </span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;">%% While there are still nodes in the tree...</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;">%% Store fixed components index to prevent these variables's bounds from</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">%% changing</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">Fx0 = Fx; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 165</span> <span style="color: #000000; background: #FFFFFF;">Fz0 = Fz; </span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 167</span> <span style="color: #000000; background: #FFFFFF;">t0 = m+lenL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 168</span> <span style="color: #000000; background: #FFFFFF;">t1 = m+lenL+lenB; </span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line171"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF;">while length(LBLB) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #228B22; background: #FFFFFF;">    %% Print status</span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------</span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 177</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('\n'); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 178</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('STATUS 1: (gUB,gLB,gap) = (%.8e, %.8e, %.3f%%)\n', ... </span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #000000; background: #FFFFFF;">        gUB+cons, min(LBLB)+cons, 100*(gUB - min(LBLB))/max([1,abs(gUB+cons)]));</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 180</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('STATUS 2: (created,solved,pruned,infeas,left) = (%d,%d,%d,%d,%d)\n', ... </span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #000000; background: #FFFFFF;">        nodes_created, nodes_solved, nodes_pruned, nodes_infeasible, length(LBLB));</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 182</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('STATUS 3: solved = fully + fathomed + poorly : %d = %d + %d + %d\n', ... </span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #000000; background: #FFFFFF;">        nodes_solved, nodes_solved_fully, nodes_solved_fathomed, nodes_solved_poorly);</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 184</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('STATUS 4: time = %d\n', toc); </span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------------</span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;">    %% Terminate if too much time has passed</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------------</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 190</span> <span style="color: #000000; background: #FFFFFF;">    if toc &gt; max_time </span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #A0A0A0; background: #FFFFFF;">        break;</span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">    %% Sort nodes for 'best-bound' node-selection rule</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 198</span> <span style="color: #000000; background: #FFFFFF;">    [LBLB,I] = sort(LBLB,2,'descend'); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 199</span> <span style="color: #000000; background: #FFFFFF;">    FxFx = FxFx(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 200</span> <span style="color: #000000; background: #FFFFFF;">    FzFz = FzFz(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 201</span> <span style="color: #000000; background: #FFFFFF;">    SS = SS(:,I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 202</span> <span style="color: #000000; background: #FFFFFF;">    SIGSIG = SIGSIG(I); </span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 205</span> <span style="color: #228B22; background: #FFFFFF;">    %% Pull last problem off the problem list (best-bound)</span><br/>               <span style="color: #A0A0A0"> 206</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 208</span> <span style="color: #000000; background: #FFFFFF;">    LB = LBLB(end); </span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 210</span> <span style="color: #000000; background: #FFFFFF;">    Fx = FxFx(end); Fx = Fx{1}; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 211</span> <span style="color: #000000; background: #FFFFFF;">    Fz = FzFz(end); Fz = Fz{1}; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 212</span> <span style="color: #000000; background: #FFFFFF;">    S = reshape(SS(:,end), 1+bign, 1+bign); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 213</span> <span style="color: #000000; background: #FFFFFF;">    SIG = SIGSIG(end); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 214</span> <span style="color: #000000; background: #FFFFFF;">    if SIG &lt; 0.0 % Signal that we want default sig in aug Lag algorithm </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 215</span> <span style="color: #000000; background: #FFFFFF;">        SIG = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 216</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------</span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;">    %% Delete that problem from the tree</span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------</span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 222</span> <span style="color: #000000; background: #FFFFFF;">    LBLB = LBLB(1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #000000; background: #FFFFFF;">    FxFx = FxFx(1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF;">    FzFz = FzFz(1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 225</span> <span style="color: #000000; background: #FFFFFF;">    SS = SS(:,1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 226</span> <span style="color: #000000; background: #FFFFFF;">    SIGSIG = SIGSIG(1:end-1); </span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------------</span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;">    %% Handle single node</span><br/>               <span style="color: #A0A0A0"> 230</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------------</span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;">    %% ----------------------------</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;">    %% Prepare problem to be solved</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">    %% ----------------------------</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF;">    L = L_save; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">    U = U_save; </span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #228B22; background: #FFFFFF;">    %%------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #228B22; background: #FFFFFF;">    %% Prepare L and U for new structure of vars</span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #228B22; background: #FFFFFF;">    %%------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #228B22; background: #FFFFFF;">    %% X(Fx) = 0, X(Fz) = 0</span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 244</span> <span style="color: #000000; background: #FFFFFF;">    set1 = cmp1(Fx); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">    set2 = cmp2(Fz); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 246</span> <span style="color: #000000; background: #FFFFFF;">    U(set1) = 0;     % set the components to be zero </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 247</span> <span style="color: #000000; background: #FFFFFF;">    U(set2) = 0;     % set the lambda components to be zero </span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #228B22; background: #FFFFFF;">    %% Setup LB_beat</span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 251</span> <span style="color: #000000; background: #FFFFFF;">    if LB == -Inf </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 252</span> <span style="color: #000000; background: #FFFFFF;">      LB_beat = -Inf; </span><br/>       <span style="color: #0000FF">     18 </span><span style="color: #000000; font-weight: bold"> 253</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">     18 </span><span style="color: #000000; font-weight: bold"> 254</span> <span style="color: #000000; background: #FFFFFF;">      LB_beat = LB - my_tol*max(1,abs(LB)); </span><br/>       <span style="color: #0000FF">     18 </span><span style="color: #000000; font-weight: bold"> 255</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #228B22; background: #FFFFFF;">    %% Sam: Need to use U-L to find fixed variables. Add same</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;">    %% fixings to Ax=b. If variable is fixed to 0, can zero</span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">    %% out other entries in same column of A.</span><br/>               <span style="color: #A0A0A0"> 260</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 262</span> <span style="color: #000000; background: #FFFFFF;">    [local_A,local_b] = <a href="file43.html">fixedAb</a>(A,b,L,U); </span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------</span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF;">    %% Solve doubly nonnegative relaxation</span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------</span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('\n=======================================================================\n'); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('------------------ Commencing solution of node %4d -------------------\n', nodes_solved+1); </span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line271"></a>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 271</span> <span style="color: #000000; background: #FFFFFF;">    Fx </span><br/><a name="Line272"></a><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 272</span> <span style="color: #000000; background: #FFFFFF;">    Fz </span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.74 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 274</span> <a name="Line274"></a><span style="color: #000000; background: #FFF0F0;">    if <a href="file47.html">isfeasible</a>(local_A,local_b,L,U) </span><br/>               <span style="color: #A0A0A0"> 275</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  4.72 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 276</span> <a name="Line276"></a><span style="color: #000000; background: #FF8080;">      [newLB,Y,Z,S,SIG,ret] = <a href="file4.html">opt_dnn</a>(H,f,local_A,local_b,B,E,L,U,max_iter,S,SIG,LB_target,LB_beat,max_time-toc,cons); </span><br/>               <span style="color: #A0A0A0"> 277</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #A0A0A0; background: #FFFFFF;">      ret = 'infeas';</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 284</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('\n------------------------------- done! ---------------------------------\n'); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 285</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('=======================================================================\n\n'); </span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 287</span> <span style="color: #000000; background: #FFFFFF;">    if ~strcmp(ret,'infeas') </span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------</span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #228B22; background: #FFFFFF;">      %% Post-process</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #228B22; background: #FFFFFF;">      %% If newLB &lt; LB, then it means that the subproblem did not solve</span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #228B22; background: #FFFFFF;">      %% well because theoretically, newLB &gt;= LB at optimality. So we take</span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;">      %% this as a sign that sig needs to be reset. So we set SIG = -1 to</span><br/>               <span style="color: #A0A0A0"> 296</span> <span style="color: #228B22; background: #FFFFFF;">      %% signal that we want sig reset for the children.</span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;">      %% Otherwise, we update LB and save SIG for any children.</span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF;">      if strcmp(ret,'poor') </span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #A0A0A0; background: #FFFFFF;">        SIG = -1.0;</span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #A0A0A0; background: #FFFFFF;">        S = zeros(size(S,1));</span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 304</span> <span style="color: #000000; background: #FFFFFF;">      if newLB &gt;= LB </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 305</span> <span style="color: #000000; background: #FFFFFF;">        LB = newLB; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 306</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 308</span> <span style="color: #000000; background: #FFFFFF;">      nodes_solved = nodes_solved + 1; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 309</span> <span style="color: #000000; background: #FFFFFF;">      if strcmp(ret,'fathom') </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 310</span> <span style="color: #000000; background: #FFFFFF;">        nodes_solved_fathomed = nodes_solved_fathomed + 1; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF;">      elseif strcmp(ret,'poor') </span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #A0A0A0; background: #FFFFFF;">        nodes_solved_poorly = nodes_solved_poorly + 1;</span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 313</span> <span style="color: #228B22; background: #FFFFFF;">      else  </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 314</span> <span style="color: #000000; background: #FFFFFF;">        nodes_solved_fully = nodes_solved_fully + 1; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 315</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF;">      %% Save multiplier</span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 319</span> <span style="color: #000000; background: #FFFFFF;">      S = reshape(S, (1+bign)^2, 1); </span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF;">      %% Extract upper bound (4-part primal heuristic)</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #228B22; background: #FFFFFF;">      %% First extract 0-th column of Y and project it onto Ax=b,x&gt;=0</span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #228B22; background: #FFFFFF;">      %% using CPLEX. Get value and update gUB if necessary.</span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #228B22; background: #FFFFFF;">      %% </span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #228B22; background: #FFFFFF;">      %% Then run quadprog() from this point (if desired).</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #228B22; background: #FFFFFF;">      %% Next extract 0-th column of Z and project it onto Ax=b,x&gt;=0 using</span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #228B22; background: #FFFFFF;">      %% CPLEX. Get value and update gUB if necessary.</span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #228B22; background: #FFFFFF;">      %% </span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #228B22; background: #FFFFFF;">      %% Then run quadprog() from this point (if desired).</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;">      %% We presume that CPLEX can return as good a feasible solution as</span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #228B22; background: #FFFFFF;">      %% any algorithm. (We do not check anything at the moment. Is this</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">      %% safe?)</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #228B22; background: #FFFFFF;">      %% Right now, we use projected version of 0-th col of Z for</span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">      %% branching. Is this a good choice?</span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 340</span> <span style="color: #000000; background: #FFFFFF;">      x0 = Y(2:bign+1,1); </span><br/><span style="color: #FF0000">  0.30 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 341</span> <span style="color: #000000; background: #FFFFFF;">      x0 = <a href="file42.html">project</a>(x0,local_A,local_b,L,U); %% In CPLEX we trust!  </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 342</span> <span style="color: #000000; background: #FFFFFF;">      x0val = 0.5*x0'*H*x0 + f'*x0; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 343</span> <span style="color: #000000; background: #FFFFFF;">      if x0val &lt; gUB % x0 is best so far </span><br/>               <span style="color: #A0A0A0"> 344</span> <span style="color: #A0A0A0; background: #FFFFFF;">        gUB = x0val;</span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xx = x0;</span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 348</span> <span style="color: #000000; background: #FFFFFF;">      if use_quadprog </span><br/><span style="color: #FF0000">  0.51 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 349</span> <a name="Line349"></a><span style="color: #000000; background: #FFF0F0;">        [tmpx,tmpval] = <a href="file29.html">quadprog</a>(H,f,[],[],A,b,L_save,U_save,x0); </span><br/>               <span style="color: #A0A0A0"> 350</span> <span style="color: #228B22; background: #FFFFFF;">      else</span><br/><a name="Line351"></a>               <span style="color: #A0A0A0"> 351</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpx = [];</span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpval = Inf;</span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 354</span> <span style="color: #000000; background: #FFFFFF;">      if tmpval &lt; gUB </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 355</span> <span style="color: #000000; background: #FFFFFF;">        gUB = tmpval; </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 356</span> <span style="color: #000000; background: #FFFFFF;">        xx = tmpx; </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 357</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 359</span> <span style="color: #000000; background: #FFFFFF;">      x0 = Z(2:bign+1,1)/Z(1,1); </span><br/><span style="color: #FF0000">  0.15 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 360</span> <span style="color: #000000; background: #FFFFFF;">      x0 = <a href="file42.html">project</a>(x0,local_A,local_b,L,U); %% In CPLEX we trust!  </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 361</span> <span style="color: #000000; background: #FFFFFF;">      x0val = 0.5*x0'*H*x0 + f'*x0; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 362</span> <span style="color: #000000; background: #FFFFFF;">      if x0val &lt; gUB % x0 is better than what <a href="file29.html">quadprog</a> found </span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #A0A0A0; background: #FFFFFF;">        gUB = x0val;</span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xx = x0;</span><br/>               <span style="color: #A0A0A0"> 365</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>               <span style="color: #A0A0A0"> 366</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 367</span> <span style="color: #000000; background: #FFFFFF;">      if use_quadprog </span><br/><span style="color: #FF0000">  0.38 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 368</span> <span style="color: #000000; background: #FFFFFF;">        [tmpx,tmpval] = <a href="file29.html">quadprog</a>(H,f,[],[],A,b,L_save,U_save,x0); </span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #228B22; background: #FFFFFF;">      else</span><br/><a name="Line370"></a>               <span style="color: #A0A0A0"> 370</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpx = [];</span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpval = Inf;</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 373</span> <span style="color: #000000; background: #FFFFFF;">      if tmpval &lt; gUB </span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #A0A0A0; background: #FFFFFF;">        gUB = tmpval;</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xx = tmpx;</span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #228B22; background: #FFFFFF;">      %% Update fathoming target</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 380</span> <span style="color: #000000; background: #FFFFFF;">      if gUB == Inf </span><br/>               <span style="color: #A0A0A0"> 381</span> <span style="color: #A0A0A0; background: #FFFFFF;">        LB_target = Inf;</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 382</span> <span style="color: #228B22; background: #FFFFFF;">      else </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 383</span> <span style="color: #000000; background: #FFFFFF;">        LB_target = gUB - my_tol*max(1,abs(gUB)); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 384</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #228B22; background: #FFFFFF;">      %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #228B22; background: #FFFFFF;">      %% Prune tree by gUB</span><br/>               <span style="color: #A0A0A0"> 388</span> <span style="color: #228B22; background: #FFFFFF;">      %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 390</span> <span style="color: #000000; background: #FFFFFF;">      tmpsz = length(LBLB); </span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 392</span> <span style="color: #000000; background: #FFFFFF;">      I = find(LBLB &lt; LB_target); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 393</span> <span style="color: #000000; background: #FFFFFF;">      LBLB = LBLB(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 394</span> <span style="color: #000000; background: #FFFFFF;">      FxFx = FxFx(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 395</span> <span style="color: #000000; background: #FFFFFF;">      FzFz = FzFz(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 396</span> <span style="color: #000000; background: #FFFFFF;">      SS = SS(:,I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 397</span> <span style="color: #000000; background: #FFFFFF;">      SIGSIG = SIGSIG(I); </span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 399</span> <span style="color: #000000; background: #FFFFFF;">      nodes_pruned = nodes_pruned + (tmpsz - length(LBLB)); </span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 402</span> <span style="color: #228B22; background: #FFFFFF;">      %% Select index to branch on (but will only branch if LB &lt; LB_target)</span><br/>               <span style="color: #A0A0A0"> 403</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 405</span> <span style="color: #000000; background: #FFFFFF;">      if length(<a href="file12.html">union</a>(Fx,Fz)) &lt; m0 </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 406</span> <span style="color: #000000; background: #FFFFFF;">          x0 = Y(2:bign+1,1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 407</span> <span style="color: #000000; background: #FFFFFF;">          s = x0(cmp1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 408</span> <span style="color: #000000; background: #FFFFFF;">          lambda = x0(cmp2); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 409</span> <span style="color: #000000; background: #FFFFFF;">          [vio,index] = max( s .* lambda ); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 410</span> <span style="color: #000000; background: #FFFFFF;">          if vio == 0 % Got unlucky, just select first index available for branching </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 411</span> <span style="color: #000000; background: #FFFFFF;">              Ffix = <a href="file12.html">union</a>(Fx0, Fz0); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 412</span> <span style="color: #000000; background: #FFFFFF;">              tmpI = <a href="file10.html">setdiff</a>( <a href="file10.html">setdiff</a>(1:m0,Ffix) , <a href="file12.html">union</a>(Fx,Fz)); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 413</span> <span style="color: #000000; background: #FFFFFF;">              index = tmpI(1); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 414</span> <span style="color: #000000; background: #FFFFFF;">          end </span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #228B22; background: #FFFFFF;">          %% ---------------------</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #228B22; background: #FFFFFF;">          %% Branch (if necessary)</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #228B22; background: #FFFFFF;">          %% ---------------------</span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #228B22; background: #FFFFFF;">          %%</span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #228B22; background: #FFFFFF;">          %% We do not check primal feasibility because (x,z) are assumed</span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #228B22; background: #FFFFFF;">          %% part of a feasible x0 via CPLEX (see above). In CPLEX we</span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #228B22; background: #FFFFFF;">          %% trust!</span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #228B22; background: #FFFFFF;">          %%</span><br/><a name="Line424"></a><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 424</span> <span style="color: #000000; background: #FFFFFF;">           if LB &lt; LB_target &amp; vio &gt; my_tol </span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line426"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 426</span> <span style="color: #000000; background: #FFFFFF;">              if index &lt;= t0 </span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fxa = union(Fx,index);</span><br/>               <span style="color: #A0A0A0"> 428</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fza = Fz;</span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fxb = Fx;</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fzb = union(Fz,index);</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line433"></a>               <span style="color: #A0A0A0"> 433</span> <span style="color: #A0A0A0; background: #FFFFFF;">                LBLB   = [LBLB  ,LB ,LB ];</span><br/><a name="Line434"></a>               <span style="color: #A0A0A0"> 434</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SS     = [SS    ,S  ,S  ];</span><br/><a name="Line435"></a>               <span style="color: #A0A0A0"> 435</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SIGSIG = [SIGSIG,SIG,SIG];</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxa;</span><br/>               <span style="color: #A0A0A0"> 438</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fza;</span><br/>               <span style="color: #A0A0A0"> 439</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxb;</span><br/>               <span style="color: #A0A0A0"> 441</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fzb;</span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nodes_created = nodes_created + 2;</span><br/>               <span style="color: #A0A0A0"> 444</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 445</span> <span style="color: #000000; background: #FFFFFF;">              elseif index &lt;= t1 </span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #228B22; background: #FFFFFF;">              %% if t0 &lt; index &lt;= t1, then only add index to Fx if index+lenB not in Fx</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #228B22; background: #FFFFFF;">              %% in case the second 'if' holds, then add index+lenB to Fz</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 449</span> <span style="color: #000000; background: #FFFFFF;">              if ~<a href="file8.html">ismember</a>(index+lenB,Fx) </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 450</span> <span style="color: #000000; background: #FFFFFF;">                Fxa = <a href="file12.html">union</a>(Fx,index); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 451</span> <span style="color: #000000; background: #FFFFFF;">                Fza = <a href="file12.html">union</a>(Fz,index+lenB); </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 452</span> <span style="color: #000000; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxa; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 453</span> <span style="color: #000000; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fza; </span><br/><a name="Line454"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 454</span> <span style="color: #000000; background: #FFFFFF;">                LBLB   = [LBLB  ,LB ]; </span><br/><a name="Line455"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 455</span> <span style="color: #000000; background: #FFFFFF;">                SS     = [SS    ,S  ]; </span><br/><a name="Line456"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 456</span> <span style="color: #000000; background: #FFFFFF;">                SIGSIG = [SIGSIG,SIG]; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 457</span> <span style="color: #000000; background: #FFFFFF;">                nodes_created = nodes_created + 1; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 458</span> <span style="color: #000000; background: #FFFFFF;">              end </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 459</span> <span style="color: #000000; background: #FFFFFF;">              Fxb = Fx; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 460</span> <span style="color: #000000; background: #FFFFFF;">              Fzb = <a href="file12.html">union</a>(Fz,index); </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 461</span> <span style="color: #000000; background: #FFFFFF;">              FxFx{length(FxFx)+1} = Fxb; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 462</span> <span style="color: #000000; background: #FFFFFF;">              FzFz{length(FzFz)+1} = Fzb; </span><br/><a name="Line463"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 463</span> <span style="color: #000000; background: #FFFFFF;">              LBLB   = [LBLB  ,LB ]; </span><br/><a name="Line464"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 464</span> <span style="color: #000000; background: #FFFFFF;">              SS     = [SS    ,S  ]; </span><br/><a name="Line465"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 465</span> <span style="color: #000000; background: #FFFFFF;">              SIGSIG = [SIGSIG,SIG]; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 466</span> <span style="color: #000000; background: #FFFFFF;">              nodes_created = nodes_created + 1; </span><br/>               <span style="color: #A0A0A0"> 467</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 468</span> <span style="color: #228B22; background: #FFFFFF;">              %% if index &gt; t1, then only add index to Fx if index-lenB not in Fx</span><br/>               <span style="color: #A0A0A0"> 469</span> <span style="color: #228B22; background: #FFFFFF;">              %% in case the second if holds, then add index-lenB to Fz</span><br/>               <span style="color: #A0A0A0"> 470</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 471</span> <span style="color: #A0A0A0; background: #FFFFFF;">              if ~ismember(index-lenB,Fx)</span><br/>               <span style="color: #A0A0A0"> 472</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fxa = union(Fx,index);</span><br/>               <span style="color: #A0A0A0"> 473</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fza = union(Fz,index-lenB);</span><br/>               <span style="color: #A0A0A0"> 474</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxa;</span><br/>               <span style="color: #A0A0A0"> 475</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fza;</span><br/><a name="Line476"></a>               <span style="color: #A0A0A0"> 476</span> <span style="color: #A0A0A0; background: #FFFFFF;">                LBLB   = [LBLB  ,LB ];</span><br/><a name="Line477"></a>               <span style="color: #A0A0A0"> 477</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SS     = [SS    ,S  ];</span><br/><a name="Line478"></a>               <span style="color: #A0A0A0"> 478</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SIGSIG = [SIGSIG,SIG];</span><br/>               <span style="color: #A0A0A0"> 479</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nodes_created = nodes_created + 1;</span><br/>               <span style="color: #A0A0A0"> 480</span> <span style="color: #A0A0A0; background: #FFFFFF;">              end</span><br/>               <span style="color: #A0A0A0"> 481</span> <span style="color: #A0A0A0; background: #FFFFFF;">              Fxb = Fx;</span><br/>               <span style="color: #A0A0A0"> 482</span> <span style="color: #A0A0A0; background: #FFFFFF;">              Fzb = union(Fz,index);</span><br/>               <span style="color: #A0A0A0"> 483</span> <span style="color: #A0A0A0; background: #FFFFFF;">              FxFx{length(FxFx)+1} = Fxb;</span><br/>               <span style="color: #A0A0A0"> 484</span> <span style="color: #A0A0A0; background: #FFFFFF;">              FzFz{length(FzFz)+1} = Fzb;</span><br/><a name="Line485"></a>               <span style="color: #A0A0A0"> 485</span> <span style="color: #A0A0A0; background: #FFFFFF;">              LBLB   = [LBLB  ,LB ];</span><br/><a name="Line486"></a>               <span style="color: #A0A0A0"> 486</span> <span style="color: #A0A0A0; background: #FFFFFF;">              SS     = [SS    ,S  ];</span><br/><a name="Line487"></a>               <span style="color: #A0A0A0"> 487</span> <span style="color: #A0A0A0; background: #FFFFFF;">              SIGSIG = [SIGSIG,SIG];</span><br/>               <span style="color: #A0A0A0"> 488</span> <span style="color: #A0A0A0; background: #FFFFFF;">              nodes_created = nodes_created + 1;</span><br/>               <span style="color: #A0A0A0"> 489</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 490</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 491</span> <span style="color: #228B22; background: #FFFFFF;">              %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 492</span> <span style="color: #228B22; background: #FFFFFF;">              %% End branching decision</span><br/>               <span style="color: #A0A0A0"> 493</span> <span style="color: #228B22; background: #FFFFFF;">              %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 494</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 495</span> <span style="color: #000000; background: #FFFFFF;">          end </span><br/>               <span style="color: #A0A0A0"> 496</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 497</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 498</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 499</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 500</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 501</span> <span style="color: #A0A0A0; background: #FFFFFF;">      nodes_infeasible = nodes_infeasible + 1;</span><br/>               <span style="color: #A0A0A0"> 502</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 503</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 504</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 505</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------</span><br/>               <span style="color: #A0A0A0"> 506</span> <span style="color: #228B22; background: #FFFFFF;">    %% End handling of single node</span><br/>               <span style="color: #A0A0A0"> 507</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------</span><br/>               <span style="color: #A0A0A0"> 508</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 509</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------</span><br/>               <span style="color: #A0A0A0"> 510</span> <span style="color: #228B22; background: #FFFFFF;">    %% End loop over nodes in the tree</span><br/>               <span style="color: #A0A0A0"> 511</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------</span><br/>               <span style="color: #A0A0A0"> 512</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 513</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 514</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 515</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 516</span> <span style="color: #228B22; background: #FFFFFF;">%% Print final stats</span><br/>               <span style="color: #A0A0A0"> 517</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 518</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 519</span> <span style="color: #000000; background: #FFFFFF;">fprintf('\n'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 520</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 1: optimal value = %.8e\n', gUB+cons); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 521</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 2: (created,solved,pruned,infeas,left) = (%d,%d,%d,%d,%d)\n', ... </span><br/>               <span style="color: #A0A0A0"> 522</span> <span style="color: #000000; background: #FFFFFF;">    nodes_created, nodes_solved, nodes_pruned, nodes_infeasible, length(LBLB));</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 523</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 3: solved = fully + fathomed + poorly : %d = %d + %d + %d\n', ... </span><br/>               <span style="color: #A0A0A0"> 524</span> <span style="color: #000000; background: #FFFFFF;">    nodes_solved, nodes_solved_fully, nodes_solved_fathomed, nodes_solved_poorly);</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 525</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 4: time = %d\n', toc); </span><br/>               <span style="color: #A0A0A0"> 526</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 527</span> <span style="color: #000000; background: #FFFFFF;">fval = gUB+cons; </span><br/>               <span style="color: #A0A0A0"> 528</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 529</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 530</span> <span style="color: #228B22; background: #FFFFFF;">%% Extract the solution to the original problem</span><br/>               <span style="color: #A0A0A0"> 531</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 532</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 533</span> <span style="color: #000000; background: #FFFFFF;">x = <a href="file52.html">getsol</a>(xx,sstruct); </span><br/>               <span style="color: #A0A0A0"> 534</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 535</span> <span style="color: #000000; background: #FFFFFF;">time = toc; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 536</span> <span style="color: #000000; background: #FFFFFF;">stat.tBB = time - stat.tPre; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 537</span> <span style="color: #000000; background: #FFFFFF;">stat.nodes = nodes_solved; </span><br/>               <span style="color: #A0A0A0"> 538</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 539</span> <span style="color: #000000; background: #FFFFFF;">return </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>