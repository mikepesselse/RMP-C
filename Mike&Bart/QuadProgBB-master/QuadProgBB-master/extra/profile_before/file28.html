<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for quadprogbb>boundall</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">quadprogbb>boundall (1 call, 0.896 sec)</span><br/><i>Generated 06-Oct-2011 17:14:13 using cpu time.</i><br/>M-subfunction in file /nfs/dollar/local/vol00/user0/jieqchen/new/quadprogbb/quadprogbb/mpc/code/quadprogbb.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file6.html">quadprogbb>standardform</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line1066">1066</a></td><td class="td-linebottomrt"><pre>[xL,xU,tlp] = cplex_bnd_solve(...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.529 s</td><td class="td-linebottomrt" class="td-linebottomrt">59.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=59 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1074">1074</a></td><td class="td-linebottomrt"><pre>[xL,xU,tlp] = cplex_bnd_solve(...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.346 s</td><td class="td-linebottomrt" class="td-linebottomrt">38.6%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=39 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line930">930</a></td><td class="td-linebottomrt"><pre>HH = [HH; H1(j:end,j)];</pre></td><td class="td-linebottomrt">5</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1094">1094</a></td><td class="td-linebottomrt"><pre>return</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1092">1092</a></td><td class="td-linebottomrt"><pre>U = [U(1:n); U(len+1:end)];</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">1.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.896 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file25.html">quadprogbb>cplex_bnd_solve</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.875 s</td><td class="td-linebottomrt">97.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=98 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.020 s</td><td class="td-linebottomrt">2.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.896 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line888">888</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'LB' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line888">888</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'UB' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line930">930</a></td><td class="td-linebottomrt"><span class="mono">The variable 'HH' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line998">998</a></td><td class="td-linebottomrt"><span class="mono">The variable 'block' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1018">1018</a></td><td class="td-linebottomrt"><span class="mono">The variable 'block' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1061">1061</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'total' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">207</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">99</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">108</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">97</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">11</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">89.81 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/><a name="Line888"></a>               <span style="color: #A0A0A0"> 888</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [L,U,tmp1,tmp2,tmp3,tmp4,timeLP] = boundall(H,f,A,b,Aeq,beq,LB,UB,idxL,idxB)</span><br/>               <span style="color: #A0A0A0"> 889</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 890</span> <span style="color: #228B22; background: #FFFFFF;">%% BOUNDALL calculates the bounds for all the variables</span><br/>               <span style="color: #A0A0A0"> 891</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 892</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 893</span> <span style="color: #228B22; background: #FFFFFF;">%% Calculate bounds for all vars: ( x, s, lambda, y, wB, zB, zL, rB )</span><br/>               <span style="color: #A0A0A0"> 894</span> <span style="color: #228B22; background: #FFFFFF;">%% Solve the LP with variable X introduced to bound the dual vars</span><br/>               <span style="color: #A0A0A0"> 895</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 896</span> <span style="color: #228B22; background: #FFFFFF;">%%      H(:)'*X(:) + f'*x + b'*lambda + beq'* y + rB= 0</span><br/>               <span style="color: #A0A0A0"> 897</span> <span style="color: #228B22; background: #FFFFFF;">%%      X_{i,j} &lt;= x_j, X_{i,j} &lt;= x_i</span><br/>               <span style="color: #A0A0A0"> 898</span> <span style="color: #228B22; background: #FFFFFF;">%%      X_{i,j} &gt;= x_i + x_j - 1</span><br/>               <span style="color: #A0A0A0"> 899</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 900</span> <span style="color: #228B22; background: #FFFFFF;">%% Suppose [m,n] = size(A). Dimension of variables: </span><br/>               <span style="color: #A0A0A0"> 901</span> <span style="color: #228B22; background: #FFFFFF;">%%  - x: n</span><br/>               <span style="color: #A0A0A0"> 902</span> <span style="color: #228B22; background: #FFFFFF;">%%  - lambda, s: m</span><br/>               <span style="color: #A0A0A0"> 903</span> <span style="color: #228B22; background: #FFFFFF;">%%  - y: meq</span><br/>               <span style="color: #A0A0A0"> 904</span> <span style="color: #228B22; background: #FFFFFF;">%%  - rB,zB,wB: lenB</span><br/>               <span style="color: #A0A0A0"> 905</span> <span style="color: #228B22; background: #FFFFFF;">%%  - zL: lenL</span><br/>               <span style="color: #A0A0A0"> 906</span> <span style="color: #228B22; background: #FFFFFF;">%%  - X: .5*n*(n+1)</span><br/>               <span style="color: #A0A0A0"> 907</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 908</span> <span style="color: #228B22; background: #FFFFFF;">%% Order of vars: ( x, X, s, wB, lambda, y, zL, zB, rB )</span><br/>               <span style="color: #A0A0A0"> 909</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 910</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 911</span> <span style="color: #000000; background: #FFFFFF;">timeLP = 0; </span><br/>               <span style="color: #A0A0A0"> 912</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 913</span> <span style="color: #000000; background: #FFFFFF;">Aeq0 = Aeq;  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 914</span> <span style="color: #000000; background: #FFFFFF;">beq0 = beq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 915</span> <span style="color: #000000; background: #FFFFFF;">n = size(H,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 916</span> <span style="color: #000000; background: #FFFFFF;">m = size(A,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 917</span> <span style="color: #000000; background: #FFFFFF;">meq = size(Aeq,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 918</span> <span style="color: #000000; background: #FFFFFF;">lenL = length(idxL); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 919</span> <span style="color: #000000; background: #FFFFFF;">lenB = length(idxB); </span><br/>               <span style="color: #A0A0A0"> 920</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 921</span> <span style="color: #000000; background: #FFFFFF;">nn = n+.5*n*(n+1)+2*m+meq+lenL+3*lenB; </span><br/>               <span style="color: #A0A0A0"> 922</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 923</span> <span style="color: #228B22; background: #FFFFFF;">%% BEGIN: prepare the data required by CPLEXINT</span><br/>               <span style="color: #A0A0A0"> 924</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 925</span> <span style="color: #000000; background: #FFFFFF;">dH = diag(H); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 926</span> <span style="color: #000000; background: #FFFFFF;">H1 = 2*tril(H,-1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 927</span> <span style="color: #000000; background: #FFFFFF;">H1 = H1 + diag(dH); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 928</span> <span style="color: #000000; background: #FFFFFF;">HH = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 929</span> <span style="color: #000000; background: #FFFFFF;">for j = 1:n </span><br/><a name="Line930"></a><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 930</span> <a name="Line930"></a><span style="color: #000000; background: #FFFFFF;">    HH = [HH; H1(j:end,j)]; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 931</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 932</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 933</span> <span style="color: #228B22; background: #FFFFFF;">%% Order of vars: ( x, X, s, wB, lambda, y, zL, zB, rB )</span><br/>               <span style="color: #A0A0A0"> 934</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 935</span> <span style="color: #000000; background: #FFFFFF;">tmp1 = zeros(n,lenL); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 936</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:lenL </span><br/>               <span style="color: #A0A0A0"> 937</span> <span style="color: #A0A0A0; background: #FFFFFF;">  k = idxL(i);</span><br/>               <span style="color: #A0A0A0"> 938</span> <span style="color: #A0A0A0; background: #FFFFFF;">  tmp1(k,i) = -1;</span><br/>               <span style="color: #A0A0A0"> 939</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 940</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = zeros(n,lenB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 941</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 942</span> <span style="color: #000000; background: #FFFFFF;">  k = idxB(i); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 943</span> <span style="color: #000000; background: #FFFFFF;">  tmp2(k,i) = -1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 944</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 945</span> <span style="color: #000000; background: #FFFFFF;">tmp3 = -tmp2; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 946</span> <span style="color: #000000; background: #FFFFFF;">tmp4 = zeros(lenB,n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 947</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 948</span> <span style="color: #000000; background: #FFFFFF;">  k = idxB(i); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 949</span> <span style="color: #000000; background: #FFFFFF;">  tmp4(i,k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 950</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 951</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 952</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 953</span> <span style="color: #228B22; background: #FFFFFF;">%% The KKT system now is:</span><br/>               <span style="color: #A0A0A0"> 954</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 955</span> <span style="color: #228B22; background: #FFFFFF;">%%  (1)    Aeq * x = beq</span><br/>               <span style="color: #A0A0A0"> 956</span> <span style="color: #228B22; background: #FFFFFF;">%%  (2)    A * x + s = b</span><br/>               <span style="color: #A0A0A0"> 957</span> <span style="color: #228B22; background: #FFFFFF;">%%  (3)    H * x + f + A'*lambda + Aeq' * y - zL - zB + rB = 0</span><br/>               <span style="color: #A0A0A0"> 958</span> <span style="color: #228B22; background: #FFFFFF;">%%  (4)    H \dot X + f' * x + b'*lambda + beq'*y + e' * rB = 0</span><br/>               <span style="color: #A0A0A0"> 959</span> <span style="color: #228B22; background: #FFFFFF;">%%  (5)    xB + wB = 1</span><br/>               <span style="color: #A0A0A0"> 960</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 961</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 962</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq) </span><br/>               <span style="color: #A0A0A0"> 963</span> <span style="color: #A0A0A0; background: #FFFFFF;">  Aeq = [ Aeq zeros(meq,nn-n)];  % (1) </span><br/>               <span style="color: #A0A0A0"> 964</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 965</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 966</span> <span style="color: #000000; background: #FFFFFF;">Aeq = [ Aeq ;  </span><br/>               <span style="color: #A0A0A0"> 967</span> <span style="color: #000000; background: #FFFFFF;">        A    zeros(m,.5*n*(n+1)) eye(m) zeros(m,nn-n-m-.5*n*(n+1)) ;              % (2) </span><br/>               <span style="color: #A0A0A0"> 968</span> <span style="color: #000000; background: #FFFFFF;">        H    zeros(n,.5*n*(n+1)+m+lenB) A' Aeq0' tmp1 tmp2 tmp3 ;                 % (3)</span><br/>               <span style="color: #A0A0A0"> 969</span> <span style="color: #000000; background: #FFFFFF;">        f'  HH'  zeros(1,m+lenB) b' beq0' zeros(1,lenL+lenB) ones(1,lenB) ;       % (4)</span><br/>               <span style="color: #A0A0A0"> 970</span> <span style="color: #000000; background: #FFFFFF;">        tmp4 zeros(lenB,.5*n*(n+1)+m) eye(lenB) zeros(lenB,m+meq+lenL+2*lenB)  ]; % (5)</span><br/>               <span style="color: #A0A0A0"> 971</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 972</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 973</span> <span style="color: #000000; background: #FFFFFF;">beq = [beq; b; -f; 0; ones(lenB,1)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 974</span> <span style="color: #000000; background: #FFFFFF;">INDEQ = (1:length(beq))'; </span><br/>               <span style="color: #A0A0A0"> 975</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 976</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 977</span> <span style="color: #228B22; background: #FFFFFF;">%% Start to prepare the part of data modeling implied bounds on X,</span><br/>               <span style="color: #A0A0A0"> 978</span> <span style="color: #228B22; background: #FFFFFF;">%% including three parts.</span><br/>               <span style="color: #A0A0A0"> 979</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 980</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 981</span> <span style="color: #228B22; background: #FFFFFF;">%% Part I &amp; II: X_{i,j} &lt;= x_j, X_{i,j} &lt;= x_i</span><br/>               <span style="color: #A0A0A0"> 982</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 983</span> <span style="color: #000000; background: #FFFFFF;">len = n + .5*n*(n+1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 984</span> <span style="color: #000000; background: #FFFFFF;">qq = ones(n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 985</span> <span style="color: #000000; background: #FFFFFF;">qq = tril(qq); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 986</span> <span style="color: #000000; background: #FFFFFF;">[I,J] = find(qq); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 987</span> <span style="color: #000000; background: #FFFFFF;">lenI = length(I); </span><br/>               <span style="color: #A0A0A0"> 988</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 989</span> <span style="color: #000000; background: #FFFFFF;">block = zeros(1000,3); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 990</span> <span style="color: #000000; background: #FFFFFF;">range = 1000; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 991</span> <span style="color: #000000; background: #FFFFFF;">k = 1; rowid = 1; </span><br/>               <span style="color: #A0A0A0"> 992</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 993</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenI </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold"> 994</span> <span style="color: #000000; background: #FFFFFF;">  ii = I(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold"> 995</span> <span style="color: #000000; background: #FFFFFF;">  jj = J(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold"> 996</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid ii -1];  k = k + 1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold"> 997</span> <span style="color: #000000; background: #FFFFFF;">  if (k+5) &gt; range </span><br/><a name="Line998"></a>               <span style="color: #A0A0A0"> 998</span> <span style="color: #A0A0A0; background: #FFFFFF;">    block = [block; zeros(1000,3)];</span><br/>               <span style="color: #A0A0A0"> 999</span> <span style="color: #A0A0A0; background: #FFFFFF;">    range = range + 1000;</span><br/>               <span style="color: #A0A0A0">1000</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1001</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid n+i 1];  k = k+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1002</span> <span style="color: #000000; background: #FFFFFF;">  rowid = rowid+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1003</span> <span style="color: #000000; background: #FFFFFF;">  if ii ~= jj </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1004</span> <span style="color: #000000; background: #FFFFFF;">    block(k,:) = [rowid n+i 1];    k = k+1; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1005</span> <span style="color: #000000; background: #FFFFFF;">    block(k,:) = [rowid jj -1];    k = k+1; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1006</span> <span style="color: #000000; background: #FFFFFF;">    rowid = rowid+1; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1007</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1008</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1009</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1010</span> <span style="color: #228B22; background: #FFFFFF;">%% Part III:  X_{i,j} &gt;= x_i + x_j - 1</span><br/>               <span style="color: #A0A0A0">1011</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1012</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenI </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1013</span> <span style="color: #000000; background: #FFFFFF;">  ii = I(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1014</span> <span style="color: #000000; background: #FFFFFF;">  jj = J(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1015</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid ii 1]; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1016</span> <span style="color: #000000; background: #FFFFFF;">  k = k+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1017</span> <span style="color: #000000; background: #FFFFFF;">  if (k+5) &gt; range </span><br/><a name="Line1018"></a>               <span style="color: #A0A0A0">1018</span> <span style="color: #A0A0A0; background: #FFFFFF;">    block = [block; zeros(1000,3)];</span><br/>               <span style="color: #A0A0A0">1019</span> <span style="color: #A0A0A0; background: #FFFFFF;">    range = range + 1000;</span><br/>               <span style="color: #A0A0A0">1020</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1021</span> <span style="color: #000000; background: #FFFFFF;">  if jj ~= ii </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1022</span> <span style="color: #000000; background: #FFFFFF;">    block(k,:) = [rowid jj 1]; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1023</span> <span style="color: #000000; background: #FFFFFF;">    k = k + 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1024</span> <span style="color: #228B22; background: #FFFFFF;">  else </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1025</span> <span style="color: #000000; background: #FFFFFF;">    block(k-1,3) = 2; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1026</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1027</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid n+i -1]; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1028</span> <span style="color: #000000; background: #FFFFFF;">  k = k+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1029</span> <span style="color: #000000; background: #FFFFFF;">  rowid = rowid+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1030</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1031</span> <span style="color: #000000; background: #FFFFFF;">block = block(1:k-1,:); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1032</span> <span style="color: #000000; background: #FFFFFF;">AA = sparse(block(:,1),block(:,2),block(:,3),n^2+lenI,nn); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1033</span> <span style="color: #000000; background: #FFFFFF;">bb = [zeros(n^2,1); ones(lenI,1)]; </span><br/>               <span style="color: #A0A0A0">1034</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1035</span> <span style="color: #228B22; background: #FFFFFF;">%% Order of vars: ( x, X, s, wB, lambda, y, zL, zB, rB )</span><br/>               <span style="color: #A0A0A0">1036</span> <span style="color: #228B22; background: #FFFFFF;">%% s &gt;=0, lambda &gt;=0, y free, wB&gt;=0, xL&gt;=0, 0&lt;=xB</span><br/>               <span style="color: #A0A0A0">1037</span> <span style="color: #228B22; background: #FFFFFF;">%% zL&gt;=0, zB&gt;=0,rB&gt;=0</span><br/>               <span style="color: #A0A0A0">1038</span> <span style="color: #228B22; background: #FFFFFF;">%% s .* lambda = 0, xL.*zL=0, xB.*zB=0, wB.*rB=0, zB.*rB = 0</span><br/>               <span style="color: #A0A0A0">1039</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1040</span> <span style="color: #000000; background: #FFFFFF;">LB = zeros(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1041</span> <span style="color: #000000; background: #FFFFFF;">tmp = len+2*m+lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1042</span> <span style="color: #000000; background: #FFFFFF;">LB(tmp+1:tmp+meq) = -inf; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1043</span> <span style="color: #000000; background: #FFFFFF;">UB = inf*ones(nn,1); </span><br/>               <span style="color: #A0A0A0">1044</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1045</span> <span style="color: #228B22; background: #FFFFFF;">%% In previous transformation, x is bounded above by 1, and so </span><br/>               <span style="color: #A0A0A0">1046</span> <span style="color: #228B22; background: #FFFFFF;">%% does X. although we pretend that they are not there when </span><br/>               <span style="color: #A0A0A0">1047</span> <span style="color: #228B22; background: #FFFFFF;">%% doing complementarity </span><br/>               <span style="color: #A0A0A0">1048</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1049</span> <span style="color: #000000; background: #FFFFFF;">UB(1:len) = 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1050</span> <span style="color: #000000; background: #FFFFFF;">UB(len+m+1:len+m+lenB) = 1; </span><br/>               <span style="color: #A0A0A0">1051</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1052</span> <span style="color: #228B22; background: #FFFFFF;">%% END: prepare the data required by CPLEXINT</span><br/>               <span style="color: #A0A0A0">1053</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1054</span> <span style="color: #228B22; background: #FFFFFF;">%% Recalculate bounds for x after adding KKT</span><br/>               <span style="color: #A0A0A0">1055</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1056</span> <span style="color: #000000; background: #FFFFFF;">L =  zeros(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1057</span> <span style="color: #000000; background: #FFFFFF;">U =  ones(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1058</span> <span style="color: #000000; background: #FFFFFF;">AA = [Aeq; AA]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1059</span> <span style="color: #000000; background: #FFFFFF;">bb = [beq; bb]; </span><br/>               <span style="color: #A0A0A0">1060</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line1061"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1061</span> <span style="color: #000000; background: #FFFFFF;">total = n + nn - len; </span><br/>               <span style="color: #A0A0A0">1062</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1063</span> <span style="color: #228B22; background: #FFFFFF;">% calculate bounds for x</span><br/>               <span style="color: #A0A0A0">1064</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1065</span> <span style="color: #000000; background: #FFFFFF;">index0 = 1:n; </span><br/><span style="color: #FF0000">  0.53 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1066</span> <a name="Line1066"></a><span style="color: #000000; background: #FF8080;">[xL,xU,tlp] = <a href="file25.html">cplex_bnd_solve</a>(AA, bb, INDEQ, LB, UB, index0); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1067</span> <span style="color: #000000; background: #FFFFFF;">L(index0) = xL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1068</span> <span style="color: #000000; background: #FFFFFF;">U(index0) = xU; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1069</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0">1070</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1071</span> <span style="color: #228B22; background: #FFFFFF;">% Recalcualte bounds for the rest vars except X</span><br/>               <span style="color: #A0A0A0">1072</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1073</span> <span style="color: #000000; background: #FFFFFF;">index0 = len+1:nn; </span><br/><span style="color: #FF0000">  0.35 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1074</span> <a name="Line1074"></a><span style="color: #000000; background: #FFAAAA;">[xL,xU,tlp] = <a href="file25.html">cplex_bnd_solve</a>(AA, bb, INDEQ, LB, UB, index0); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1075</span> <span style="color: #000000; background: #FFFFFF;">L(index0) = xL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1076</span> <span style="color: #000000; background: #FFFFFF;">U(index0) = xU; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1077</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0">1078</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1079</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1080</span> <span style="color: #228B22; background: #FFFFFF;">%%--------------------------------------------</span><br/>               <span style="color: #A0A0A0">1081</span> <span style="color: #228B22; background: #FFFFFF;">%% Formulate the KKT system, turn the problem</span><br/>               <span style="color: #A0A0A0">1082</span> <span style="color: #228B22; background: #FFFFFF;">%% into one with A x == b, x &gt;= 0 constraints</span><br/>               <span style="color: #A0A0A0">1083</span> <span style="color: #228B22; background: #FFFFFF;">%% and x's upper bounds is one is implied.</span><br/>               <span style="color: #A0A0A0">1084</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">1085</span> <span style="color: #228B22; background: #FFFFFF;">%% The order of the variables are:</span><br/>               <span style="color: #A0A0A0">1086</span> <span style="color: #228B22; background: #FFFFFF;">%% ( x, s, wB, lambda, y, zL, zB, rB) </span><br/>               <span style="color: #A0A0A0">1087</span> <span style="color: #228B22; background: #FFFFFF;">%%--------------------------------------------</span><br/>               <span style="color: #A0A0A0">1088</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1089</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1090</span> <span style="color: #228B22; background: #FFFFFF;">%% Formulating new A</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1091</span> <span style="color: #000000; background: #FFFFFF;">L = [L(1:n); L(len+1:end)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1092</span> <a name="Line1092"></a><span style="color: #000000; background: #FFFFFF;">U = [U(1:n); U(len+1:end)]; </span><br/>               <span style="color: #A0A0A0">1093</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1094</span> <a name="Line1094"></a><span style="color: #000000; background: #FFFFFF;">return </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>