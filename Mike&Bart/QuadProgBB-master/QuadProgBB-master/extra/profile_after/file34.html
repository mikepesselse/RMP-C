<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for quadprogbb>boundall</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">quadprogbb>boundall (1 call, 0.359 sec)</span><br/><i>Generated 06-Oct-2011 17:10:43 using cpu time.</i><br/>M-subfunction in file /nfs/dollar/local/vol00/user0/jieqchen/QuadProgBB/quadprogbb.m<br/>Copy to new window for comparing multiple runs<p><span class="warning">This function changed during profiling or before generation of this report. Results may be incomplete or inaccurate.</span></p><div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file27.html">quadprogbb>standardform</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line1361">1361</a></td><td class="td-linebottomrt"><pre>[xL,xU,tlp] = cplex_bnd_solve(...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.222 s</td><td class="td-linebottomrt" class="td-linebottomrt">61.9%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=62 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1353">1353</a></td><td class="td-linebottomrt"><pre>[xL,xU,tlp] = cplex_bnd_solve(...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.103 s</td><td class="td-linebottomrt" class="td-linebottomrt">28.6%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=29 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1318">1318</a></td><td class="td-linebottomrt"><pre>block = block(1:k-1,:);</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1381">1381</a></td><td class="td-linebottomrt"><pre>return</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1379">1379</a></td><td class="td-linebottomrt"><pre>U = [U(1:n); U(len+1:end)];</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.026 s</td><td class="td-linebottomrt">7.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.359 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file14.html">quadprogbb>cplex_bnd_solve</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.316 s</td><td class="td-linebottomrt">88.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=88 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.043 s</td><td class="td-linebottomrt">11.9%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.359 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line1103">1103</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'LB' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1103">1103</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'UB' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1145">1145</a></td><td class="td-linebottomrt"><span class="mono">The variable 'HH' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1189">1189</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'equ3' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1190">1190</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'equ4' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1285">1285</a></td><td class="td-linebottomrt"><span class="mono">The variable 'block' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1305">1305</a></td><td class="td-linebottomrt"><span class="mono">The variable 'block' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line1348">1348</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'total' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">279</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">111</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">168</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">151</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">17</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">89.88 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/><a name="Line1103"></a>               <span style="color: #A0A0A0">1103</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [L,U,tmp1,tmp2,tmp3,tmp4,timeLP] = boundall(H,f,A,b,Aeq,beq,LB,UB,idxL,idxB)</span><br/>               <span style="color: #A0A0A0">1104</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1105</span> <span style="color: #228B22; background: #FFFFFF;">%% BOUNDALL calculates the bounds for all the variables</span><br/>               <span style="color: #A0A0A0">1106</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1107</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0">1108</span> <span style="color: #228B22; background: #FFFFFF;">%% Calculate bounds for all vars: ( x, s, lambda, y, wB, zB, zL, rB )</span><br/>               <span style="color: #A0A0A0">1109</span> <span style="color: #228B22; background: #FFFFFF;">%% Solve the LP with variable X introduced to bound the dual vars</span><br/>               <span style="color: #A0A0A0">1110</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">1111</span> <span style="color: #228B22; background: #FFFFFF;">%%      H(:)'*X(:) + f'*x + b'*lambda + beq'* y + rB= 0</span><br/>               <span style="color: #A0A0A0">1112</span> <span style="color: #228B22; background: #FFFFFF;">%%      X_{i,j} &lt;= x_j, X_{i,j} &lt;= x_i</span><br/>               <span style="color: #A0A0A0">1113</span> <span style="color: #228B22; background: #FFFFFF;">%%      X_{i,j} &gt;= x_i + x_j - 1</span><br/>               <span style="color: #A0A0A0">1114</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">1115</span> <span style="color: #228B22; background: #FFFFFF;">%% Suppose [m,n] = size(A). Dimension of variables: </span><br/>               <span style="color: #A0A0A0">1116</span> <span style="color: #228B22; background: #FFFFFF;">%%  - x: n</span><br/>               <span style="color: #A0A0A0">1117</span> <span style="color: #228B22; background: #FFFFFF;">%%  - lambda, s: m</span><br/>               <span style="color: #A0A0A0">1118</span> <span style="color: #228B22; background: #FFFFFF;">%%  - y: meq</span><br/>               <span style="color: #A0A0A0">1119</span> <span style="color: #228B22; background: #FFFFFF;">%%  - rB,zB,wB: lenB</span><br/>               <span style="color: #A0A0A0">1120</span> <span style="color: #228B22; background: #FFFFFF;">%%  - zL: lenL</span><br/>               <span style="color: #A0A0A0">1121</span> <span style="color: #228B22; background: #FFFFFF;">%%  - X: .5*n*(n+1)</span><br/>               <span style="color: #A0A0A0">1122</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">1123</span> <span style="color: #228B22; background: #FFFFFF;">%% Order of vars: ( x, X, s, wB, lambda, y, zL, zB, rB )</span><br/>               <span style="color: #A0A0A0">1124</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0">1125</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1126</span> <span style="color: #000000; background: #FFFFFF;">timeLP = 0; </span><br/>               <span style="color: #A0A0A0">1127</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1128</span> <span style="color: #000000; background: #FFFFFF;">Aeq0 = Aeq;  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1129</span> <span style="color: #000000; background: #FFFFFF;">beq0 = beq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1130</span> <span style="color: #000000; background: #FFFFFF;">n = size(H,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1131</span> <span style="color: #000000; background: #FFFFFF;">m = size(A,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1132</span> <span style="color: #000000; background: #FFFFFF;">meq = size(Aeq,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1133</span> <span style="color: #000000; background: #FFFFFF;">lenL = length(idxL); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1134</span> <span style="color: #000000; background: #FFFFFF;">lenB = length(idxB); </span><br/>               <span style="color: #A0A0A0">1135</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1136</span> <span style="color: #000000; background: #FFFFFF;">nn = n+.5*n*(n+1)+2*m+meq+lenL+3*lenB; </span><br/>               <span style="color: #A0A0A0">1137</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1138</span> <span style="color: #228B22; background: #FFFFFF;">%% BEGIN: prepare the data required by CPLEXINT</span><br/>               <span style="color: #A0A0A0">1139</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1140</span> <span style="color: #000000; background: #FFFFFF;">dH = diag(H); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1141</span> <span style="color: #000000; background: #FFFFFF;">H1 = 2*tril(H,-1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1142</span> <span style="color: #000000; background: #FFFFFF;">H1 = H1 + diag(dH); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1143</span> <span style="color: #000000; background: #FFFFFF;">HH = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1144</span> <span style="color: #000000; background: #FFFFFF;">for j = 1:n </span><br/><a name="Line1145"></a>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1145</span> <span style="color: #000000; background: #FFFFFF;">    HH = [HH; H1(j:end,j)]; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1146</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1147</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1148</span> <span style="color: #228B22; background: #FFFFFF;">%% Order of vars: ( x, X, s, wB, lambda, y, zL, zB, rB )</span><br/>               <span style="color: #A0A0A0">1149</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1150</span> <span style="color: #000000; background: #FFFFFF;">tmp1 = zeros(n,lenL); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1151</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:lenL </span><br/>               <span style="color: #A0A0A0">1152</span> <span style="color: #A0A0A0; background: #FFFFFF;">  k = idxL(i);</span><br/>               <span style="color: #A0A0A0">1153</span> <span style="color: #A0A0A0; background: #FFFFFF;">  tmp1(k,i) = -1;</span><br/>               <span style="color: #A0A0A0">1154</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1155</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = zeros(n,lenB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1156</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1157</span> <span style="color: #000000; background: #FFFFFF;">  k = idxB(i); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1158</span> <span style="color: #000000; background: #FFFFFF;">  tmp2(k,i) = -1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1159</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1160</span> <span style="color: #000000; background: #FFFFFF;">tmp3 = -tmp2; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1161</span> <span style="color: #000000; background: #FFFFFF;">tmp4 = zeros(lenB,n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1162</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1163</span> <span style="color: #000000; background: #FFFFFF;">  k = idxB(i); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1164</span> <span style="color: #000000; background: #FFFFFF;">  tmp4(i,k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1165</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1166</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1167</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0">1168</span> <span style="color: #228B22; background: #FFFFFF;">%% The KKT system now is:</span><br/>               <span style="color: #A0A0A0">1169</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">1170</span> <span style="color: #228B22; background: #FFFFFF;">%%  (1)    Aeq * x = beq</span><br/>               <span style="color: #A0A0A0">1171</span> <span style="color: #228B22; background: #FFFFFF;">%%  (2)    A * x + s = b</span><br/>               <span style="color: #A0A0A0">1172</span> <span style="color: #228B22; background: #FFFFFF;">%%  (3)    H * x + f + A'*lambda + Aeq' * y - zL - zB + rB = 0</span><br/>               <span style="color: #A0A0A0">1173</span> <span style="color: #228B22; background: #FFFFFF;">%%  (4)    H \dot X + f' * x + b'*lambda + beq'*y + e' * rB = 0</span><br/>               <span style="color: #A0A0A0">1174</span> <span style="color: #228B22; background: #FFFFFF;">%%  (5)    xB + wB = 1</span><br/>               <span style="color: #A0A0A0">1175</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0">1176</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1177</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq) </span><br/>               <span style="color: #A0A0A0">1178</span> <span style="color: #A0A0A0; background: #FFFFFF;">  Aeq = [ Aeq zeros(meq,nn-n)];  % (1) </span><br/>               <span style="color: #A0A0A0">1179</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">1180</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1181</span> <span style="color: #228B22; background: #FFFFFF;">%% old ---- might cause empty concatination and warning message </span><br/>               <span style="color: #A0A0A0">1182</span> <span style="color: #228B22; background: #FFFFFF;">% Aeq = [ Aeq ; </span><br/>               <span style="color: #A0A0A0">1183</span> <span style="color: #228B22; background: #FFFFFF;">%        A    zeros(m,.5*n*(n+1)) eye(m) zeros(m,nn-n-m-.5*n*(n+1)) ;              % (2) </span><br/>               <span style="color: #A0A0A0">1184</span> <span style="color: #228B22; background: #FFFFFF;">%        H    zeros(n,.5*n*(n+1)+m+lenB) A' Aeq0' tmp1 tmp2 tmp3 ;                 % (3)</span><br/>               <span style="color: #A0A0A0">1185</span> <span style="color: #228B22; background: #FFFFFF;">%        f'  HH'  zeros(1,m+lenB) b' beq0' zeros(1,lenL+lenB) ones(1,lenB) ;       % (4)</span><br/>               <span style="color: #A0A0A0">1186</span> <span style="color: #228B22; background: #FFFFFF;">%        tmp4 zeros(lenB,.5*n*(n+1)+m) eye(lenB) zeros(lenB,m+meq+lenL+2*lenB)  ]; % (5)</span><br/>               <span style="color: #A0A0A0">1187</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1188</span> <span style="color: #000000; background: #FFFFFF;">equ2 = []; </span><br/><a name="Line1189"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1189</span> <span style="color: #000000; background: #FFFFFF;">equ3 = []; </span><br/><a name="Line1190"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1190</span> <span style="color: #000000; background: #FFFFFF;">equ4 = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1191</span> <span style="color: #000000; background: #FFFFFF;">equ5 = []; </span><br/>               <span style="color: #A0A0A0">1192</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1193</span> <span style="color: #228B22; background: #FFFFFF;">% row2 of new Aeq: [ A   zeros(m,.5*n*(n+1)) eye(m) zeros(m,nn-n-m-.5*n*(n+1)) ]</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1194</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1195</span> <span style="color: #000000; background: #FFFFFF;">  equ2 = [ A    zeros(m,.5*n*(n+1)) eye(m) zeros(m,nn-n-m-.5*n*(n+1)) ] ; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1196</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1197</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1198</span> <span style="color: #228B22; background: #FFFFFF;">% row 3 of new Aeq : [ H    zeros(n,.5*n*(n+1)+m+lenB) A' Aeq0' tmp1 tmp2 tmp3 ]</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1199</span> <span style="color: #000000; background: #FFFFFF;">equ3 = [H    zeros(n,.5*n*(n+1)+m+lenB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1200</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1201</span> <span style="color: #000000; background: #FFFFFF;">  equ3 = [ equ3  A' ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1202</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1203</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq0) </span><br/>               <span style="color: #A0A0A0">1204</span> <span style="color: #A0A0A0; background: #FFFFFF;">  equ3 = [ equ3 Aeq0' ];</span><br/>               <span style="color: #A0A0A0">1205</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1206</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp1) </span><br/>               <span style="color: #A0A0A0">1207</span> <span style="color: #A0A0A0; background: #FFFFFF;">  equ3 = [ equ3 tmp1 ];</span><br/>               <span style="color: #A0A0A0">1208</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1209</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1210</span> <span style="color: #000000; background: #FFFFFF;">  equ3 = [ equ3 tmp2 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1211</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1212</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp3) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1213</span> <span style="color: #000000; background: #FFFFFF;">  equ3 = [ equ3 tmp3 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1214</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1215</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1216</span> <span style="color: #228B22; background: #FFFFFF;">% row 4 of new Aeq: [f'  HH'  zeros(1,m+lenB) b' beq0' zeros(1,lenL+lenB) ones(1,lenB) ]</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1217</span> <span style="color: #000000; background: #FFFFFF;">equ4 = [ f' HH' ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1218</span> <span style="color: #000000; background: #FFFFFF;">if m + lenB &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1219</span> <span style="color: #000000; background: #FFFFFF;">  equ4 = [ equ4 zeros(1,m+lenB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1220</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1221</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(b) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1222</span> <span style="color: #000000; background: #FFFFFF;">  equ4 = [ equ4 b' ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1223</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1224</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(beq0) </span><br/>               <span style="color: #A0A0A0">1225</span> <span style="color: #A0A0A0; background: #FFFFFF;">  equ4 = [ equ4 beq0' ];</span><br/>               <span style="color: #A0A0A0">1226</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1227</span> <span style="color: #000000; background: #FFFFFF;">if lenL + lenB &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1228</span> <span style="color: #000000; background: #FFFFFF;">  equ4  = [equ4 zeros(1,lenL + lenB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1229</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1230</span> <span style="color: #000000; background: #FFFFFF;">if lenB &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1231</span> <span style="color: #000000; background: #FFFFFF;">  equ4 = [ equ4 ones(1,lenB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1232</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1233</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1234</span> <span style="color: #228B22; background: #FFFFFF;">% row 5 of new Aeq: [ tmp4 zeros(lenB,.5*n*(n+1)+m) eye(lenB) zeros(lenB,m+meq+lenL+2*lenB) ]</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1235</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp4) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1236</span> <span style="color: #000000; background: #FFFFFF;">  equ5 = tmp4; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1237</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1238</span> <span style="color: #000000; background: #FFFFFF;">if lenB &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1239</span> <span style="color: #000000; background: #FFFFFF;">  equ5 = [ equ5 zeros(lenB,.5*n*(n+1)+m) eye(lenB) zeros(lenB,m+meq+lenL+2*lenB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1240</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1241</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1242</span> <span style="color: #000000; background: #FFFFFF;">if isempty(Aeq) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1243</span> <span style="color: #000000; background: #FFFFFF;">  tmpp = [ size(equ2,2) size(equ3,2) size(equ4,2) size(equ5,2) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1244</span> <span style="color: #000000; background: #FFFFFF;">  Aeq = zeros(0,max(tmpp)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1245</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1246</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(equ2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1247</span> <span style="color: #000000; background: #FFFFFF;">  Aeq = [ Aeq; equ2 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1248</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1249</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(equ3) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1250</span> <span style="color: #000000; background: #FFFFFF;">  Aeq = [ Aeq; equ3 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1251</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1252</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(equ4) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1253</span> <span style="color: #000000; background: #FFFFFF;">  Aeq = [ Aeq; equ4 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1254</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1255</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(equ5) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1256</span> <span style="color: #000000; background: #FFFFFF;">  Aeq = [ Aeq; equ5]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1257</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1258</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1259</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1260</span> <span style="color: #000000; background: #FFFFFF;">beq = [beq; b; -f; 0; ones(lenB,1)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1261</span> <span style="color: #000000; background: #FFFFFF;">INDEQ = (1:length(beq))'; </span><br/>               <span style="color: #A0A0A0">1262</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1263</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0">1264</span> <span style="color: #228B22; background: #FFFFFF;">%% Start to prepare the part of data modeling implied bounds on X,</span><br/>               <span style="color: #A0A0A0">1265</span> <span style="color: #228B22; background: #FFFFFF;">%% including three parts.</span><br/>               <span style="color: #A0A0A0">1266</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0">1267</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1268</span> <span style="color: #228B22; background: #FFFFFF;">%% Part I &amp; II: X_{i,j} &lt;= x_j, X_{i,j} &lt;= x_i</span><br/>               <span style="color: #A0A0A0">1269</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1270</span> <span style="color: #000000; background: #FFFFFF;">len = n + .5*n*(n+1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1271</span> <span style="color: #000000; background: #FFFFFF;">qq = ones(n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1272</span> <span style="color: #000000; background: #FFFFFF;">qq = tril(qq); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1273</span> <span style="color: #000000; background: #FFFFFF;">[I,J] = find(qq); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1274</span> <span style="color: #000000; background: #FFFFFF;">lenI = length(I); </span><br/>               <span style="color: #A0A0A0">1275</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1276</span> <span style="color: #000000; background: #FFFFFF;">block = zeros(1000,3); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1277</span> <span style="color: #000000; background: #FFFFFF;">range = 1000; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1278</span> <span style="color: #000000; background: #FFFFFF;">k = 1; rowid = 1; </span><br/>               <span style="color: #A0A0A0">1279</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1280</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenI </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1281</span> <span style="color: #000000; background: #FFFFFF;">  ii = I(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1282</span> <span style="color: #000000; background: #FFFFFF;">  jj = J(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1283</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid ii -1];  k = k + 1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1284</span> <span style="color: #000000; background: #FFFFFF;">  if (k+5) &gt; range </span><br/><a name="Line1285"></a>               <span style="color: #A0A0A0">1285</span> <span style="color: #A0A0A0; background: #FFFFFF;">    block = [block; zeros(1000,3)];</span><br/>               <span style="color: #A0A0A0">1286</span> <span style="color: #A0A0A0; background: #FFFFFF;">    range = range + 1000;</span><br/>               <span style="color: #A0A0A0">1287</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1288</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid n+i 1];  k = k+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1289</span> <span style="color: #000000; background: #FFFFFF;">  rowid = rowid+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1290</span> <span style="color: #000000; background: #FFFFFF;">  if ii ~= jj </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1291</span> <span style="color: #000000; background: #FFFFFF;">    block(k,:) = [rowid n+i 1];    k = k+1; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1292</span> <span style="color: #000000; background: #FFFFFF;">    block(k,:) = [rowid jj -1];    k = k+1; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1293</span> <span style="color: #000000; background: #FFFFFF;">    rowid = rowid+1; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1294</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1295</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1296</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1297</span> <span style="color: #228B22; background: #FFFFFF;">%% Part III:  X_{i,j} &gt;= x_i + x_j - 1</span><br/>               <span style="color: #A0A0A0">1298</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1299</span> <span style="color: #000000; background: #FFFFFF;">for i=1:lenI </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1300</span> <span style="color: #000000; background: #FFFFFF;">  ii = I(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1301</span> <span style="color: #000000; background: #FFFFFF;">  jj = J(i); </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1302</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid ii 1]; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1303</span> <span style="color: #000000; background: #FFFFFF;">  k = k+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1304</span> <span style="color: #000000; background: #FFFFFF;">  if (k+5) &gt; range </span><br/><a name="Line1305"></a>               <span style="color: #A0A0A0">1305</span> <span style="color: #A0A0A0; background: #FFFFFF;">    block = [block; zeros(1000,3)];</span><br/>               <span style="color: #A0A0A0">1306</span> <span style="color: #A0A0A0; background: #FFFFFF;">    range = range + 1000;</span><br/>               <span style="color: #A0A0A0">1307</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1308</span> <span style="color: #000000; background: #FFFFFF;">  if jj ~= ii </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1309</span> <span style="color: #000000; background: #FFFFFF;">    block(k,:) = [rowid jj 1]; </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold">1310</span> <span style="color: #000000; background: #FFFFFF;">    k = k + 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1311</span> <span style="color: #228B22; background: #FFFFFF;">  else </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1312</span> <span style="color: #000000; background: #FFFFFF;">    block(k-1,3) = 2; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1313</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1314</span> <span style="color: #000000; background: #FFFFFF;">  block(k,:) = [rowid n+i -1]; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1315</span> <span style="color: #000000; background: #FFFFFF;">  k = k+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1316</span> <span style="color: #000000; background: #FFFFFF;">  rowid = rowid+1; </span><br/>       <span style="color: #0000FF">     15 </span><span style="color: #000000; font-weight: bold">1317</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1318</span> <a name="Line1318"></a><span style="color: #000000; background: #FFFFFF;">block = block(1:k-1,:); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1319</span> <span style="color: #000000; background: #FFFFFF;">AA = sparse(block(:,1),block(:,2),block(:,3),n^2+lenI,nn); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1320</span> <span style="color: #000000; background: #FFFFFF;">bb = [zeros(n^2,1); ones(lenI,1)]; </span><br/>               <span style="color: #A0A0A0">1321</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1322</span> <span style="color: #228B22; background: #FFFFFF;">%% Order of vars: ( x, X, s, wB, lambda, y, zL, zB, rB )</span><br/>               <span style="color: #A0A0A0">1323</span> <span style="color: #228B22; background: #FFFFFF;">%% s &gt;=0, lambda &gt;=0, y free, wB&gt;=0, xL&gt;=0, 0&lt;=xB</span><br/>               <span style="color: #A0A0A0">1324</span> <span style="color: #228B22; background: #FFFFFF;">%% zL&gt;=0, zB&gt;=0,rB&gt;=0</span><br/>               <span style="color: #A0A0A0">1325</span> <span style="color: #228B22; background: #FFFFFF;">%% s .* lambda = 0, xL.*zL=0, xB.*zB=0, wB.*rB=0, zB.*rB = 0</span><br/>               <span style="color: #A0A0A0">1326</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1327</span> <span style="color: #000000; background: #FFFFFF;">LB = zeros(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1328</span> <span style="color: #000000; background: #FFFFFF;">tmp = len+2*m+lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1329</span> <span style="color: #000000; background: #FFFFFF;">LB(tmp+1:tmp+meq) = -inf; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1330</span> <span style="color: #000000; background: #FFFFFF;">UB = inf*ones(nn,1); </span><br/>               <span style="color: #A0A0A0">1331</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1332</span> <span style="color: #228B22; background: #FFFFFF;">%% In previous transformation, x is bounded above by 1, and so </span><br/>               <span style="color: #A0A0A0">1333</span> <span style="color: #228B22; background: #FFFFFF;">%% does X. although we pretend that they are not there when </span><br/>               <span style="color: #A0A0A0">1334</span> <span style="color: #228B22; background: #FFFFFF;">%% doing complementarity </span><br/>               <span style="color: #A0A0A0">1335</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1336</span> <span style="color: #000000; background: #FFFFFF;">UB(1:len) = 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1337</span> <span style="color: #000000; background: #FFFFFF;">UB(len+m+1:len+m+lenB) = 1; </span><br/>               <span style="color: #A0A0A0">1338</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1339</span> <span style="color: #228B22; background: #FFFFFF;">%% END: prepare the data required by CPLEXINT</span><br/>               <span style="color: #A0A0A0">1340</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1341</span> <span style="color: #228B22; background: #FFFFFF;">%% Recalculate bounds for x after adding KKT</span><br/>               <span style="color: #A0A0A0">1342</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1343</span> <span style="color: #000000; background: #FFFFFF;">L =  zeros(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1344</span> <span style="color: #000000; background: #FFFFFF;">U =  ones(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1345</span> <span style="color: #000000; background: #FFFFFF;">AA = [Aeq; AA]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1346</span> <span style="color: #000000; background: #FFFFFF;">bb = [beq; bb]; </span><br/>               <span style="color: #A0A0A0">1347</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line1348"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1348</span> <span style="color: #000000; background: #FFFFFF;">total = n + nn - len; </span><br/>               <span style="color: #A0A0A0">1349</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1350</span> <span style="color: #228B22; background: #FFFFFF;">% calculate bounds for x</span><br/>               <span style="color: #A0A0A0">1351</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1352</span> <span style="color: #000000; background: #FFFFFF;">index0 = 1:n; </span><br/><span style="color: #FF0000">  0.10 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1353</span> <a name="Line1353"></a><span style="color: #000000; background: #FFC6C6;">[xL,xU,tlp] = <a href="file14.html">cplex_bnd_solve</a>(AA, bb, INDEQ, LB, UB, index0); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1354</span> <span style="color: #000000; background: #FFFFFF;">L(index0) = xL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1355</span> <span style="color: #000000; background: #FFFFFF;">U(index0) = xU; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1356</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0">1357</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1358</span> <span style="color: #228B22; background: #FFFFFF;">% Recalcualte bounds for the rest vars except X</span><br/>               <span style="color: #A0A0A0">1359</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1360</span> <span style="color: #000000; background: #FFFFFF;">index0 = len+1:nn; </span><br/><span style="color: #FF0000">  0.22 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1361</span> <a name="Line1361"></a><span style="color: #000000; background: #FF8080;">[xL,xU,tlp] = <a href="file14.html">cplex_bnd_solve</a>(AA, bb, INDEQ, LB, UB, index0); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1362</span> <span style="color: #000000; background: #FFFFFF;">L(index0) = xL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1363</span> <span style="color: #000000; background: #FFFFFF;">U(index0) = xU; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1364</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0">1365</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1366</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1367</span> <span style="color: #228B22; background: #FFFFFF;">%%--------------------------------------------</span><br/>               <span style="color: #A0A0A0">1368</span> <span style="color: #228B22; background: #FFFFFF;">%% Formulate the KKT system, turn the problem</span><br/>               <span style="color: #A0A0A0">1369</span> <span style="color: #228B22; background: #FFFFFF;">%% into one with A x == b, x &gt;= 0 constraints</span><br/>               <span style="color: #A0A0A0">1370</span> <span style="color: #228B22; background: #FFFFFF;">%% and x's upper bounds is one is implied.</span><br/>               <span style="color: #A0A0A0">1371</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0">1372</span> <span style="color: #228B22; background: #FFFFFF;">%% The order of the variables are:</span><br/>               <span style="color: #A0A0A0">1373</span> <span style="color: #228B22; background: #FFFFFF;">%% ( x, s, wB, lambda, y, zL, zB, rB) </span><br/>               <span style="color: #A0A0A0">1374</span> <span style="color: #228B22; background: #FFFFFF;">%%--------------------------------------------</span><br/>               <span style="color: #A0A0A0">1375</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1376</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1377</span> <span style="color: #228B22; background: #FFFFFF;">%% Formulating new A</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1378</span> <span style="color: #000000; background: #FFFFFF;">L = [L(1:n); L(len+1:end)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1379</span> <a name="Line1379"></a><span style="color: #000000; background: #FFFFFF;">U = [U(1:n); U(len+1:end)]; </span><br/>               <span style="color: #A0A0A0">1380</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1381</span> <a name="Line1381"></a><span style="color: #000000; background: #FFFFFF;">return </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>