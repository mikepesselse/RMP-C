<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for quadprogbb>standardform</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">quadprogbb>standardform (1 call, 0.488 sec)</span><br/><i>Generated 06-Oct-2011 17:10:42 using cpu time.</i><br/>M-subfunction in file /nfs/dollar/local/vol00/user0/jieqchen/QuadProgBB/quadprogbb.m<br/>Copy to new window for comparing multiple runs<p><span class="warning">This function changed during profiling or before generation of this report. Results may be incomplete or inaccurate.</span></p><div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file1.html">quadprogbb</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line851">851</a></td><td class="td-linebottomrt"><pre>[L,U,tmp1,tmp2,tmp3,tmp4,tlp] ...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.385 s</td><td class="td-linebottomrt" class="td-linebottomrt">78.9%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=79 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line818">818</a></td><td class="td-linebottomrt"><pre>[H,f,A,b,Aeq,beq,LB,UB,cons,ss...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.086 s</td><td class="td-linebottomrt" class="td-linebottomrt">17.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=18 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line811">811</a></td><td class="td-linebottomrt"><pre>if tmp_m1 &lt; min(tmp_m,tmp_n...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line767">767</a></td><td class="td-linebottomrt"><pre>sstruct = struct('flag',0,'obj...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1096">1096</a></td><td class="td-linebottomrt"><pre>return</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt" class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.000 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.488 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file34.html">quadprogbb>boundall</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.359 s</td><td class="td-linebottomrt">73.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=74 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file33.html">quadprogbb>refm</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.051 s</td><td class="td-linebottomrt">10.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=11 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file28.html">rank</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.077 s</td><td class="td-linebottomrt">15.8%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.488 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line777">777</a></td><td class="td-linebottomrt"><span class="mono">Using ISEMPTY is usually faster than comparing LENGTH to 0.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line877">877</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'H1' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">336</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">133</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">203</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">155</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">48</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">76.35 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0"> 761</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [H,f,A,b,E,cons,L,U,sstruct,timeLP] = standardform(H,f,A,b,Aeq,beq,LB,UB,cons,tol)</span><br/>               <span style="color: #A0A0A0"> 762</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 763</span> <span style="color: #228B22; background: #FFFFFF;">% If abs(difference of two values) &lt; tol, the two values are considered</span><br/>               <span style="color: #A0A0A0"> 764</span> <span style="color: #228B22; background: #FFFFFF;">% to be equal</span><br/>               <span style="color: #A0A0A0"> 765</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 766</span> <span style="color: #000000; background: #FFFFFF;">E = []; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 767</span> <a name="Line767"></a><span style="color: #000000; background: #FFFFFF;">sstruct = struct('flag',0,'obj',-inf,'fx1',[],'fxval1',[],'ub2',[],'idxU2',[],... </span><br/>               <span style="color: #A0A0A0"> 768</span> <span style="color: #000000; background: #FFFFFF;">                'lb3',[],'idxL3',[],'ub4',[],'idxU4',[],'idxU5',[],'ub5',[],...</span><br/>               <span style="color: #A0A0A0"> 769</span> <span style="color: #000000; background: #FFFFFF;">                'idxL5',[],'lb5',[],'lb6',[],'ub6',[]);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 770</span> <span style="color: #000000; background: #FFFFFF;">timeLP = 0; </span><br/>               <span style="color: #A0A0A0"> 771</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------</span><br/>               <span style="color: #A0A0A0"> 772</span> <span style="color: #228B22; background: #FFFFFF;">%% Remove fixed variables</span><br/>               <span style="color: #A0A0A0"> 773</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------- </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 774</span> <span style="color: #000000; background: #FFFFFF;">n = size(H,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 775</span> <span style="color: #000000; background: #FFFFFF;">FX  = find(abs(LB - UB)&lt; tol); </span><br/>               <span style="color: #A0A0A0"> 776</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line777"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 777</span> <span style="color: #000000; background: #FFFFFF;">if length(FX) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 778</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 779</span> <span style="color: #228B22; background: #FFFFFF;">  %% track change: 1</span><br/>               <span style="color: #A0A0A0"> 780</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.fx1 = FX;</span><br/>               <span style="color: #A0A0A0"> 781</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.fxval1 = LB(FX);</span><br/>               <span style="color: #A0A0A0"> 782</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 783</span> <span style="color: #228B22; background: #FFFFFF;">    %% FXc == complement of FX or the components of x that are not fixed</span><br/>               <span style="color: #A0A0A0"> 784</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 785</span> <span style="color: #A0A0A0; background: #FFFFFF;">    FXc = setdiff(1:n,FX);</span><br/>               <span style="color: #A0A0A0"> 786</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 787</span> <span style="color: #228B22; background: #FFFFFF;">    %% Calculate the constants in objective after removing the fixed vars</span><br/>               <span style="color: #A0A0A0"> 788</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 789</span> <span style="color: #A0A0A0; background: #FFFFFF;">    cons = cons + 0.5*LB(FX)'*H(FX,FX)*LB(FX) + f(FX)'*LB(FX);</span><br/>               <span style="color: #A0A0A0"> 790</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 791</span> <span style="color: #228B22; background: #FFFFFF;">    %% Update data after removing fixed components</span><br/>               <span style="color: #A0A0A0"> 792</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 793</span> <span style="color: #A0A0A0; background: #FFFFFF;">    f   = f(FXc) + H(FXc,FX)*LB(FX);</span><br/>               <span style="color: #A0A0A0"> 794</span> <span style="color: #A0A0A0; background: #FFFFFF;">    H   = H(FXc,FXc);</span><br/>               <span style="color: #A0A0A0"> 795</span> <span style="color: #A0A0A0; background: #FFFFFF;">    b   = b   - A  (:,FX)*LB(FX); A   = A  (:,FXc);</span><br/>               <span style="color: #A0A0A0"> 796</span> <span style="color: #A0A0A0; background: #FFFFFF;">    beq = beq - Aeq(:,FX)*LB(FX); Aeq = Aeq(:,FXc);</span><br/>               <span style="color: #A0A0A0"> 797</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 798</span> <span style="color: #228B22; background: #FFFFFF;">    %% Update the bounds for the non-fixed components of x</span><br/>               <span style="color: #A0A0A0"> 799</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 800</span> <span style="color: #A0A0A0; background: #FFFFFF;">    LB = LB(FXc);</span><br/>               <span style="color: #A0A0A0"> 801</span> <span style="color: #A0A0A0; background: #FFFFFF;">    UB = UB(FXc);</span><br/>               <span style="color: #A0A0A0"> 802</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 803</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 804</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 805</span> <span style="color: #228B22; background: #FFFFFF;">% remove linearly dependent equalities</span><br/>               <span style="color: #A0A0A0"> 806</span> <span style="color: #228B22; background: #FFFFFF;">% inequality does not matter</span><br/>               <span style="color: #A0A0A0"> 807</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 808</span> <span style="color: #000000; background: #FFFFFF;">[tmp_m,tmp_n] = size(Aeq); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 809</span> <span style="color: #000000; background: #FFFFFF;">tmp_m1 = <a href="file28.html">rank</a>(Aeq); </span><br/>               <span style="color: #A0A0A0"> 810</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 811</span> <a name="Line811"></a><span style="color: #000000; background: #FFFFFF;">if tmp_m1 &lt; min(tmp_m,tmp_n) </span><br/>               <span style="color: #A0A0A0"> 812</span> <span style="color: #A0A0A0; background: #FFFFFF;">  tmp = [Aeq beq]';</span><br/>               <span style="color: #A0A0A0"> 813</span> <span style="color: #A0A0A0; background: #FFFFFF;">  [r, rowidx] = rref(tmp);</span><br/>               <span style="color: #A0A0A0"> 814</span> <span style="color: #A0A0A0; background: #FFFFFF;">  Aeq = Aeq(rowidx,:);</span><br/>               <span style="color: #A0A0A0"> 815</span> <span style="color: #A0A0A0; background: #FFFFFF;">  beq = beq(rowidx);</span><br/>               <span style="color: #A0A0A0"> 816</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 817</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 818</span> <a name="Line818"></a><span style="color: #000000; background: #FFE2E2;">[H,f,A,b,Aeq,beq,LB,UB,cons,sstruct,tlp] = <a href="file33.html">refm</a>(H,f,A,b,Aeq,beq,LB,UB,cons,sstruct); </span><br/>               <span style="color: #A0A0A0"> 819</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 820</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0"> 821</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 822</span> <span style="color: #228B22; background: #FFFFFF;">%% Now problem becomes:</span><br/>               <span style="color: #A0A0A0"> 823</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 824</span> <span style="color: #228B22; background: #FFFFFF;">%%   min  .5*x*H*x + f*x + cons</span><br/>               <span style="color: #A0A0A0"> 825</span> <span style="color: #228B22; background: #FFFFFF;">%%   s.t.   A x &lt;=  b              ( lamabda &gt;=0 )</span><br/>               <span style="color: #A0A0A0"> 826</span> <span style="color: #228B22; background: #FFFFFF;">%%          Aeq x = beq            ( y free )</span><br/>               <span style="color: #A0A0A0"> 827</span> <span style="color: #228B22; background: #FFFFFF;">%%          0 &lt;= xL                ( zL &gt;=0 )</span><br/>               <span style="color: #A0A0A0"> 828</span> <span style="color: #228B22; background: #FFFFFF;">%%          0 &lt;= xB &lt;= 1           ( zB&gt;=0, rB &gt;=0)</span><br/>               <span style="color: #A0A0A0"> 829</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 830</span> <span style="color: #228B22; background: #FFFFFF;">%% Now we are to formulate KKT system, and</span><br/>               <span style="color: #A0A0A0"> 831</span> <span style="color: #228B22; background: #FFFFFF;">%% calculate bounds on all vars.</span><br/>               <span style="color: #A0A0A0"> 832</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------------------------------------</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 833</span> <span style="color: #000000; background: #FFFFFF;">n = size(H,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 834</span> <span style="color: #000000; background: #FFFFFF;">m = size(A,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 835</span> <span style="color: #000000; background: #FFFFFF;">meq = size(Aeq,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 836</span> <span style="color: #000000; background: #FFFFFF;">i1 = isfinite(LB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 837</span> <span style="color: #000000; background: #FFFFFF;">i2 = isfinite(UB); </span><br/>               <span style="color: #A0A0A0"> 838</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 839</span> <span style="color: #228B22; background: #FFFFFF;">%% now the meaning of idxL and idxU has changed.</span><br/>               <span style="color: #A0A0A0"> 840</span> <span style="color: #228B22; background: #FFFFFF;">%% idxL = LB finite + UB infinite</span><br/>               <span style="color: #A0A0A0"> 841</span> <span style="color: #228B22; background: #FFFFFF;">%% idxU = both LB &amp; UB finite</span><br/>               <span style="color: #A0A0A0"> 842</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 843</span> <span style="color: #000000; background: #FFFFFF;">idxL = find(i1 &amp; ~i2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 844</span> <span style="color: #000000; background: #FFFFFF;">idxB = find(i1 &amp; i2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 845</span> <span style="color: #000000; background: #FFFFFF;">lenL = length(idxL); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 846</span> <span style="color: #000000; background: #FFFFFF;">lenB = length(idxB); </span><br/>               <span style="color: #A0A0A0"> 847</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 848</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------------------</span><br/>               <span style="color: #A0A0A0"> 849</span> <span style="color: #228B22; background: #FFFFFF;">%% Calculate bounds for all vars</span><br/>               <span style="color: #A0A0A0"> 850</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------------------</span><br/><span style="color: #FF0000">  0.38 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 851</span> <a name="Line851"></a><span style="color: #000000; background: #FF8080;">[L,U,tmp1,tmp2,tmp3,tmp4,tlp] = <a href="file34.html">boundall</a>(H,f,A,b,Aeq,beq,LB,UB,idxL,idxB); </span><br/>               <span style="color: #A0A0A0"> 852</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 853</span> <span style="color: #000000; background: #FFFFFF;">timeLP = timeLP + tlp; </span><br/>               <span style="color: #A0A0A0"> 854</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 855</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 856</span> <span style="color: #228B22; background: #FFFFFF;">%% Prep equality constraints: A * xx = b </span><br/>               <span style="color: #A0A0A0"> 857</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 858</span> <span style="color: #228B22; background: #FFFFFF;">%%  (1)    H * x + A'*lambda + Aeq' * y - zL - zB + rB = -f</span><br/>               <span style="color: #A0A0A0"> 859</span> <span style="color: #228B22; background: #FFFFFF;">%%  (2)    A * x + s = b</span><br/>               <span style="color: #A0A0A0"> 860</span> <span style="color: #228B22; background: #FFFFFF;">%%  (3)    Aeq * x = beq</span><br/>               <span style="color: #A0A0A0"> 861</span> <span style="color: #228B22; background: #FFFFFF;">%%  (4)    xB + wB = 1</span><br/>               <span style="color: #A0A0A0"> 862</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 863</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 864</span> <span style="color: #000000; background: #FFFFFF;">if norm(L-U)&lt;tol </span><br/>               <span style="color: #A0A0A0"> 865</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.flag = 1;</span><br/>               <span style="color: #A0A0A0"> 866</span> <span style="color: #A0A0A0; background: #FFFFFF;">  xLB = L(1:n);</span><br/>               <span style="color: #A0A0A0"> 867</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.xx = xLB;</span><br/>               <span style="color: #A0A0A0"> 868</span> <span style="color: #A0A0A0; background: #FFFFFF;">  sstruct.obj = .5*xLB'*H*xLB + f'*xLB+cons;</span><br/>               <span style="color: #A0A0A0"> 869</span> <span style="color: #A0A0A0; background: #FFFFFF;">  return</span><br/>               <span style="color: #A0A0A0"> 870</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 871</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 872</span> <span style="color: #000000; background: #FFFFFF;">idxx = find(abs(U-L) &lt;= tol); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 873</span> <span style="color: #000000; background: #FFFFFF;">L(idxx) = U(idxx); </span><br/>               <span style="color: #A0A0A0"> 874</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 875</span> <span style="color: #000000; background: #FFFFFF;">nn = n+2*m+meq+lenL+3*lenB; </span><br/>               <span style="color: #A0A0A0"> 876</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line877"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 877</span> <span style="color: #000000; background: #FFFFFF;">H1 = H;  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 878</span> <span style="color: #000000; background: #FFFFFF;">A1 = A;  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 879</span> <span style="color: #000000; background: #FFFFFF;">A2 = A; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 880</span> <span style="color: #000000; background: #FFFFFF;">Aeq1 = Aeq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 881</span> <span style="color: #000000; background: #FFFFFF;">Aeq2 = Aeq; </span><br/>               <span style="color: #A0A0A0"> 882</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 883</span> <span style="color: #000000; background: #FFFFFF;">xLB = L(1:n); xUB = U(1:n); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 884</span> <span style="color: #000000; background: #FFFFFF;">Dx = diag(xUB-xLB); </span><br/>               <span style="color: #A0A0A0"> 885</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 886</span> <span style="color: #000000; background: #FFFFFF;">sLB = L(n+1:n+m); sUB = U(n+1:n+m); </span><br/>               <span style="color: #A0A0A0"> 887</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 888</span> <span style="color: #000000; background: #FFFFFF;">n0 = n+m; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 889</span> <span style="color: #000000; background: #FFFFFF;">wLB = L(n0+1:n0+lenB); wUB = U(n0+1:n0+lenB); </span><br/>               <span style="color: #A0A0A0"> 890</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 891</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 892</span> <span style="color: #000000; background: #FFFFFF;">lambdaLB = L(n0+1:n0+m); lambdaUB = U(n0+1:n0+m); </span><br/>               <span style="color: #A0A0A0"> 893</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 894</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+m; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 895</span> <span style="color: #000000; background: #FFFFFF;">yLB = L(n0+1:n0+meq); yUB = U(n0+1:n0+meq); </span><br/>               <span style="color: #A0A0A0"> 896</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 897</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+meq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 898</span> <span style="color: #000000; background: #FFFFFF;">zLLB = L(n0+1:n0+lenL); zLUB = U(n0+1:n0+lenL); </span><br/>               <span style="color: #A0A0A0"> 899</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 900</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+lenL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 901</span> <span style="color: #000000; background: #FFFFFF;">zBLB = L(n0+1:n0+lenB); zBUB = U(n0+1:n0+lenB); </span><br/>               <span style="color: #A0A0A0"> 902</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 903</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0 + lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 904</span> <span style="color: #000000; background: #FFFFFF;">rBLB = L(n0+1:end); rBUB = U(n0+1:end); </span><br/>               <span style="color: #A0A0A0"> 905</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 906</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 907</span> <span style="color: #228B22; background: #FFFFFF;">%% Right-hand size b</span><br/>               <span style="color: #A0A0A0"> 908</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 909</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 910</span> <span style="color: #000000; background: #FFFFFF;">r1 = -f - H*xLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 911</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp1) </span><br/>               <span style="color: #A0A0A0"> 912</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r1 = r1 - tmp1*zLLB;</span><br/>               <span style="color: #A0A0A0"> 913</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 914</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 915</span> <span style="color: #000000; background: #FFFFFF;">  r1 = r1 - tmp2*zBLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 916</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 917</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp3) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 918</span> <span style="color: #000000; background: #FFFFFF;">  r1 = r1 - tmp3*rBLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 919</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 920</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A1) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 921</span> <span style="color: #000000; background: #FFFFFF;">  r1 = r1 - A1'*lambdaLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 922</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 923</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq1) </span><br/>               <span style="color: #A0A0A0"> 924</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r1 = r1-Aeq1'*yLB;</span><br/>               <span style="color: #A0A0A0"> 925</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 926</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 927</span> <span style="color: #000000; background: #FFFFFF;">  r2 = b - A*xLB - sLB; </span><br/>               <span style="color: #A0A0A0"> 928</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 929</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r2 = [];</span><br/>               <span style="color: #A0A0A0"> 930</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 931</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq2) </span><br/>               <span style="color: #A0A0A0"> 932</span> <span style="color: #A0A0A0; background: #FFFFFF;">  r3 = beq - Aeq2*xLB;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 933</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 934</span> <span style="color: #000000; background: #FFFFFF;">  r3 = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 935</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 936</span> <span style="color: #000000; background: #FFFFFF;">r4 = ones(lenB,1)- xLB(idxB)- wLB; </span><br/>               <span style="color: #A0A0A0"> 937</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 938</span> <span style="color: #000000; background: #FFFFFF;">b = [r1;r2;r3;r4]; </span><br/>               <span style="color: #A0A0A0"> 939</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 940</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 941</span> <span style="color: #228B22; background: #FFFFFF;">%% Left-hand side A</span><br/>               <span style="color: #A0A0A0"> 942</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 943</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 944</span> <span style="color: #000000; background: #FFFFFF;">tmp1 = tmp1*diag(zLUB - zLLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 945</span> <span style="color: #000000; background: #FFFFFF;">tmp2 = tmp2*diag(zBUB - zBLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 946</span> <span style="color: #000000; background: #FFFFFF;">tmp3 = tmp3*diag(rBUB - rBLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 947</span> <span style="color: #000000; background: #FFFFFF;">row1 = [H*Dx zeros(n,m+lenB)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 948</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A1) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 949</span> <span style="color: #000000; background: #FFFFFF;">  row1 = [row1 A1'*diag(lambdaUB-lambdaLB)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 950</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 951</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq1) </span><br/>               <span style="color: #A0A0A0"> 952</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row1 = [row1 Aeq1'*diag(yUB-yLB)];</span><br/>               <span style="color: #A0A0A0"> 953</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 954</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(A2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 955</span> <span style="color: #000000; background: #FFFFFF;">  row2 = A2*Dx; </span><br/>               <span style="color: #A0A0A0"> 956</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 957</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row2 = [];</span><br/>               <span style="color: #A0A0A0"> 958</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 959</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(Aeq2) </span><br/>               <span style="color: #A0A0A0"> 960</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row3 = Aeq2*Dx;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 961</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 962</span> <span style="color: #000000; background: #FFFFFF;">  row3 = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 963</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 964</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp4) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 965</span> <span style="color: #000000; background: #FFFFFF;">  row4 = tmp4*Dx; </span><br/>               <span style="color: #A0A0A0"> 966</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 967</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row4 = [];</span><br/>               <span style="color: #A0A0A0"> 968</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 969</span> <span style="color: #228B22; background: #FFFFFF;">%A = [ H*Dx zeros(n,m+lenB) A1'*diag(lambdaUB-lambdaLB) Aeq1'*diag(yUB-yLB) tmp1 tmp2 tmp3;</span><br/>               <span style="color: #A0A0A0"> 970</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 971</span> <span style="color: #228B22; background: #FFFFFF;">%A = [ row1 tmp1 tmp2 tmp3;</span><br/>               <span style="color: #A0A0A0"> 972</span> <span style="color: #228B22; background: #FFFFFF;">%      row2 diag(sUB-sLB) zeros(m,nn-n-m);</span><br/>               <span style="color: #A0A0A0"> 973</span> <span style="color: #228B22; background: #FFFFFF;">%      row3 zeros(meq,nn-n);</span><br/>               <span style="color: #A0A0A0"> 974</span> <span style="color: #228B22; background: #FFFFFF;">%      row4 zeros(lenB,m) diag(wUB-wLB) zeros(lenB, nn-n-m-lenB)];</span><br/>               <span style="color: #A0A0A0"> 975</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 976</span> <span style="color: #228B22; background: #FFFFFF;">%row1 of A</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 977</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp1) </span><br/>               <span style="color: #A0A0A0"> 978</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row1 = [ row1 tmp1 ];</span><br/>               <span style="color: #A0A0A0"> 979</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 980</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 981</span> <span style="color: #000000; background: #FFFFFF;">  row1 = [ row1 tmp2 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 982</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 983</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(tmp3) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 984</span> <span style="color: #000000; background: #FFFFFF;">  row1 = [ row1 tmp3 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 985</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 986</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 987</span> <span style="color: #228B22; background: #FFFFFF;">%row2 of A</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 988</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(sUB) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 989</span> <span style="color: #000000; background: #FFFFFF;">  row2 = [ row2 diag(sUB-sLB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 990</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 991</span> <span style="color: #000000; background: #FFFFFF;">if m * (nn-n-m) &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 992</span> <span style="color: #000000; background: #FFFFFF;">  row2 = [ row2 zeros(m,nn-n-m) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 993</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 994</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 995</span> <span style="color: #228B22; background: #FFFFFF;">% row3 of A</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 996</span> <span style="color: #000000; background: #FFFFFF;">if meq *(nn-n) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 997</span> <span style="color: #A0A0A0; background: #FFFFFF;">  row3 = [ row3 zeros(meq,nn-n) ];</span><br/>               <span style="color: #A0A0A0"> 998</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 999</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1000</span> <span style="color: #228B22; background: #FFFFFF;">% row4 of A</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1001</span> <span style="color: #000000; background: #FFFFFF;">if lenB * m &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1002</span> <span style="color: #000000; background: #FFFFFF;">  row4 = [ row4 zeros(lenB,m)] ; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1003</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1004</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(wUB) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1005</span> <span style="color: #000000; background: #FFFFFF;">  row4 = [ row4 diag(wUB - wLB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1006</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1007</span> <span style="color: #000000; background: #FFFFFF;">if lenB * (nn-n-m-lenB) &gt; 0 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1008</span> <span style="color: #000000; background: #FFFFFF;">  row4 = [ row4 zeros(lenB, nn-n-m-lenB) ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1009</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1010</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1011</span> <span style="color: #000000; background: #FFFFFF;">A = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1012</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(row1) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1013</span> <span style="color: #000000; background: #FFFFFF;">  A  = row1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1014</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1015</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(row2) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1016</span> <span style="color: #000000; background: #FFFFFF;">  A = [ A; row2 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1017</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1018</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(row3) </span><br/>               <span style="color: #A0A0A0">1019</span> <span style="color: #A0A0A0; background: #FFFFFF;">  A = [ A; row3 ];</span><br/>               <span style="color: #A0A0A0">1020</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1021</span> <span style="color: #000000; background: #FFFFFF;">if ~isempty(row4) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1022</span> <span style="color: #000000; background: #FFFFFF;">  A = [ A; row4 ]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1023</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1024</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1025</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">1026</span> <span style="color: #228B22; background: #FFFFFF;">%% Shift and scale x affects objs</span><br/>               <span style="color: #A0A0A0">1027</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">1028</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1029</span> <span style="color: #000000; background: #FFFFFF;">cons = cons + 0.5*xLB'*H*xLB + f'*xLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1030</span> <span style="color: #000000; background: #FFFFFF;">f = f + H*xLB; </span><br/>               <span style="color: #A0A0A0">1031</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1032</span> <span style="color: #000000; background: #FFFFFF;">H = diag(xUB - xLB)*H*diag(xUB - xLB); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1033</span> <span style="color: #000000; background: #FFFFFF;">f = (xUB-xLB).* f; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1034</span> <span style="color: #000000; background: #FFFFFF;">n0 = nn-n; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1035</span> <span style="color: #000000; background: #FFFFFF;">f = [f ; zeros(n0,1)]; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1036</span> <span style="color: #000000; background: #FFFFFF;">H = [H zeros(n,n0);  </span><br/>               <span style="color: #A0A0A0">1037</span> <span style="color: #000000; background: #FFFFFF;">     zeros(n0,n) zeros(n0)];</span><br/>               <span style="color: #A0A0A0">1038</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1039</span> <span style="color: #228B22; background: #FFFFFF;">     </span><br/>               <span style="color: #A0A0A0">1040</span> <span style="color: #228B22; background: #FFFFFF;">%% track change: 6</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1041</span> <span style="color: #000000; background: #FFFFFF;">sstruct.lb6 = xLB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1042</span> <span style="color: #000000; background: #FFFFFF;">sstruct.ub6 = xUB; </span><br/>               <span style="color: #A0A0A0">1043</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1044</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1045</span> <span style="color: #000000; background: #FFFFFF;">L = zeros(nn,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1046</span> <span style="color: #000000; background: #FFFFFF;">U = ones(nn,1); </span><br/>               <span style="color: #A0A0A0">1047</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1048</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">1049</span> <span style="color: #228B22; background: #FFFFFF;">%% Prep complementarity</span><br/>               <span style="color: #A0A0A0">1050</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------</span><br/>               <span style="color: #A0A0A0">1051</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1052</span> <span style="color: #000000; background: #FFFFFF;">E = zeros(nn); </span><br/>               <span style="color: #A0A0A0">1053</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1054</span> <span style="color: #228B22; background: #FFFFFF;">%% s .* lambda = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1055</span> <span style="color: #000000; background: #FFFFFF;">n0 = n+m+lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1056</span> <span style="color: #000000; background: #FFFFFF;">for i = 1:m </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1057</span> <span style="color: #000000; background: #FFFFFF;">    E(n+i, n0+i ) = 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1058</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1059</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1060</span> <span style="color: #228B22; background: #FFFFFF;">%% xL .* zL = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1061</span> <span style="color: #000000; background: #FFFFFF;">n0 = n0+m+meq; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1062</span> <span style="color: #000000; background: #FFFFFF;">for k=1:lenL </span><br/>               <span style="color: #A0A0A0">1063</span> <span style="color: #A0A0A0; background: #FFFFFF;">  i = idxL(k);</span><br/>               <span style="color: #A0A0A0">1064</span> <span style="color: #A0A0A0; background: #FFFFFF;">  E(i,n0+k) = 1;</span><br/>               <span style="color: #A0A0A0">1065</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">1066</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1067</span> <span style="color: #228B22; background: #FFFFFF;">%% xB .* zB = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1068</span> <span style="color: #000000; background: #FFFFFF;">n0 = nn - 2*lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1069</span> <span style="color: #000000; background: #FFFFFF;">for k=1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1070</span> <span style="color: #000000; background: #FFFFFF;">  i = idxB(k); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1071</span> <span style="color: #000000; background: #FFFFFF;">  E(i,n0+k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1072</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1073</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1074</span> <span style="color: #228B22; background: #FFFFFF;">%% wB .* rB = 0</span><br/>               <span style="color: #A0A0A0">1075</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1076</span> <span style="color: #000000; background: #FFFFFF;">n00 = n+m; n0 = nn-lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1077</span> <span style="color: #000000; background: #FFFFFF;">for k = 1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1078</span> <span style="color: #000000; background: #FFFFFF;">  E(n00+k,n0+k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1079</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1080</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">1081</span> <span style="color: #228B22; background: #FFFFFF;">%% zB .* rB = 0</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1082</span> <span style="color: #000000; background: #FFFFFF;">n00 = nn - 2*lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1083</span> <span style="color: #000000; background: #FFFFFF;">for k = 1:lenB </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1084</span> <span style="color: #000000; background: #FFFFFF;">  E(n00+k,n0+k) = 1; </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold">1085</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">1086</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1087</span> <span style="color: #000000; background: #FFFFFF;">E = E + E'; </span><br/>               <span style="color: #A0A0A0">1088</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1089</span> <span style="color: #000000; background: #FFFFFF;">sstruct.cmp1 = [ n+(1:m)'; idxL ; idxB; n+m+(1:lenB)']; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1090</span> <span style="color: #000000; background: #FFFFFF;">sstruct.cmp2 = [ n+m+lenB+(1:m)'; nn-2*lenB-lenL+(1:lenL)'; nn-2*lenB+(1:lenB)'; nn-lenB+(1:lenB)']; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1091</span> <span style="color: #000000; background: #FFFFFF;">sstruct.lenB = lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1092</span> <span style="color: #000000; background: #FFFFFF;">sstruct.m = m; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1093</span> <span style="color: #000000; background: #FFFFFF;">sstruct.n = n; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1094</span> <span style="color: #000000; background: #FFFFFF;">sstruct.lenL = lenL; </span><br/>               <span style="color: #A0A0A0">1095</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">1096</span> <a name="Line1096"></a><span style="color: #000000; background: #FFFFFF;">return </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>