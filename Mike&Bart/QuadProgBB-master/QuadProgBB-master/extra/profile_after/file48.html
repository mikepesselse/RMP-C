<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for qpsub>eqnsolv</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">qpsub>eqnsolv (77 calls, 0.051 sec)</span><br/><i>Generated 06-Oct-2011 17:10:46 using cpu time.</i><br/>M-subfunction in file /usr/local/apps/matlab78/toolbox/shared/optimlib/qpsub.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file47.html">qpsub</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">77</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line877">877</a></td><td class="td-linebottomrt"><pre>if ~isempty(depInd)    % equal...</pre></td><td class="td-linebottomrt">77</td><td class="td-linebottomrt">0.017 s</td><td class="td-linebottomrt" class="td-linebottomrt">33.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=33 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line1001">1001</a></td><td class="td-linebottomrt"><pre>warning(warningstate2)</pre></td><td class="td-linebottomrt">77</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line981">981</a></td><td class="td-linebottomrt"><pre>minnormstep = Q(:,1:ACTCNT) * ...</pre></td><td class="td-linebottomrt">77</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line976">976</a></td><td class="td-linebottomrt"><pre>warningstate2 = warning('off',...</pre></td><td class="td-linebottomrt">77</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line865">865</a></td><td class="td-linebottomrt"><pre>[Qa,Ra,Ea]=qr(A(eqix,:));</pre></td><td class="td-linebottomrt">77</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.051 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/>No children<div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line847">847</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'LLS' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line847">847</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'H' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line847">847</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'f' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line847">847</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'normf' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line848">848</a></td><td class="td-linebottomrt"><span class="mono">Input argument 'normA' might be unused, but a later input argument is used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line859">859</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'tolCons' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line861">861</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'Z' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line865">865</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'Ea' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line896">896</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'j' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line951">951</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'j' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line953">953</a></td><td class="td-linebottomrt"><span class="mono">Removing the call to FIND and using logical indexing is usually faster.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line954">954</a></td><td class="td-linebottomrt"><span class="mono">Removing the call to FIND and using logical indexing is usually faster.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">155</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">54</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">101</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">34</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">67</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">33.66 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/><a name="Line847"></a>               <span style="color: #A0A0A0"> 847</span> <span style="color: #228B22; background: #FFFFFF;">    eqnsolv(A,B,eqix,neqcstr,ncstr,numberOfVariables,LLS,H,X,f,normf, ...</span><br/><a name="Line848"></a>               <span style="color: #A0A0A0"> 848</span> <span style="color: #228B22; background: #FFFFFF;">    normA,verbosity,aix,ACTSET,ACTIND,ACTCNT,how,exitflag)</span><br/>               <span style="color: #A0A0A0"> 849</span> <span style="color: #228B22; background: #FFFFFF;">% EQNSOLV Helper function for QPSUB.</span><br/>               <span style="color: #A0A0A0"> 850</span> <span style="color: #228B22; background: #FFFFFF;">%    Checks whether the working set is linearly independent and</span><br/>               <span style="color: #A0A0A0"> 851</span> <span style="color: #228B22; background: #FFFFFF;">%    finds a feasible point with respect to the working set constraints.</span><br/>               <span style="color: #A0A0A0"> 852</span> <span style="color: #228B22; background: #FFFFFF;">%    If the equalities are dependent but not consistent, warning</span><br/>               <span style="color: #A0A0A0"> 853</span> <span style="color: #228B22; background: #FFFFFF;">%    messages are given. If the equalities are dependent but consistent, </span><br/>               <span style="color: #A0A0A0"> 854</span> <span style="color: #228B22; background: #FFFFFF;">%    the redundant constraints are removed and the corresponding variables </span><br/>               <span style="color: #A0A0A0"> 855</span> <span style="color: #228B22; background: #FFFFFF;">%    adjusted.</span><br/>               <span style="color: #A0A0A0"> 856</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 857</span> <span style="color: #228B22; background: #FFFFFF;">% set tolerances</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 858</span> <span style="color: #000000; background: #FFFFFF;">tolDep = 100*numberOfVariables*eps;       </span><br/><a name="Line859"></a>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 859</span> <span style="color: #000000; background: #FFFFFF;">tolCons = 1e-10; </span><br/>               <span style="color: #A0A0A0"> 860</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line861"></a>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 861</span> <span style="color: #000000; background: #FFFFFF;">Z=[]; remove =[]; </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 862</span> <span style="color: #000000; background: #FFFFFF;">msg = []; % will be given a value only if appropriate </span><br/>               <span style="color: #A0A0A0"> 863</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 864</span> <span style="color: #228B22; background: #FFFFFF;">% First see if the equality constraints form a consistent system.</span><br/><a name="Line865"></a><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 865</span> <a name="Line865"></a><span style="color: #000000; background: #FFC6C6;">[Qa,Ra,Ea]=qr(A(eqix,:)); </span><br/>               <span style="color: #A0A0A0"> 866</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 867</span> <span style="color: #228B22; background: #FFFFFF;">% Form vector of dependent indices.</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 868</span> <span style="color: #000000; background: #FFFFFF;">if min(size(Ra))==1 % Make sure Ra isn't a vector </span><br/>               <span style="color: #A0A0A0"> 869</span> <span style="color: #A0A0A0; background: #FFFFFF;">    depInd = find( abs(Ra(1,1)) &lt; tolDep);</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 870</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 871</span> <span style="color: #000000; background: #FFFFFF;">    depInd = find( abs(diag(Ra)) &lt; tolDep ); </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 872</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 873</span> <span style="color: #000000; background: #FFFFFF;">if neqcstr &gt; numberOfVariables </span><br/>               <span style="color: #A0A0A0"> 874</span> <span style="color: #A0A0A0; background: #FFFFFF;">    depInd = [depInd; ((numberOfVariables+1):neqcstr)'];</span><br/>               <span style="color: #A0A0A0"> 875</span> <span style="color: #A0A0A0; background: #FFFFFF;">end      </span><br/>               <span style="color: #A0A0A0"> 876</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 877</span> <a name="Line877"></a><span style="color: #000000; background: #FF8080;">if ~isempty(depInd)    % equality constraints are dependent </span><br/>               <span style="color: #A0A0A0"> 878</span> <span style="color: #A0A0A0; background: #FFFFFF;">    msg = sprintf('The equality constraints are dependent.');</span><br/>               <span style="color: #A0A0A0"> 879</span> <span style="color: #A0A0A0; background: #FFFFFF;">    how='dependent';</span><br/>               <span style="color: #A0A0A0"> 880</span> <span style="color: #A0A0A0; background: #FFFFFF;">    exitflag = 1;</span><br/>               <span style="color: #A0A0A0"> 881</span> <span style="color: #A0A0A0; background: #FFFFFF;">    bdepInd =  abs(Qa(:,depInd)'*B(eqix)) &gt;= tolDep ;</span><br/>               <span style="color: #A0A0A0"> 882</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 883</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if any( bdepInd ) % Not consistent</span><br/>               <span style="color: #A0A0A0"> 884</span> <span style="color: #A0A0A0; background: #FFFFFF;">        how='infeasible';   </span><br/>               <span style="color: #A0A0A0"> 885</span> <span style="color: #A0A0A0; background: #FFFFFF;">        exitflag = -2;</span><br/>               <span style="color: #A0A0A0"> 886</span> <span style="color: #A0A0A0; background: #FFFFFF;">        msg = sprintf('%s\nThe system of equality constraints is not consistent.',msg);</span><br/>               <span style="color: #A0A0A0"> 887</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ncstr &gt; neqcstr</span><br/>               <span style="color: #A0A0A0"> 888</span> <span style="color: #A0A0A0; background: #FFFFFF;">            msg = sprintf('%s\nThe inequality constraints may or may not be satisfied.',msg);</span><br/>               <span style="color: #A0A0A0"> 889</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 890</span> <span style="color: #A0A0A0; background: #FFFFFF;">        msg = sprintf('%s\nThere is no feasible solution.',msg);</span><br/>               <span style="color: #A0A0A0"> 891</span> <span style="color: #228B22; background: #FFFFFF;">    else % the equality constraints are consistent</span><br/>               <span style="color: #A0A0A0"> 892</span> <span style="color: #228B22; background: #FFFFFF;">        % Delete the redundant constraints</span><br/>               <span style="color: #A0A0A0"> 893</span> <span style="color: #228B22; background: #FFFFFF;">        % By QR factoring the transpose, we see which columns of A'</span><br/>               <span style="color: #A0A0A0"> 894</span> <span style="color: #228B22; background: #FFFFFF;">        %   (rows of A) move to the end</span><br/>               <span style="color: #A0A0A0"> 895</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [Qat,Rat,Eat]=qr(A(eqix,:)');        </span><br/><a name="Line896"></a>               <span style="color: #A0A0A0"> 896</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [i,j] = find(Eat); % Eat permutes the columns of A' (rows of A)</span><br/>               <span style="color: #A0A0A0"> 897</span> <span style="color: #A0A0A0; background: #FFFFFF;">        remove = i(depInd);</span><br/>               <span style="color: #A0A0A0"> 898</span> <span style="color: #A0A0A0; background: #FFFFFF;">        numDepend = nnz(remove);</span><br/>               <span style="color: #A0A0A0"> 899</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if verbosity &gt; 0</span><br/>               <span style="color: #A0A0A0"> 900</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp('The system of equality constraints is consistent. Removing');</span><br/>               <span style="color: #A0A0A0"> 901</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp('the following dependent constraints before continuing:');</span><br/>               <span style="color: #A0A0A0"> 902</span> <span style="color: #A0A0A0; background: #FFFFFF;">            disp(remove)</span><br/>               <span style="color: #A0A0A0"> 903</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 904</span> <span style="color: #A0A0A0; background: #FFFFFF;">        A(eqix(remove),:)=[];</span><br/>               <span style="color: #A0A0A0"> 905</span> <span style="color: #228B22; background: #FFFFFF;">        % Even though B is a vector, we use two-index syntax when</span><br/>               <span style="color: #A0A0A0"> 906</span> <span style="color: #228B22; background: #FFFFFF;">        % removing elements so that, if all constraints end up being removed,</span><br/>               <span style="color: #A0A0A0"> 907</span> <span style="color: #228B22; background: #FFFFFF;">        % it will have size 0-by-1, and be commensurate with the empty</span><br/>               <span style="color: #A0A0A0"> 908</span> <span style="color: #228B22; background: #FFFFFF;">        %, 0-by-1 matrix A. Similarly with the active set Boolean indicator aix.</span><br/>               <span style="color: #A0A0A0"> 909</span> <span style="color: #A0A0A0; background: #FFFFFF;">        B(eqix(remove),:)=[];</span><br/>               <span style="color: #A0A0A0"> 910</span> <span style="color: #A0A0A0; background: #FFFFFF;">        neqcstr = neqcstr - numDepend;</span><br/>               <span style="color: #A0A0A0"> 911</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ncstr = ncstr - numDepend;</span><br/>               <span style="color: #A0A0A0"> 912</span> <span style="color: #A0A0A0; background: #FFFFFF;">        eqix = 1:neqcstr;</span><br/>               <span style="color: #A0A0A0"> 913</span> <span style="color: #A0A0A0; background: #FFFFFF;">        aix(remove,:) = [];</span><br/>               <span style="color: #A0A0A0"> 914</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ACTIND(1:numDepend) = [];</span><br/>               <span style="color: #A0A0A0"> 915</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ACTIND = ACTIND - numDepend;      </span><br/>               <span style="color: #A0A0A0"> 916</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ACTSET = A(ACTIND,:);</span><br/>               <span style="color: #A0A0A0"> 917</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ACTCNT = ACTCNT - numDepend;</span><br/>               <span style="color: #A0A0A0"> 918</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % consistency check</span><br/>               <span style="color: #A0A0A0"> 919</span> <span style="color: #A0A0A0; background: #FFFFFF;">end % dependency check</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 920</span> <span style="color: #000000; background: #FFFFFF;">if verbosity &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 921</span> <span style="color: #A0A0A0; background: #FFFFFF;">  disp(msg)</span><br/>               <span style="color: #A0A0A0"> 922</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 923</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 924</span> <span style="color: #228B22; background: #FFFFFF;">% Now that we have done all we can to make the equality constraints</span><br/>               <span style="color: #A0A0A0"> 925</span> <span style="color: #228B22; background: #FFFFFF;">% consistent and independent we will check the inequality constraints</span><br/>               <span style="color: #A0A0A0"> 926</span> <span style="color: #228B22; background: #FFFFFF;">% in the working set.  First we want to make sure that the number of </span><br/>               <span style="color: #A0A0A0"> 927</span> <span style="color: #228B22; background: #FFFFFF;">% constraints in the working set is only greater than or equal to the</span><br/>               <span style="color: #A0A0A0"> 928</span> <span style="color: #228B22; background: #FFFFFF;">% number of variables if the number of (non-redundant) equality </span><br/>               <span style="color: #A0A0A0"> 929</span> <span style="color: #228B22; background: #FFFFFF;">% constraints is greater than or equal to the number of variables.</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 930</span> <span style="color: #000000; background: #FFFFFF;">if ACTCNT &gt;= numberOfVariables </span><br/>               <span style="color: #A0A0A0"> 931</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ACTCNT = max(neqcstr, numberOfVariables-1);</span><br/>               <span style="color: #A0A0A0"> 932</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ACTIND = ACTIND(1:ACTCNT);</span><br/>               <span style="color: #A0A0A0"> 933</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ACTSET = A(ACTIND,:);</span><br/>               <span style="color: #A0A0A0"> 934</span> <span style="color: #A0A0A0; background: #FFFFFF;">    aix = zeros(ncstr,1);</span><br/>               <span style="color: #A0A0A0"> 935</span> <span style="color: #A0A0A0; background: #FFFFFF;">    aix(ACTIND) = 1;</span><br/>               <span style="color: #A0A0A0"> 936</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 937</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 938</span> <span style="color: #228B22; background: #FFFFFF;">% Now check to see that all the constraints in the working set are</span><br/>               <span style="color: #A0A0A0"> 939</span> <span style="color: #228B22; background: #FFFFFF;">% linearly independent.</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 940</span> <span style="color: #000000; background: #FFFFFF;">if ACTCNT &gt; neqcstr </span><br/>               <span style="color: #A0A0A0"> 941</span> <span style="color: #A0A0A0; background: #FFFFFF;">    [Qat,Rat,Eat]=qr(ACTSET');</span><br/>               <span style="color: #A0A0A0"> 942</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 943</span> <span style="color: #228B22; background: #FFFFFF;">    % Form vector of dependent indices.</span><br/>               <span style="color: #A0A0A0"> 944</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if min(size(Rat))==1 % Make sure Rat isn't a vector</span><br/>               <span style="color: #A0A0A0"> 945</span> <span style="color: #A0A0A0; background: #FFFFFF;">        depInd = find( abs(Rat(1,1)) &lt; tolDep);</span><br/>               <span style="color: #A0A0A0"> 946</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 947</span> <span style="color: #A0A0A0; background: #FFFFFF;">        depInd = find( abs(diag(Rat)) &lt; tolDep );</span><br/>               <span style="color: #A0A0A0"> 948</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 949</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 950</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isempty(depInd)</span><br/><a name="Line951"></a>               <span style="color: #A0A0A0"> 951</span> <span style="color: #A0A0A0; background: #FFFFFF;">        [i,j] = find(Eat); % Eat permutes the columns of A' (rows of A)</span><br/>               <span style="color: #A0A0A0"> 952</span> <span style="color: #A0A0A0; background: #FFFFFF;">        remove2 = i(depInd);</span><br/><a name="Line953"></a>               <span style="color: #A0A0A0"> 953</span> <span style="color: #A0A0A0; background: #FFFFFF;">        removeEq   = remove2(find(remove2 &lt;= neqcstr));</span><br/><a name="Line954"></a>               <span style="color: #A0A0A0"> 954</span> <span style="color: #A0A0A0; background: #FFFFFF;">        removeIneq = remove2(find(remove2 &gt; neqcstr));</span><br/>               <span style="color: #A0A0A0"> 955</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 956</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~isempty(removeEq)</span><br/>               <span style="color: #A0A0A0"> 957</span> <span style="color: #228B22; background: #FFFFFF;">            % Just take equalities as initial working set.</span><br/>               <span style="color: #A0A0A0"> 958</span> <span style="color: #A0A0A0; background: #FFFFFF;">            ACTIND = 1:neqcstr; </span><br/>               <span style="color: #A0A0A0"> 959</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 960</span> <span style="color: #228B22; background: #FFFFFF;">            % Remove dependent inequality constraints.</span><br/>               <span style="color: #A0A0A0"> 961</span> <span style="color: #A0A0A0; background: #FFFFFF;">            ACTIND(removeIneq) = [];</span><br/>               <span style="color: #A0A0A0"> 962</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 963</span> <span style="color: #A0A0A0; background: #FFFFFF;">        aix = zeros(ncstr,1);</span><br/>               <span style="color: #A0A0A0"> 964</span> <span style="color: #A0A0A0; background: #FFFFFF;">        aix(ACTIND) = 1;</span><br/>               <span style="color: #A0A0A0"> 965</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ACTSET = A(ACTIND,:);</span><br/>               <span style="color: #A0A0A0"> 966</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ACTCNT = length(ACTIND);</span><br/>               <span style="color: #A0A0A0"> 967</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end  </span><br/>               <span style="color: #A0A0A0"> 968</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 969</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 970</span> <span style="color: #000000; background: #FFFFFF;">[Q,R]=qr(ACTSET'); </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 971</span> <span style="color: #000000; background: #FFFFFF;">Z = Q(:,ACTCNT+1:numberOfVariables); </span><br/>               <span style="color: #A0A0A0"> 972</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 973</span> <span style="color: #228B22; background: #FFFFFF;">% Disable the warnings about conditioning for singular and</span><br/>               <span style="color: #A0A0A0"> 974</span> <span style="color: #228B22; background: #FFFFFF;">% nearly singular matrices</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 975</span> <span style="color: #000000; background: #FFFFFF;">warningstate1 = warning('off', 'MATLAB:nearlySingularMatrix'); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 976</span> <a name="Line976"></a><span style="color: #000000; background: #FFC6C6;">warningstate2 = warning('off', 'MATLAB:singularMatrix'); </span><br/>               <span style="color: #A0A0A0"> 977</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 978</span> <span style="color: #000000; background: #FFFFFF;">if ~strcmp(how,'infeasible') &amp;&amp; ACTCNT &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 979</span> <span style="color: #228B22; background: #FFFFFF;">    % Find point closest to the given initial X which satisfies</span><br/>               <span style="color: #A0A0A0"> 980</span> <span style="color: #228B22; background: #FFFFFF;">    % working set constraints.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 981</span> <a name="Line981"></a><span style="color: #000000; background: #FFC6C6;">    minnormstep = Q(:,1:ACTCNT) * ... </span><br/>               <span style="color: #A0A0A0"> 982</span> <span style="color: #000000; background: #FFC6C6;">        ((R(1:ACTCNT,1:ACTCNT)') \ (B(ACTIND) - ACTSET*X));</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 983</span> <span style="color: #000000; background: #FFFFFF;">    X = X + minnormstep;  </span><br/>               <span style="color: #A0A0A0"> 984</span> <span style="color: #228B22; background: #FFFFFF;">    % Sometimes the "basic" solution satisfies Aeq*x= Beq </span><br/>               <span style="color: #A0A0A0"> 985</span> <span style="color: #228B22; background: #FFFFFF;">    % and A*X &lt; B better than the minnorm solution. Choose the one</span><br/>               <span style="color: #A0A0A0"> 986</span> <span style="color: #228B22; background: #FFFFFF;">    % that the minimizes the max constraint violation.</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 987</span> <span style="color: #000000; background: #FFFFFF;">    err = A*X - B; </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 988</span> <span style="color: #000000; background: #FFFFFF;">    err(eqix) = abs(err(eqix)); </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 989</span> <span style="color: #000000; background: #FFFFFF;">    if any(err &gt; eps) </span><br/>       <span style="color: #0000FF">     39 </span><span style="color: #000000; font-weight: bold"> 990</span> <span style="color: #000000; background: #FFFFFF;">        Xbasic = ACTSET\B(ACTIND); </span><br/>       <span style="color: #0000FF">     39 </span><span style="color: #000000; font-weight: bold"> 991</span> <span style="color: #000000; background: #FFFFFF;">        errbasic = A*Xbasic - B; </span><br/>       <span style="color: #0000FF">     39 </span><span style="color: #000000; font-weight: bold"> 992</span> <span style="color: #000000; background: #FFFFFF;">        errbasic(eqix) = abs(errbasic(eqix)); </span><br/>       <span style="color: #0000FF">     39 </span><span style="color: #000000; font-weight: bold"> 993</span> <span style="color: #000000; background: #FFFFFF;">        if max(errbasic) &lt; max(err)  </span><br/>       <span style="color: #0000FF">     16 </span><span style="color: #000000; font-weight: bold"> 994</span> <span style="color: #000000; background: #FFFFFF;">            X = Xbasic; </span><br/>       <span style="color: #0000FF">     16 </span><span style="color: #000000; font-weight: bold"> 995</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/>       <span style="color: #0000FF">     39 </span><span style="color: #000000; font-weight: bold"> 996</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold"> 997</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 998</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 999</span> <span style="color: #228B22; background: #FFFFFF;">% Restore the warning states to their original settings</span><br/>       <span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold">1000</span> <span style="color: #000000; background: #FFFFFF;">warning(warningstate1) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     77 </span><span style="color: #000000; font-weight: bold">1001</span> <a name="Line1001"></a><span style="color: #000000; background: #FFC6C6;">warning(warningstate2) </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>