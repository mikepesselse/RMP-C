<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for quadprogbb</title><link rel="stylesheet" href="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">quadprogbb (1 call, 21.753 sec)</span><br/><i>Generated 06-Oct-2011 17:10:37 using cpu time.</i><br/>M-function in file /nfs/dollar/local/vol00/user0/jieqchen/QuadProgBB/quadprogbb.m<br/>Copy to new window for comparing multiple runs<p><span class="warning">This function changed during profiling or before generation of this report. Results may be incomplete or inaccurate.</span></p><div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/> No parent <div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line439">439</a></td><td class="td-linebottomrt"><pre>[newLB,Y,Z,S,SIG,ret] = opt_dn...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">12.429 s</td><td class="td-linebottomrt" class="td-linebottomrt">57.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=57 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line438">438</a></td><td class="td-linebottomrt"><pre>if isfeasible(local_A,local_b,...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">4.294 s</td><td class="td-linebottomrt" class="td-linebottomrt">19.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=20 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line507">507</a></td><td class="td-linebottomrt"><pre>[tmpx,tmpval] = quadprog(H,f,[...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0.975 s</td><td class="td-linebottomrt" class="td-linebottomrt">4.5%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line527">527</a></td><td class="td-linebottomrt"><pre>[tmpx,tmpval] = quadprog(H,f,[...</pre></td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0.932 s</td><td class="td-linebottomrt" class="td-linebottomrt">4.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line286">286</a></td><td class="td-linebottomrt"><pre>[xx,gUB] = quadprog(H,f,[],[],...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.719 s</td><td class="td-linebottomrt" class="td-linebottomrt">3.3%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">2.404 s</td><td class="td-linebottomrt">11.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=11 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">21.753 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file56.html">opt_dnn</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">12.420 s</td><td class="td-linebottomrt">57.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=57 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file21.html">quadprogbb>isfeasible</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">4.286 s</td><td class="td-linebottomrt">19.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=20 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file42.html">quadprog</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">39</td><td class="td-linebottomrt">2.617 s</td><td class="td-linebottomrt">12.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file41.html">quadprogbb>project</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">38</td><td class="td-linebottomrt">0.949 s</td><td class="td-linebottomrt">4.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file27.html">quadprogbb>standardform</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.488 s</td><td class="td-linebottomrt">2.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file29.html">union</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">56</td><td class="td-linebottomrt">0.163 s</td><td class="td-linebottomrt">0.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file20.html">optimset</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">39</td><td class="td-linebottomrt">0.163 s</td><td class="td-linebottomrt">0.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file16.html">cplexoptimset</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.145 s</td><td class="td-linebottomrt">0.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file26.html">cplexlp</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.094 s</td><td class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file55.html">quadprogbb>fixedAb</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">19</td><td class="td-linebottomrt">0.034 s</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file23.html">ismember</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">9</td><td class="td-linebottomrt">0.017 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file61.html">quadprogbb>getsol</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file25.html">setdiff</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">10</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file2.html">quadprogbb>checkinput</a></td><td class="td-linebottomrt">M-subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.359 s</td><td class="td-linebottomrt">1.7%</td><td class="td-linebottomrt"><img src="file:////usr/local/apps/matlab78/toolbox/matlab/codetools/private/one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">21.753 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line232">232</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'nodes_solved' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line250">250</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'n' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line297">297</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'LB_beat' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line325">325</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'k' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line331">331</a></td><td class="td-linebottomrt"><span class="mono">Using ISEMPTY is usually faster than comparing LENGTH to 0.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line583">583</a></td><td class="td-linebottomrt"><span class="mono">Use && instead of & as the AND operator in (scalar) conditional statements.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line585">585</a></td><td class="td-linebottomrt"><span class="mono">IF might not be aligned with its matching END (line 648).</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line592">592</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line593">593</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line594">594</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line613">613</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line614">614</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line615">615</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line622">622</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line623">623</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line624">624</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line635">635</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line636">636</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line637">637</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line644">644</a></td><td class="td-linebottomrt"><span class="mono">The variable 'LBLB' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line645">645</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SS' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line646">646</a></td><td class="td-linebottomrt"><span class="mono">The variable 'SIGSIG' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">705</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">342</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">363</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">207</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">156</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">57.02 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [x,fval,time,stat] = quadprogbb(H,f,A,b,Aeq,beq,LB,UB,cons,options)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%% [x,fval,time,stat] = quadprogbb(H,f,A,b,Aeq,beq,LB,UB,cons,options)</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">% QUADPROGBB globally solves nonconvex quadratic programming problem</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%    min      1/2*x'*H*x + f'*x + cons</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%    s.t.       A * x &lt;= b</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%             Aeq * x == beq</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%             LB &lt;= x &lt;= UB</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">% Syntax:</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">% x = quadprogbb(H,f)</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">% x = quadprogbb(H,f,A,b)</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">% x = quadprogbb(H,f,A,b,Aeq,beq)</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">% x = quadprogbb(H,f,A,b,Aeq,beq,LB,UB)</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">% x = quadprogbb(H,f,A,b,Aeq,beq,LB,UB,cons)</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">% x = quadprogbb(H,f,A,b,Aeq,beq,LB,UB,cons,options)</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">% [x,fval] = quadprogbb(H,f,...)</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">% [x,fval,time] = quadprogbb(H,f,...)</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">% [x,fval,time,stat] = quadprogbb(H,f,...)</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">% Input arguments:</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">% * H,f,A,b,Aeq,beq,LB,UB: similar to the corresponding input arguments</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%   of MATLAB's 'quadprog' function; also see the QP formulation above</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">% * cons: a constant in the objective</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">% * options: a structure array with the following fields, with default </span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%   fields in Parentheses:</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%   1)max_time (86400): the maximum amount of time the branch-and-bound</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%     algorithm is allowed to run, in seconds</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%   2)max_iter (1000): the maximum number of iterations for the algorithm </span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%     that solves the SDP relaxation</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%   3)fathom_tol (1e-6): a node witha lower bound vlb is fathomed if </span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%    (GUB - vlb)/max(GUB,1) &lt; fathom_tol</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%   4)use_quadprog (1): method used to obtain GUB. If use_quadprog is 1,</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%     MATLAB's quadprog is used to obtain GUB; otherwise, a feasible</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%     solution extracted from the SDP relaxation is used to calculate GUB</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%   5)verbosity (1): has the following different display levels</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%       0 : only display the final results</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%       1 : display status for each node </span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%       2 : display progress of solving each node, every 100 iterations</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%       &gt;2 : display progress of solving each node, every 25 iterations</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%   6)tol (1e-8): numeric tolerance. When |LB(i) - UB(i)| &lt; tol, we treat</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%     LB(i) as equal to UB(i), that is, x(i) is fixed.</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">% Output arguments:</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">% * x,fval: the solution and objective value of the QP; check stat.status</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%   for the status of the solution, i.e., whether it is optimal</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">% * time: time used by the branch-and-bound algorithm, in seconds</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">% * stat: a struct with more statistics of the algorithm:</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%   1)time_pre: time spent on preprocessing</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%   2)time_LP:  time spent on calculating bounds in preprocessing</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%   3)time_BB:  time spent on branch-and-bound</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%   4)nodes: total number of nodes solved</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%   5)status: final status of the solution</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%     'optimal_solution': optimal solution found</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%     'time_limit_exceeded' : time limit specified by options.max_time is </span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%     excedeeded</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%     'infeasible_or_unbounded' : the problem is infeasible or unbounded</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%     'numerical_issues_of_optdnn': if a large pencentage (&gt;30%) of the </span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%     nodes encountered numerical issues, then this status is returned</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">% Third party software: CPLEX, used as LP solvers</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">% References:</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%  * Samuel Burer. "Optimizing a polyhedral-semidefinite relaxation of completely positive </span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">%  programs." Mathematical Programming Computation, 2(1):1-19, 2010.</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">%  * Jieqiu Chen, Samuel Burer. "Globally solving nonconvex quadratic programming problems </span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%  via completely positive programming." Preprint ANL/MCS-P1837-0211.</span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">% </span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  72</span> <span style="color: #000000; background: #FFFFFF;">tic; </span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">%% ========================</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">%% handle missing arguments</span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;">%% ========================</span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">% set default options</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  80</span> <span style="color: #000000; background: #FFFFFF;">defaultopt = struct('max_time',86400,'tol',1e-8,'fathom_tol',1e-6,'max_iter',1000,'use_quadprog',1,'verbosity',1); </span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  82</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 2  </span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('Usage: \n');</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('[fval,x,time,stat] = quadprogbb(H,f,A,b,Aeq,beq,LB,UB)\n');</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #A0A0A0; background: #FFFFFF;">  if nargin &gt; 0</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #A0A0A0; background: #FFFFFF;">     error('quadprogBB requires at least 2 input arguments.');</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #A0A0A0; background: #FFFFFF;">   x = []; fval = []; time = 0;</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #A0A0A0; background: #FFFFFF;">   stat.status = []; </span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #A0A0A0; background: #FFFFFF;">  return</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  93</span> <span style="color: #000000; background: #FFFFFF;">[n1,n2] = size(H); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  94</span> <span style="color: #000000; background: #FFFFFF;">if n1 ~= n2 </span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #A0A0A0; background: #FFFFFF;">  error('H must be a square matrix!');</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  98</span> <span style="color: #000000; background: #FFFFFF;">H = .5*(H + H'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #000000; background: #FFFFFF;">n = size(f,1); </span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 101</span> <span style="color: #000000; background: #FFFFFF;">if n ~= n1 </span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #A0A0A0; background: #FFFFFF;">  error('Dimensions of H and f are not consistent!');</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 10 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">  options = defaultopt; </span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #A0A0A0; background: #FFFFFF;">  if isstruct(options)</span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isfield(options,'max_time')</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #A0A0A0; background: #FFFFFF;">      options.max_time = defaultopt.max_time;</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isfield(options,'tol')</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #A0A0A0; background: #FFFFFF;">      options.tol = defaultopt.tol;</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isfield(options,'fathom_tol')</span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #A0A0A0; background: #FFFFFF;">      options.fathom_tol = defaultopt.fathom_tol;</span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isfield(options,'max_iter')</span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #A0A0A0; background: #FFFFFF;">      options.max_iter = defaultopt.max_iter;</span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isfield(options,'use_quadprog')</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF;">      options.use_quadprog = defaultopt.use_quadprog;</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isfield(options,'verbosity')</span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #A0A0A0; background: #FFFFFF;">      options.verbosity = 1;</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;">  else</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf('The input argument options is not a struct!\n');</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf('Overided it with default options\n\n');</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #A0A0A0; background: #FFFFFF;">    options = defaultopt;</span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 135</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 9 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF;">  cons = 0; </span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF;">  if isempty(cons)</span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #A0A0A0; background: #FFFFFF;">    cons = 0;</span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 143</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 8 </span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF;">  UB = ones(n,1);</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 147</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 7 </span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #A0A0A0; background: #FFFFFF;">  LB = zeros(n,1);</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 6 </span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #A0A0A0; background: #FFFFFF;">  beq = [];</span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF;">  if nargin &lt; 5</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #A0A0A0; background: #FFFFFF;">    Aeq = [];</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;">  else</span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isempty(Aeq)</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #A0A0A0; background: #FFFFFF;">      error('Dimensions of Aeq and beq are not consistent!');</span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 162</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 4 </span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #A0A0A0; background: #FFFFFF;">  b = [];</span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #A0A0A0; background: #FFFFFF;">  if nargin &lt; 3</span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #A0A0A0; background: #FFFFFF;">    A = [];</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #228B22; background: #FFFFFF;">  else</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ~isempty(A)</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #A0A0A0; background: #FFFFFF;">      error('Dimensions of A and b are not consistent!');</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">% Check inputs for simple errors</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 174</span> <span style="color: #000000; background: #FFFFFF;"><a href="file2.html">checkinput</a>(H,f,A,b,Aeq,beq,LB,UB); </span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;">%% ======================================================</span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;">%  Initialize the struct for statistics:</span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;">%  time_pre: time spent on preprocessing</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">%  time_LP:  time spent on calculating bounds in preprocessing</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #228B22; background: #FFFFFF;">%  time_BB:  time spent on B&amp;B</span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #228B22; background: #FFFFFF;">%  nodes: total nodes_solved</span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #228B22; background: #FFFFFF;">%  status: 0) solution found; 1) infeasible; 2) max_time exceeded</span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #228B22; background: #FFFFFF;">%%  ======================================================</span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 186</span> <span style="color: #000000; background: #FFFFFF;">stat = struct('time_pre',0,'time_LP',0,'time_BB',0,'nodes',0,'status',[]); </span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;">%% check feasibility </span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 191</span> <span style="color: #000000; background: #FFFFFF;">if (~isempty(A)) || (~isempty(Aeq)) </span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/><span style="color: #FF0000">  0.15 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 193</span> <span style="color: #000000; background: #FFFFFF;">  cplexopts = <a href="file16.html">cplexoptimset</a>('Display','off'); </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 194</span> <span style="color: #000000; background: #FFFFFF;">  [x,fval,exitflag,output] = <a href="file26.html">cplexlp</a>(zeros(n,1),A,b,Aeq,beq,LB,UB,[],cplexopts); </span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 196</span> <span style="color: #000000; background: #FFFFFF;">  if output.cplexstatus &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf('\n\nFail assumption check:\n\n');</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #A0A0A0; background: #FFFFFF;">    fprintf('CPLEX status of solving the feasibility problem: %s', output.cplexstatusstring);</span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">    x = []; fval = []; time = 0;</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF;">    stat.status = 'infeasible_or_unbounded';</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #A0A0A0; background: #FFFFFF;">    return</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #A0A0A0; background: #FFFFFF;">  end</span><br/>               <span style="color: #A0A0A0"> 205</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #228B22; background: #FFFFFF;">%% =========================================</span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF;">%% Turn problem into standard form</span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #228B22; background: #FFFFFF;">%%</span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF;">%%   min   0.5*x'*H*x + f'*x</span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;">%%   s.t.  A*x = b, x &gt;= 0</span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #228B22; background: #FFFFFF;">%%         [x*x']_E == 0</span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #228B22; background: #FFFFFF;">%% Bounds x &lt;= 1 are valid</span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #228B22; background: #FFFFFF;">%% =========================================</span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.49 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 217</span> <span style="color: #000000; background: #FFFFFF;">[H,f,A,b,E,cons,L,U,sstruct,timeLP] = <a href="file27.html">standardform</a>(H,f,A,b,Aeq,beq,LB,UB,cons,options.tol); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 218</span> <span style="color: #000000; background: #FFFFFF;">save standard H f A b E cons L U </span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF;">if options.verbosity &gt; 1 </span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('\n****  Pre-Processing is complete, time = %.2f  ****\n',toc);</span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 223</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF;">stat.time_pre = toc; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 225</span> <span style="color: #000000; background: #FFFFFF;">stat.time_LP = timeLP; </span><br/>               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 228</span> <span style="color: #000000; background: #FFFFFF;">if sstruct.flag </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fval = sstruct.obj;</span><br/>               <span style="color: #A0A0A0"> 230</span> <span style="color: #A0A0A0; background: #FFFFFF;">  x = getsol([],sstruct);</span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #A0A0A0; background: #FFFFFF;">  time = toc;</span><br/><a name="Line232"></a>               <span style="color: #A0A0A0"> 232</span> <span style="color: #A0A0A0; background: #FFFFFF;">  nodes_solved = 0;</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('\n');</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('=========================== Node 0 ============================\n\n');</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 1: optimal value = %.8e\n', fval);</span><br/>               <span style="color: #A0A0A0"> 236</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 2: (created,solved,pruned,infeas,left) = (%d,%d,%d,%d,%d)\n', ...</span><br/>               <span style="color: #A0A0A0"> 237</span> <span style="color: #A0A0A0; background: #FFFFFF;">      0,0,0,0,0);</span><br/>               <span style="color: #A0A0A0"> 238</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 3: solved = fully + fathomed + poorly : %d = %d + %d + %d\n', ...</span><br/>               <span style="color: #A0A0A0"> 239</span> <span style="color: #A0A0A0; background: #FFFFFF;">      0,0,0,0);</span><br/>               <span style="color: #A0A0A0"> 240</span> <span style="color: #A0A0A0; background: #FFFFFF;">  fprintf('FINAL STATUS 4: time = %d\n', time);</span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #A0A0A0; background: #FFFFFF;">  stat.status = 'optimal_solution';</span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #A0A0A0; background: #FFFFFF;">  return</span><br/>               <span style="color: #A0A0A0"> 243</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 244</span> <span style="color: #228B22; background: #FFFFFF;"> </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">cmp1 = sstruct.cmp1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 246</span> <span style="color: #000000; background: #FFFFFF;">cmp2 = sstruct.cmp2; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 247</span> <span style="color: #000000; background: #FFFFFF;">lenB = sstruct.lenB; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 248</span> <span style="color: #000000; background: #FFFFFF;">lenL = sstruct.lenL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 249</span> <span style="color: #000000; background: #FFFFFF;">m = sstruct.m; </span><br/><a name="Line250"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 250</span> <span style="color: #000000; background: #FFFFFF;">n = sstruct.n; </span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 252</span> <span style="color: #000000; background: #FFFFFF;">m0 = length(cmp1); </span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 254</span> <span style="color: #000000; background: #FFFFFF;">Fx = find(abs(L(cmp1)-U(cmp1))&lt;options.tol &amp; abs(L(cmp1)-0)&lt;options.tol); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 255</span> <span style="color: #000000; background: #FFFFFF;">Fz = find(abs(L(cmp2)-U(cmp2))&lt;options.tol &amp; abs(L(cmp2)-0)&lt;options.tol); </span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #228B22; background: #FFFFFF;">%% Setup constants for passage into opt_dnn subroutine</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #228B22; background: #FFFFFF;">%% Constant n saved above</span><br/>               <span style="color: #A0A0A0"> 260</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF;">bign = size(A,2); </span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;">%% Assign fixed values to lower and upper bounds</span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 265</span> <span style="color: #000000; background: #FFFFFF;">L_save = L; % Subproblems will only differ in L and U </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 266</span> <span style="color: #000000; background: #FFFFFF;">U_save = U; </span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 268</span> <span style="color: #000000; background: #FFFFFF;">B = []; </span><br/>               <span style="color: #A0A0A0"> 269</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------</span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;">%% Initialize B&amp;B structures</span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF;">%% -------------------------</span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 274</span> <span style="color: #000000; background: #FFFFFF;">LBLB = -Inf; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF;">FxFx{1} = Fx; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 276</span> <span style="color: #000000; background: #FFFFFF;">FzFz{1} = Fz; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 277</span> <span style="color: #000000; background: #FFFFFF;">SS = zeros((1+bign)^2,1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 278</span> <span style="color: #000000; background: #FFFFFF;">SIGSIG = -1; % Signal that we want default sig in aug Lag algorithm </span><br/>               <span style="color: #A0A0A0"> 279</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #228B22; background: #FFFFFF;">%% Calculate first global upper bound and associated fathoming target</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 284</span> <span style="color: #000000; background: #FFFFFF;">if options.use_quadprog </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 285</span> <span style="color: #000000; background: #FFFFFF;">  quadopts = <a href="file20.html">optimset</a>('LargeScale','off','Display','off'); </span><br/><span style="color: #FF0000">  0.72 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 286</span> <a name="Line286"></a><span style="color: #000000; background: #FFFFFF;">  [xx,gUB] = <a href="file42.html">quadprog</a>(H,f,[],[],A,b,L_save,U_save,[],quadopts); </span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #A0A0A0; background: #FFFFFF;">  xx = [];</span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #A0A0A0; background: #FFFFFF;">  gUB = Inf;</span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 292</span> <span style="color: #000000; background: #FFFFFF;">if gUB == Inf </span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #A0A0A0; background: #FFFFFF;">  LB_target = Inf;</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 294</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 295</span> <span style="color: #000000; background: #FFFFFF;">  LB_target = gUB - options.fathom_tol*max(1,abs(gUB)); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 296</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/><a name="Line297"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 297</span> <span style="color: #000000; background: #FFFFFF;">LB_beat = -Inf; </span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 300</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #228B22; background: #FFFFFF;">%% Begin BRANCH-AND-BOUND</span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #228B22; background: #FFFFFF;">%% ----------------------</span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 305</span> <span style="color: #000000; background: #FFFFFF;">nodes_created         = 1; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 306</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved          = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 307</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved_fully    = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 308</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved_fathomed = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 309</span> <span style="color: #000000; background: #FFFFFF;">nodes_solved_poorly   = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 310</span> <span style="color: #000000; background: #FFFFFF;">nodes_infeasible      = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF;">nodes_pruned          = 0; </span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #228B22; background: #FFFFFF;">%% While there are still nodes in the tree...</span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #228B22; background: #FFFFFF;">%% ------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF;">%% Store fixed components index to prevent these variables's bounds from</span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #228B22; background: #FFFFFF;">%% changing</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 319</span> <span style="color: #000000; background: #FFFFFF;">Fx0 = Fx; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 320</span> <span style="color: #000000; background: #FFFFFF;">Fz0 = Fz; </span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 322</span> <span style="color: #000000; background: #FFFFFF;">t0 = m+lenL; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 323</span> <span style="color: #000000; background: #FFFFFF;">t1 = m+lenL+lenB; </span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line325"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 325</span> <span style="color: #000000; background: #FFFFFF;">k = 0; </span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 327</span> <span style="color: #000000; background: #FFFFFF;">if options.verbosity &gt;=1 </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 328</span> <span style="color: #000000; background: #FFFFFF;">  fprintf('\n=============================== Initial Status =================================\n'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 329</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line331"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 331</span> <span style="color: #000000; background: #FFFFFF;">while length(LBLB) &gt; 0 </span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------</span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #228B22; background: #FFFFFF;">    %% Print status</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 337</span> <span style="color: #000000; background: #FFFFFF;">    if options.verbosity &gt;= 1 </span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 339</span> <span style="color: #000000; background: #FFFFFF;">      fprintf('\n'); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 340</span> <span style="color: #000000; background: #FFFFFF;">      fprintf('STATUS 1: (gUB,gLB,gap) = (%.8e, %.8e, %.3f%%)\n', ... </span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #000000; background: #FFFFFF;">          gUB+cons, min(LBLB)+cons, 100*(gUB - min(LBLB))/max([1,abs(gUB+cons)]));</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 342</span> <span style="color: #000000; background: #FFFFFF;">      fprintf('STATUS 2: (created,solved,pruned,infeas,left) = (%d,%d,%d,%d,%d)\n', ... </span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #000000; background: #FFFFFF;">          nodes_created, nodes_solved, nodes_pruned, nodes_infeasible, length(LBLB));</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 344</span> <span style="color: #000000; background: #FFFFFF;">      fprintf('STATUS 3: solved = fully + fathomed + poorly : %d = %d + %d + %d\n', ... </span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #000000; background: #FFFFFF;">          nodes_solved, nodes_solved_fully, nodes_solved_fathomed, nodes_solved_poorly);</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 346</span> <span style="color: #000000; background: #FFFFFF;">      fprintf('STATUS 4: time = %d\n', toc); </span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 348</span> <span style="color: #000000; background: #FFFFFF;">      fprintf('\n\n==================================== Node %d =====================================\n',nodes_solved+1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 349</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 350</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------------</span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #228B22; background: #FFFFFF;">    %% Terminate if too much time has passed</span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------------</span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 355</span> <span style="color: #000000; background: #FFFFFF;">    if toc &gt; options.max_time </span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #A0A0A0; background: #FFFFFF;">      stat.status = 'time_limit_exceeded';</span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #A0A0A0; background: #FFFFFF;">      break;</span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #228B22; background: #FFFFFF;">    %% Sort nodes for 'best-bound' node-selection rule</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 364</span> <span style="color: #000000; background: #FFFFFF;">    [LBLB,I] = sort(LBLB,2,'descend'); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 365</span> <span style="color: #000000; background: #FFFFFF;">    FxFx = FxFx(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 366</span> <span style="color: #000000; background: #FFFFFF;">    FzFz = FzFz(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 367</span> <span style="color: #000000; background: #FFFFFF;">    SS = SS(:,I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 368</span> <span style="color: #000000; background: #FFFFFF;">    SIGSIG = SIGSIG(I); </span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #228B22; background: #FFFFFF;">    %% Pull last problem off the problem list (best-bound)</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 374</span> <span style="color: #000000; background: #FFFFFF;">    LB = LBLB(end); </span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 376</span> <span style="color: #000000; background: #FFFFFF;">    Fx = FxFx(end); Fx = Fx{1}; </span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 377</span> <span style="color: #000000; background: #FFFFFF;">    Fz = FzFz(end); Fz = Fz{1}; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 378</span> <span style="color: #000000; background: #FFFFFF;">    S = reshape(SS(:,end), 1+bign, 1+bign); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 379</span> <span style="color: #000000; background: #FFFFFF;">    SIG = SIGSIG(end); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 380</span> <span style="color: #000000; background: #FFFFFF;">    if SIG &lt; 0.0 % Signal that we want default sig in aug Lag algorithm </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 381</span> <span style="color: #000000; background: #FFFFFF;">        SIG = []; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 382</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------</span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF;">    %% Delete that problem from the tree</span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------------</span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 388</span> <span style="color: #000000; background: #FFFFFF;">    LBLB = LBLB(1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 389</span> <span style="color: #000000; background: #FFFFFF;">    FxFx = FxFx(1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 390</span> <span style="color: #000000; background: #FFFFFF;">    FzFz = FzFz(1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 391</span> <span style="color: #000000; background: #FFFFFF;">    SS = SS(:,1:end-1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 392</span> <span style="color: #000000; background: #FFFFFF;">    SIGSIG = SIGSIG(1:end-1); </span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------------</span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #228B22; background: #FFFFFF;">    %% Handle single node</span><br/>               <span style="color: #A0A0A0"> 396</span> <span style="color: #228B22; background: #FFFFFF;">    %% ------------------</span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #228B22; background: #FFFFFF;">    %% ----------------------------</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #228B22; background: #FFFFFF;">    %% Prepare problem to be solved</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #228B22; background: #FFFFFF;">    %% ----------------------------</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 402</span> <span style="color: #000000; background: #FFFFFF;">    L = L_save; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 403</span> <span style="color: #000000; background: #FFFFFF;">    U = U_save; </span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #228B22; background: #FFFFFF;">    %%------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 406</span> <span style="color: #228B22; background: #FFFFFF;">    %% Prepare L and U for new structure of vars</span><br/>               <span style="color: #A0A0A0"> 407</span> <span style="color: #228B22; background: #FFFFFF;">    %%------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #228B22; background: #FFFFFF;">    %% X(Fx) = 0, X(Fz) = 0</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 410</span> <span style="color: #000000; background: #FFFFFF;">    set1 = cmp1(Fx); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 411</span> <span style="color: #000000; background: #FFFFFF;">    set2 = cmp2(Fz); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 412</span> <span style="color: #000000; background: #FFFFFF;">    U(set1) = 0;     % set the components to be zero </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 413</span> <span style="color: #000000; background: #FFFFFF;">    U(set2) = 0;     % set the lambda components to be zero </span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #228B22; background: #FFFFFF;">    %% Setup LB_beat</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 417</span> <span style="color: #000000; background: #FFFFFF;">    if LB == -Inf </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 418</span> <span style="color: #000000; background: #FFFFFF;">      LB_beat = -Inf; </span><br/>       <span style="color: #0000FF">     18 </span><span style="color: #000000; font-weight: bold"> 419</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/>       <span style="color: #0000FF">     18 </span><span style="color: #000000; font-weight: bold"> 420</span> <span style="color: #000000; background: #FFFFFF;">      LB_beat = LB - options.fathom_tol*max(1,abs(LB)); </span><br/>       <span style="color: #0000FF">     18 </span><span style="color: #000000; font-weight: bold"> 421</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #228B22; background: #FFFFFF;">    %% Sam: Need to use U-L to find fixed variables. Add same</span><br/>               <span style="color: #A0A0A0"> 424</span> <span style="color: #228B22; background: #FFFFFF;">    %% fixings to Ax=b. If variable is fixed to 0, can zero</span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #228B22; background: #FFFFFF;">    %% out other entries in same column of A.</span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 428</span> <span style="color: #000000; background: #FFFFFF;">    [local_A,local_b] = <a href="file55.html">fixedAb</a>(A,b,L,U); </span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #228B22; background: #FFFFFF;">    %% Solve doubly nonnegative relaxation</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #228B22; background: #FFFFFF;">    %% -----------------------------------</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 434</span> <span style="color: #228B22; background: #FFFFFF;">%    if options.verbosity &gt; 2 </span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #228B22; background: #FFFFFF;">%      Fx, Fz</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #228B22; background: #FFFFFF;">%    end</span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  4.29 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 438</span> <a name="Line438"></a><span style="color: #000000; background: #FFD4D4;">    if <a href="file21.html">isfeasible</a>(local_A,local_b,L,U) </span><br/><span style="color: #FF0000"> 12.43 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 439</span> <a name="Line439"></a><span style="color: #000000; background: #FF8080;">      [newLB,Y,Z,S,SIG,ret] = <a href="file56.html">opt_dnn</a>(H,f,local_A,local_b,B,E,L,U,options.max_iter,S,SIG,LB_target,LB_beat,options.max_time-toc,cons,options.verbosity); </span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 441</span> <span style="color: #A0A0A0; background: #FFFFFF;">      ret = 'infeas';</span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 444</span> <span style="color: #000000; background: #FFFFFF;">    if ~strcmp(ret,'infeas') </span><br/>               <span style="color: #A0A0A0"> 445</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #228B22; background: #FFFFFF;">      %% Post-process</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------</span><br/>               <span style="color: #A0A0A0"> 449</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 450</span> <span style="color: #228B22; background: #FFFFFF;">      %% If newLB &lt; LB, then it means that the subproblem did not solve</span><br/>               <span style="color: #A0A0A0"> 451</span> <span style="color: #228B22; background: #FFFFFF;">      %% well because theoretically, newLB &gt;= LB at optimality. So we take</span><br/>               <span style="color: #A0A0A0"> 452</span> <span style="color: #228B22; background: #FFFFFF;">      %% this as a sign that sig needs to be reset. So we set SIG = -1 to</span><br/>               <span style="color: #A0A0A0"> 453</span> <span style="color: #228B22; background: #FFFFFF;">      %% signal that we want sig reset for the children.</span><br/>               <span style="color: #A0A0A0"> 454</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 455</span> <span style="color: #228B22; background: #FFFFFF;">      %% Otherwise, we update LB and save SIG for any children.</span><br/>               <span style="color: #A0A0A0"> 456</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 457</span> <span style="color: #000000; background: #FFFFFF;">      if strcmp(ret,'poor') </span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">        SIG = -1.0;</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF;">        S = zeros(size(S,1));</span><br/>               <span style="color: #A0A0A0"> 460</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 461</span> <span style="color: #000000; background: #FFFFFF;">      if newLB &gt;= LB </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 462</span> <span style="color: #000000; background: #FFFFFF;">        LB = newLB; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 463</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 464</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 465</span> <span style="color: #000000; background: #FFFFFF;">      nodes_solved = nodes_solved + 1; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 466</span> <span style="color: #000000; background: #FFFFFF;">      if strcmp(ret,'fathom') </span><br/>       <span style="color: #0000FF">     10 </span><span style="color: #000000; font-weight: bold"> 467</span> <span style="color: #000000; background: #FFFFFF;">        nodes_solved_fathomed = nodes_solved_fathomed + 1; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 468</span> <span style="color: #000000; background: #FFFFFF;">      elseif strcmp(ret,'poor') </span><br/>               <span style="color: #A0A0A0"> 469</span> <span style="color: #A0A0A0; background: #FFFFFF;">        nodes_solved_poorly = nodes_solved_poorly + 1;</span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 470</span> <span style="color: #228B22; background: #FFFFFF;">      else  </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 471</span> <span style="color: #000000; background: #FFFFFF;">        nodes_solved_fully = nodes_solved_fully + 1; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 472</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 473</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 474</span> <span style="color: #228B22; background: #FFFFFF;">      %% Save multiplier</span><br/>               <span style="color: #A0A0A0"> 475</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 476</span> <span style="color: #000000; background: #FFFFFF;">      S = reshape(S, (1+bign)^2, 1); </span><br/>               <span style="color: #A0A0A0"> 477</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 478</span> <span style="color: #228B22; background: #FFFFFF;">      %% Extract upper bound (4-part primal heuristic)</span><br/>               <span style="color: #A0A0A0"> 479</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 480</span> <span style="color: #228B22; background: #FFFFFF;">      %% First extract 0-th column of Y and project it onto Ax=b,x&gt;=0</span><br/>               <span style="color: #A0A0A0"> 481</span> <span style="color: #228B22; background: #FFFFFF;">      %% using CPLEX. Get value and update gUB if necessary.</span><br/>               <span style="color: #A0A0A0"> 482</span> <span style="color: #228B22; background: #FFFFFF;">      %% </span><br/>               <span style="color: #A0A0A0"> 483</span> <span style="color: #228B22; background: #FFFFFF;">      %% Then run quadprog() from this point (if desired).</span><br/>               <span style="color: #A0A0A0"> 484</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 485</span> <span style="color: #228B22; background: #FFFFFF;">      %% Next extract 0-th column of Z and project it onto Ax=b,x&gt;=0 using</span><br/>               <span style="color: #A0A0A0"> 486</span> <span style="color: #228B22; background: #FFFFFF;">      %% CPLEX. Get value and update gUB if necessary.</span><br/>               <span style="color: #A0A0A0"> 487</span> <span style="color: #228B22; background: #FFFFFF;">      %% </span><br/>               <span style="color: #A0A0A0"> 488</span> <span style="color: #228B22; background: #FFFFFF;">      %% Then run quadprog() from this point (if desired).</span><br/>               <span style="color: #A0A0A0"> 489</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 490</span> <span style="color: #228B22; background: #FFFFFF;">      %% We presume that CPLEX can return as good a feasible solution as</span><br/>               <span style="color: #A0A0A0"> 491</span> <span style="color: #228B22; background: #FFFFFF;">      %% any algorithm. (We do not check anything at the moment. Is this</span><br/>               <span style="color: #A0A0A0"> 492</span> <span style="color: #228B22; background: #FFFFFF;">      %% safe?)</span><br/>               <span style="color: #A0A0A0"> 493</span> <span style="color: #228B22; background: #FFFFFF;">      %%</span><br/>               <span style="color: #A0A0A0"> 494</span> <span style="color: #228B22; background: #FFFFFF;">      %% Right now, we use projected version of 0-th col of Z for</span><br/>               <span style="color: #A0A0A0"> 495</span> <span style="color: #228B22; background: #FFFFFF;">      %% branching. Is this a good choice?</span><br/>               <span style="color: #A0A0A0"> 496</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 497</span> <span style="color: #000000; background: #FFFFFF;">      x0 = Y(2:bign+1,1); </span><br/><span style="color: #FF0000">  0.47 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 498</span> <span style="color: #000000; background: #FFFFFF;">      x0 = <a href="file41.html">project</a>(x0,local_A,local_b,L,U); %% In CPLEX we trust!  </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 499</span> <span style="color: #000000; background: #FFFFFF;">      x0val = 0.5*x0'*H*x0 + f'*x0; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 500</span> <span style="color: #000000; background: #FFFFFF;">      if x0val &lt; gUB % x0 is best so far </span><br/>               <span style="color: #A0A0A0"> 501</span> <span style="color: #A0A0A0; background: #FFFFFF;">        gUB = x0val;</span><br/>               <span style="color: #A0A0A0"> 502</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xx = x0;</span><br/>               <span style="color: #A0A0A0"> 503</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>               <span style="color: #A0A0A0"> 504</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 505</span> <span style="color: #000000; background: #FFFFFF;">      if options.use_quadprog </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 506</span> <span style="color: #000000; background: #FFFFFF;">        quadopts = <a href="file20.html">optimset</a>('LargeScale','off','Display','off'); </span><br/><span style="color: #FF0000">  0.98 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 507</span> <a name="Line507"></a><span style="color: #000000; background: #FFFFFF;">        [tmpx,tmpval] = <a href="file42.html">quadprog</a>(H,f,[],[],A,b,L_save,U_save,x0,quadopts); </span><br/>               <span style="color: #A0A0A0"> 508</span> <span style="color: #228B22; background: #FFFFFF;">      else</span><br/>               <span style="color: #A0A0A0"> 509</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpx = [];</span><br/>               <span style="color: #A0A0A0"> 510</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpval = Inf;</span><br/>               <span style="color: #A0A0A0"> 511</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 512</span> <span style="color: #000000; background: #FFFFFF;">      if tmpval &lt; gUB </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 513</span> <span style="color: #000000; background: #FFFFFF;">        gUB = tmpval; </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 514</span> <span style="color: #000000; background: #FFFFFF;">        xx = tmpx; </span><br/>       <span style="color: #0000FF">      3 </span><span style="color: #000000; font-weight: bold"> 515</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 516</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 517</span> <span style="color: #000000; background: #FFFFFF;">      x0 = Z(2:bign+1,1)/Z(1,1); </span><br/><span style="color: #FF0000">  0.48 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 518</span> <span style="color: #000000; background: #FFFFFF;">      x0 = <a href="file41.html">project</a>(x0,local_A,local_b,L,U); %% In CPLEX we trust!  </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 519</span> <span style="color: #000000; background: #FFFFFF;">      x0val = 0.5*x0'*H*x0 + f'*x0; </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 520</span> <span style="color: #000000; background: #FFFFFF;">      if x0val &lt; gUB % x0 is better than what <a href="file42.html">quadprog</a> found </span><br/>               <span style="color: #A0A0A0"> 521</span> <span style="color: #A0A0A0; background: #FFFFFF;">        gUB = x0val;</span><br/>               <span style="color: #A0A0A0"> 522</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xx = x0;</span><br/>               <span style="color: #A0A0A0"> 523</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>               <span style="color: #A0A0A0"> 524</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 525</span> <span style="color: #000000; background: #FFFFFF;">      if options.use_quadprog </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 526</span> <span style="color: #000000; background: #FFFFFF;">        quadopts = <a href="file20.html">optimset</a>('LargeScale','off','Display','off'); </span><br/><span style="color: #FF0000">  0.93 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 527</span> <a name="Line527"></a><span style="color: #000000; background: #FFFFFF;">        [tmpx,tmpval] = <a href="file42.html">quadprog</a>(H,f,[],[],A,b,L_save,U_save,x0,quadopts); </span><br/>               <span style="color: #A0A0A0"> 528</span> <span style="color: #228B22; background: #FFFFFF;">      else</span><br/>               <span style="color: #A0A0A0"> 529</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpx = [];</span><br/>               <span style="color: #A0A0A0"> 530</span> <span style="color: #A0A0A0; background: #FFFFFF;">        tmpval = Inf;</span><br/>               <span style="color: #A0A0A0"> 531</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 532</span> <span style="color: #000000; background: #FFFFFF;">      if tmpval &lt; gUB </span><br/>               <span style="color: #A0A0A0"> 533</span> <span style="color: #A0A0A0; background: #FFFFFF;">        gUB = tmpval;</span><br/>               <span style="color: #A0A0A0"> 534</span> <span style="color: #A0A0A0; background: #FFFFFF;">        xx = tmpx;</span><br/>               <span style="color: #A0A0A0"> 535</span> <span style="color: #A0A0A0; background: #FFFFFF;">      end</span><br/>               <span style="color: #A0A0A0"> 536</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 537</span> <span style="color: #228B22; background: #FFFFFF;">      %% Update fathoming target</span><br/>               <span style="color: #A0A0A0"> 538</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 539</span> <span style="color: #000000; background: #FFFFFF;">      if gUB == Inf </span><br/>               <span style="color: #A0A0A0"> 540</span> <span style="color: #A0A0A0; background: #FFFFFF;">        LB_target = Inf;</span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 541</span> <span style="color: #228B22; background: #FFFFFF;">      else </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 542</span> <span style="color: #000000; background: #FFFFFF;">        LB_target = gUB - options.fathom_tol*max(1,abs(gUB)); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 543</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 544</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 545</span> <span style="color: #228B22; background: #FFFFFF;">      %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 546</span> <span style="color: #228B22; background: #FFFFFF;">      %% Prune tree by gUB</span><br/>               <span style="color: #A0A0A0"> 547</span> <span style="color: #228B22; background: #FFFFFF;">      %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 548</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 549</span> <span style="color: #000000; background: #FFFFFF;">      tmpsz = length(LBLB); </span><br/>               <span style="color: #A0A0A0"> 550</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 551</span> <span style="color: #000000; background: #FFFFFF;">      I = find(LBLB &lt; LB_target); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 552</span> <span style="color: #000000; background: #FFFFFF;">      LBLB = LBLB(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 553</span> <span style="color: #000000; background: #FFFFFF;">      FxFx = FxFx(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 554</span> <span style="color: #000000; background: #FFFFFF;">      FzFz = FzFz(I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 555</span> <span style="color: #000000; background: #FFFFFF;">      SS = SS(:,I); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 556</span> <span style="color: #000000; background: #FFFFFF;">      SIGSIG = SIGSIG(I); </span><br/>               <span style="color: #A0A0A0"> 557</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 558</span> <span style="color: #000000; background: #FFFFFF;">      nodes_pruned = nodes_pruned + (tmpsz - length(LBLB)); </span><br/>               <span style="color: #A0A0A0"> 559</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 560</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 561</span> <span style="color: #228B22; background: #FFFFFF;">      %% Select index to branch on (but will only branch if LB &lt; LB_target)</span><br/>               <span style="color: #A0A0A0"> 562</span> <span style="color: #228B22; background: #FFFFFF;">      %% ------------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 563</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 564</span> <span style="color: #000000; background: #FFFFFF;">      if length(<a href="file29.html">union</a>(Fx,Fz)) &lt; m0 </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 565</span> <span style="color: #000000; background: #FFFFFF;">          x0 = Y(2:bign+1,1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 566</span> <span style="color: #000000; background: #FFFFFF;">          s = x0(cmp1); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 567</span> <span style="color: #000000; background: #FFFFFF;">          lambda = x0(cmp2); </span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 568</span> <span style="color: #000000; background: #FFFFFF;">          [vio,index] = max( s .* lambda ); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 569</span> <span style="color: #000000; background: #FFFFFF;">          if vio == 0 % Got unlucky, just select first index available for branching </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 570</span> <span style="color: #000000; background: #FFFFFF;">              Ffix = <a href="file29.html">union</a>(Fx0, Fz0); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 571</span> <span style="color: #000000; background: #FFFFFF;">              tmpI = <a href="file25.html">setdiff</a>( <a href="file25.html">setdiff</a>(1:m0,Ffix) , <a href="file29.html">union</a>(Fx,Fz)); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 572</span> <span style="color: #000000; background: #FFFFFF;">              index = tmpI(1); </span><br/>       <span style="color: #0000FF">      5 </span><span style="color: #000000; font-weight: bold"> 573</span> <span style="color: #000000; background: #FFFFFF;">          end </span><br/>               <span style="color: #A0A0A0"> 574</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 575</span> <span style="color: #228B22; background: #FFFFFF;">          %% ---------------------</span><br/>               <span style="color: #A0A0A0"> 576</span> <span style="color: #228B22; background: #FFFFFF;">          %% Branch (if necessary)</span><br/>               <span style="color: #A0A0A0"> 577</span> <span style="color: #228B22; background: #FFFFFF;">          %% ---------------------</span><br/>               <span style="color: #A0A0A0"> 578</span> <span style="color: #228B22; background: #FFFFFF;">          %%</span><br/>               <span style="color: #A0A0A0"> 579</span> <span style="color: #228B22; background: #FFFFFF;">          %% We do not check primal feasibility because (x,z) are assumed</span><br/>               <span style="color: #A0A0A0"> 580</span> <span style="color: #228B22; background: #FFFFFF;">          %% part of a feasible x0 via CPLEX (see above). In CPLEX we</span><br/>               <span style="color: #A0A0A0"> 581</span> <span style="color: #228B22; background: #FFFFFF;">          %% trust!</span><br/>               <span style="color: #A0A0A0"> 582</span> <span style="color: #228B22; background: #FFFFFF;">          %%</span><br/><a name="Line583"></a>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 583</span> <span style="color: #000000; background: #FFFFFF;">           if LB &lt; LB_target &amp; vio &gt; options.fathom_tol </span><br/>               <span style="color: #A0A0A0"> 584</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line585"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 585</span> <span style="color: #000000; background: #FFFFFF;">              if index &lt;= t0 </span><br/>               <span style="color: #A0A0A0"> 586</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fxa = union(Fx,index);</span><br/>               <span style="color: #A0A0A0"> 587</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fza = Fz;</span><br/>               <span style="color: #A0A0A0"> 588</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 589</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fxb = Fx;</span><br/>               <span style="color: #A0A0A0"> 590</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fzb = union(Fz,index);</span><br/>               <span style="color: #A0A0A0"> 591</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line592"></a>               <span style="color: #A0A0A0"> 592</span> <span style="color: #A0A0A0; background: #FFFFFF;">                LBLB   = [LBLB  ,LB ,LB ];</span><br/><a name="Line593"></a>               <span style="color: #A0A0A0"> 593</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SS     = [SS    ,S  ,S  ];</span><br/><a name="Line594"></a>               <span style="color: #A0A0A0"> 594</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SIGSIG = [SIGSIG,SIG,SIG];</span><br/>               <span style="color: #A0A0A0"> 595</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 596</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxa;</span><br/>               <span style="color: #A0A0A0"> 597</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fza;</span><br/>               <span style="color: #A0A0A0"> 598</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 599</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxb;</span><br/>               <span style="color: #A0A0A0"> 600</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fzb;</span><br/>               <span style="color: #A0A0A0"> 601</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 602</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nodes_created = nodes_created + 2;</span><br/>               <span style="color: #A0A0A0"> 603</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 604</span> <span style="color: #000000; background: #FFFFFF;">              elseif index &lt;= t1 </span><br/>               <span style="color: #A0A0A0"> 605</span> <span style="color: #228B22; background: #FFFFFF;">              %% if t0 &lt; index &lt;= t1, then only add index to Fx if index+lenB not in Fx</span><br/>               <span style="color: #A0A0A0"> 606</span> <span style="color: #228B22; background: #FFFFFF;">              %% in case the second 'if' holds, then add index+lenB to Fz</span><br/>               <span style="color: #A0A0A0"> 607</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 608</span> <span style="color: #000000; background: #FFFFFF;">              if ~<a href="file23.html">ismember</a>(index+lenB,Fx) </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 609</span> <span style="color: #000000; background: #FFFFFF;">                Fxa = <a href="file29.html">union</a>(Fx,index); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 610</span> <span style="color: #000000; background: #FFFFFF;">                Fza = <a href="file29.html">union</a>(Fz,index+lenB); </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 611</span> <span style="color: #000000; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxa; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 612</span> <span style="color: #000000; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fza; </span><br/><a name="Line613"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 613</span> <span style="color: #000000; background: #FFFFFF;">                LBLB   = [LBLB  ,LB ]; </span><br/><a name="Line614"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 614</span> <span style="color: #000000; background: #FFFFFF;">                SS     = [SS    ,S  ]; </span><br/><a name="Line615"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 615</span> <span style="color: #000000; background: #FFFFFF;">                SIGSIG = [SIGSIG,SIG]; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 616</span> <span style="color: #000000; background: #FFFFFF;">                nodes_created = nodes_created + 1; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 617</span> <span style="color: #000000; background: #FFFFFF;">              end </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 618</span> <span style="color: #000000; background: #FFFFFF;">              Fxb = Fx; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 619</span> <span style="color: #000000; background: #FFFFFF;">              Fzb = <a href="file29.html">union</a>(Fz,index); </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 620</span> <span style="color: #000000; background: #FFFFFF;">              FxFx{length(FxFx)+1} = Fxb; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 621</span> <span style="color: #000000; background: #FFFFFF;">              FzFz{length(FzFz)+1} = Fzb; </span><br/><a name="Line622"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 622</span> <span style="color: #000000; background: #FFFFFF;">              LBLB   = [LBLB  ,LB ]; </span><br/><a name="Line623"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 623</span> <span style="color: #000000; background: #FFFFFF;">              SS     = [SS    ,S  ]; </span><br/><a name="Line624"></a>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 624</span> <span style="color: #000000; background: #FFFFFF;">              SIGSIG = [SIGSIG,SIG]; </span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 625</span> <span style="color: #000000; background: #FFFFFF;">              nodes_created = nodes_created + 1; </span><br/>               <span style="color: #A0A0A0"> 626</span> <span style="color: #228B22; background: #FFFFFF;">            else</span><br/>               <span style="color: #A0A0A0"> 627</span> <span style="color: #228B22; background: #FFFFFF;">              %% if index &gt; t1, then only add index to Fx if index-lenB not in Fx</span><br/>               <span style="color: #A0A0A0"> 628</span> <span style="color: #228B22; background: #FFFFFF;">              %% in case the second if holds, then add index-lenB to Fz</span><br/>               <span style="color: #A0A0A0"> 629</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 630</span> <span style="color: #A0A0A0; background: #FFFFFF;">              if ~ismember(index-lenB,Fx)</span><br/>               <span style="color: #A0A0A0"> 631</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fxa = union(Fx,index);</span><br/>               <span style="color: #A0A0A0"> 632</span> <span style="color: #A0A0A0; background: #FFFFFF;">                Fza = union(Fz,index-lenB);</span><br/>               <span style="color: #A0A0A0"> 633</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FxFx{length(FxFx)+1} = Fxa;</span><br/>               <span style="color: #A0A0A0"> 634</span> <span style="color: #A0A0A0; background: #FFFFFF;">                FzFz{length(FzFz)+1} = Fza;</span><br/><a name="Line635"></a>               <span style="color: #A0A0A0"> 635</span> <span style="color: #A0A0A0; background: #FFFFFF;">                LBLB   = [LBLB  ,LB ];</span><br/><a name="Line636"></a>               <span style="color: #A0A0A0"> 636</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SS     = [SS    ,S  ];</span><br/><a name="Line637"></a>               <span style="color: #A0A0A0"> 637</span> <span style="color: #A0A0A0; background: #FFFFFF;">                SIGSIG = [SIGSIG,SIG];</span><br/>               <span style="color: #A0A0A0"> 638</span> <span style="color: #A0A0A0; background: #FFFFFF;">                nodes_created = nodes_created + 1;</span><br/>               <span style="color: #A0A0A0"> 639</span> <span style="color: #A0A0A0; background: #FFFFFF;">              end</span><br/>               <span style="color: #A0A0A0"> 640</span> <span style="color: #A0A0A0; background: #FFFFFF;">              Fxb = Fx;</span><br/>               <span style="color: #A0A0A0"> 641</span> <span style="color: #A0A0A0; background: #FFFFFF;">              Fzb = union(Fz,index);</span><br/>               <span style="color: #A0A0A0"> 642</span> <span style="color: #A0A0A0; background: #FFFFFF;">              FxFx{length(FxFx)+1} = Fxb;</span><br/>               <span style="color: #A0A0A0"> 643</span> <span style="color: #A0A0A0; background: #FFFFFF;">              FzFz{length(FzFz)+1} = Fzb;</span><br/><a name="Line644"></a>               <span style="color: #A0A0A0"> 644</span> <span style="color: #A0A0A0; background: #FFFFFF;">              LBLB   = [LBLB  ,LB ];</span><br/><a name="Line645"></a>               <span style="color: #A0A0A0"> 645</span> <span style="color: #A0A0A0; background: #FFFFFF;">              SS     = [SS    ,S  ];</span><br/><a name="Line646"></a>               <span style="color: #A0A0A0"> 646</span> <span style="color: #A0A0A0; background: #FFFFFF;">              SIGSIG = [SIGSIG,SIG];</span><br/>               <span style="color: #A0A0A0"> 647</span> <span style="color: #A0A0A0; background: #FFFFFF;">              nodes_created = nodes_created + 1;</span><br/>               <span style="color: #A0A0A0"> 648</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 649</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 650</span> <span style="color: #228B22; background: #FFFFFF;">              %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 651</span> <span style="color: #228B22; background: #FFFFFF;">              %% End branching decision</span><br/>               <span style="color: #A0A0A0"> 652</span> <span style="color: #228B22; background: #FFFFFF;">              %% ----------------------</span><br/>               <span style="color: #A0A0A0"> 653</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      9 </span><span style="color: #000000; font-weight: bold"> 654</span> <span style="color: #000000; background: #FFFFFF;">          end </span><br/>               <span style="color: #A0A0A0"> 655</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 656</span> <span style="color: #000000; background: #FFFFFF;">      end </span><br/>               <span style="color: #A0A0A0"> 657</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 658</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 659</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 660</span> <span style="color: #A0A0A0; background: #FFFFFF;">      nodes_infeasible = nodes_infeasible + 1;</span><br/>               <span style="color: #A0A0A0"> 661</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 662</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 663</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 664</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------</span><br/>               <span style="color: #A0A0A0"> 665</span> <span style="color: #228B22; background: #FFFFFF;">    %% End handling of single node</span><br/>               <span style="color: #A0A0A0"> 666</span> <span style="color: #228B22; background: #FFFFFF;">    %% ---------------------------</span><br/>               <span style="color: #A0A0A0"> 667</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 668</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------</span><br/>               <span style="color: #A0A0A0"> 669</span> <span style="color: #228B22; background: #FFFFFF;">    %% End loop over nodes in the tree</span><br/>               <span style="color: #A0A0A0"> 670</span> <span style="color: #228B22; background: #FFFFFF;">    %% -------------------------------</span><br/>               <span style="color: #A0A0A0"> 671</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">     19 </span><span style="color: #000000; font-weight: bold"> 672</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 673</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 674</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 675</span> <span style="color: #228B22; background: #FFFFFF;">%% Print final stats</span><br/>               <span style="color: #A0A0A0"> 676</span> <span style="color: #228B22; background: #FFFFFF;">%% -----------------</span><br/>               <span style="color: #A0A0A0"> 677</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 678</span> <span style="color: #000000; background: #FFFFFF;">fprintf('\n'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 679</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 1: optimal value = %.8e\n', gUB+cons); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 680</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 2: (created,solved,pruned,infeas,left) = (%d,%d,%d,%d,%d)\n', ... </span><br/>               <span style="color: #A0A0A0"> 681</span> <span style="color: #000000; background: #FFFFFF;">    nodes_created, nodes_solved, nodes_pruned, nodes_infeasible, length(LBLB));</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 682</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 3: solved = fully + fathomed + poorly : %d = %d + %d + %d\n', ... </span><br/>               <span style="color: #A0A0A0"> 683</span> <span style="color: #000000; background: #FFFFFF;">    nodes_solved, nodes_solved_fully, nodes_solved_fathomed, nodes_solved_poorly);</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 684</span> <span style="color: #000000; background: #FFFFFF;">fprintf('FINAL STATUS 4: time = %d\n', toc); </span><br/>               <span style="color: #A0A0A0"> 685</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 686</span> <span style="color: #000000; background: #FFFFFF;">fval = gUB+cons; </span><br/>               <span style="color: #A0A0A0"> 687</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 688</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 689</span> <span style="color: #228B22; background: #FFFFFF;">%% Extract the solution to the original problem</span><br/>               <span style="color: #A0A0A0"> 690</span> <span style="color: #228B22; background: #FFFFFF;">%% ---------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 691</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 692</span> <span style="color: #000000; background: #FFFFFF;">x = <a href="file61.html">getsol</a>(xx,sstruct); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 693</span> <span style="color: #000000; background: #FFFFFF;">time = toc; </span><br/>               <span style="color: #A0A0A0"> 694</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 695</span> <span style="color: #000000; background: #FFFFFF;">stat.time_BB = time - stat.time_pre; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 696</span> <span style="color: #000000; background: #FFFFFF;">stat.nodes = nodes_solved; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 697</span> <span style="color: #000000; background: #FFFFFF;">if isempty(stat.status) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 698</span> <span style="color: #000000; background: #FFFFFF;">  if nodes_solved_poorly/nodes_solved &gt; .3  </span><br/>               <span style="color: #A0A0A0"> 699</span> <span style="color: #A0A0A0; background: #FFFFFF;">    stat.status = 'numerical_issues_of_optdnn';</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 700</span> <span style="color: #228B22; background: #FFFFFF;">  else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 701</span> <span style="color: #000000; background: #FFFFFF;">    stat.status = 'optimal_solution'; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 702</span> <span style="color: #000000; background: #FFFFFF;">  end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 703</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 704</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 705</span> <span style="color: #000000; background: #FFFFFF;">return </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>